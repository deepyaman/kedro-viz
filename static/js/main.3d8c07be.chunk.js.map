{"version":3,"sources":["webpack:///./src/utils/graph/index.js?88e4","actions/index.js","reducers/flags.js","utils/worker.js","actions/graph.js","reducers/graph.js","reducers/layers.js","config.js","utils/index.js","store/load-data.js","store/helpers.js","store/normalize-data.js","utils/flags.js","store/initial-state.js","actions/pipelines.js","actions/nodes.js","reducers/loading.js","reducers/nodes.js","actions/node-type.js","reducers/node-type.js","reducers/pipeline.js","actions/tags.js","reducers/tags.js","actions/modular-pipelines.js","reducers/modular-pipelines.js","reducers/visible.js","reducers/index.js","selectors/pipeline.js","selectors/modular-pipelines.js","selectors/tags.js","selectors/disabled.js","utils/short-type.js","selectors/edges.js","selectors/ranks.js","selectors/nodes.js","selectors/metadata.js","selectors/layout.js","store/index.js","components/large-pipeline-warning/index.js","selectors/layers.js","selectors/linked-nodes.js","utils/modifiers.js","components/icons/node-icon.js","components/flowchart/draw.js","utils/view.js","components/tooltip/index.js","components/flowchart/index.js","components/pipeline-list/index.js","components/node-list/node-list-search.js","components/icons/visible.js","components/icons/invisible.js","components/icons/focus-mode.js","components/node-list/node-list-row.js","components/lazy-list/index.js","components/node-list/node-list-row-list.js","components/node-list/node-list-group.js","components/node-list/node-list-groups.js","selectors/node-types.js","components/node-list/node-list-tree-item.js","components/node-list/node-list-tree.js","components/split-panel/index.js","components/node-list/node-list.js","components/icons/indicator.js","components/icons/indicator-off.js","components/icons/indicator-partial.js","components/node-list/node-list-items.js","components/node-list/index.js","components/icon-button/index.js","components/icons/menu.js","components/icons/theme.js","components/icons/label.js","components/icons/export.js","components/icons/layers.js","components/icons/settings.js","components/primary-toolbar/index.js","components/icons/map.js","components/icons/plus.js","components/icons/minus.js","components/icons/reset.js","components/minimap-toolbar/index.js","components/minimap/draw.js","components/minimap/index.js","components/sidebar/index.js","utils/plot-templates/dark.js","utils/plot-templates/light.js","components/plotly-chart/index.js","components/icons/copy.js","components/icons/close.js","components/icons/expand.js","components/metadata/metadata-value.js","components/metadata/metadata-list.js","components/metadata/metadata-parameters-theme.js","components/metadata/metadata-object.js","components/metadata/metadata-row.js","components/metadata/metadata-code.js","components/toggle/index.js","components/metadata/index.js","components/export-modal/export-graph.js","components/export-modal/index.js","components/settings-modal/settings-modal-row.js","components/settings-modal/index.js","components/icons/collapse.js","components/icons/back.js","components/plotly-modal/index.js","components/icons/loading.js","selectors/loading.js","components/wrapper/index.js","components/app/index.js","utils/random-utils.js","utils/random-data.js","utils/data-source.js","components/container/index.js","index.js","utils/graph/common.js","utils/graph/solver.js","utils/graph/constraints.js","utils/graph/layout.js","utils/graph/routing.js","utils/graph/graph.js","utils/graph/index.js"],"names":["addMethods","methods","module","exports","w","Worker","URL","createObjectURL","Blob","name","RESET_DATA","resetData","data","type","TOGGLE_LAYERS","TOGGLE_EXPORT_MODAL","toggleExportModal","visible","TOGGLE_SETTINGS_MODAL","toggleSettingsModal","TOGGLE_PLOT_MODAL","togglePlotModal","TOGGLE_GRAPH","toggleGraph","TOGGLE_TEXT_LABELS","TOGGLE_PRETTY_NAME","TOGGLE_SIDEBAR","TOGGLE_THEME","UPDATE_CHART_SIZE","UPDATE_ZOOM","updateZoom","zoom","UPDATE_FONT_LOADED","TOGGLE_MINIMAP","CHANGE_FLAG","changeFlag","value","TOGGLE_IGNORE_LARGE_WARNING","TOGGLE_CODE","TOGGLE_PARAMETERS_HOVERED","TOGGLE_MODULAR_PIPELINE_FOCUS_MODE","toggleFocusMode","modularPipeline","flagsReducer","worker","flagsState","action","Object","assign","isTest","jest","graphWorker","require","graph","mockWorker","terminate","keys","forEach","payload","Promise","resolve","TOGGLE_GRAPH_LOADING","toggleLoading","loading","UPDATE_GRAPH_LAYOUT","updateGraph","layoutWorker","getJob","instance","running","then","response","preventWorkerQueues","state","graphNew","nodeReducer","graphState","updateState","newState","layerReducer","layerState","pathRoot","localStorageName","metaSidebarWidth","open","closed","sidebarWidth","breakpoint","codeSidebarWidth","flags","sizewarning","description","default","icon","settings","sidebarGroups","elementType","tag","sidebarElementTypes","task","parameters","shortTypeMapping","arrayToObject","array","callback","newObject","key","getUrl","id","join","Error","unique","d","i","arr","indexOf","loadJsonData","path","fallback","json","catch","fullPath","substr","noWindow","window","loadState","serializedState","localStorage","getItem","JSON","parse","err","console","error","saveState","hasOwnProperty","nodeTypeDisabled","stringify","setItem","pruneFalseyKeys","obj","newObj","normalizeData","pipeline","ids","tree","expanded","active","node","fullName","tags","layer","disabled","pipelines","clicked","hovered","fetched","code","filepath","inputs","outputs","plot","metrics","datasetType","originalType","transcodedTypes","runCommand","modularPipelines","nodeType","edge","sources","targets","enabled","hoveredParameters","dataSource","source","Array","isArray","edges","nodes","validateInput","push","full_name","dataset_type","original_type","transcoded_types","modular_pipelines","addNode","target","createEdgeID","includes","addEdge","addPipeline","length","main","selected_pipeline","children","child","addTag","layers","addLayer","Flags","isDefined","names","flagsConfig","defaults","reduce","result","flag","getFlagsFromUrl","url","urlParams","document","location","href","searchParams","e","warn","mergeLocalStorage","localStorageState","deepmerge","preparePipelineState","applyFixes","prepareNonPipelineState","props","chartSize","textLabels","theme","prettyName","ignoreLargeWarning","labelBtn","layerBtn","exportBtn","settingsBtn","exportModal","plotModal","settingsModal","sidebar","innerWidth","themeBtn","miniMapBtn","miniMap","modularPipelineFocusMode","getInitialState","nonPipelineState","pipelineState","UPDATE_ACTIVE_PIPELINE","updateActivePipeline","TOGGLE_PIPELINE_LOADING","getPipelineUrl","TOGGLE_NODE_CLICKED","toggleNodeClicked","nodeClicked","TOGGLE_NODES_DISABLED","TOGGLE_NODE_HOVERED","toggleNodeHovered","nodeHovered","TOGGLE_NODE_DATA_LOADING","toggleNodeDataLoading","ADD_NODE_METADATA","loadNodeData","nodeID","dispatch","getState","a","nodeData","loadingReducer","loadingState","nodeState","nodeIDs","isDisabled","run_command","TOGGLE_TYPE_DISABLED","allNodeTypesUnset","isNodeTypeUnset","nodeTypeValue","isNodeTypeDisabled","nodeTypeReducer","nodeTypeState","nextDisabledState","typeIDs","nextTypesDisabled","values","every","pipelineReducer","TOGGLE_TAG_ACTIVE","TOGGLE_TAG_FILTER","tagReducer","tagState","batchChanges","tagIDs","tagID","TOGGLE_MODULAR_PIPELINE_ACTIVE","TOGGLE_MODULAR_PIPELINE_EXPANDED","modularPipelineReducer","modularPipelineState","modularPipelineIDs","modularPipelineID","newVisibleState","isExpanding","expandedIDs","expandedModularPipelines","filter","expandedID","expandedModularPipeline","collapsedModularPipelines","setChildrenInvisible","collapsedModularPipeline","startsWith","visibleReducer","visibleState","createReducer","initialState","combinedReducer","combineReducers","fontLoaded","rootReducer","resetDataReducer","getNodeIDs","getNodeDisabledPipeline","createSelector","nodePipelines","activePipeline","getPipelineNodeIDs","nodeDisabledPipeline","getPipelineTagIDs","nodeTags","visibleTags","nodeModularPipelines","visibleModularPipelines","escapeRegExp","utils","getHighlightedText","getFocusedModularPipeline","getModularPipelinesTree","searchString","searchValue","RegExp","test","isTreeLeaf","treeNode","searchTree","currentNodeID","foundChildren","childNode","found","highlightedLabel","getModularPipelinesSearchResult","modularPipelinesTree","searchResult","getTagEnabled","getTagData","tagName","tagActive","tagEnabled","sort","map","Boolean","getTagCount","total","getTagNodeCounts","counts","tagIds","tagId","getVisibleSidebarNodes","getVisibleModularPipelineInputsOutputs","visibleSidebarNodes","modularPipelineData","Set","add","getNodeDisabledTag","tagCount","some","getNodeDisabled","nodeDisabledNode","nodeDisabledTag","typeDisabled","focusedModularPipeline","visibleModularPipelineInputsOutputs","isDisabledViaSidebar","has","isDisabledViaFocusedModularPipeline","inputOutputNodeIDs","getVisibleNodeIDs","nodeDisabled","getVisibleLayerIDs","nodeLayer","layerIDs","layersVisible","visibleLayerIDs","layerID","getEdgeDisabled","edgeIDs","edgeSources","edgeTargets","edgeID","getShortType","longTypeName","getEdgeIDs","getEdgeSources","getEdgeTargets","getNodeModularPipelines","getTransitiveEdges","transitiveEdges","walkGraphEdges","isNotInputEdge","concat","addNewEdge","getVisibleEdges","edgeDisabled","getInputOutputDataEdges","visibleEdges","edgesList","getLayerNodes","layerNodes","getNodeRank","nodeDeps","sourceID","targetID","toposortedNodes","batchingToposort","nodeRanks","rank","getNodeName","getNodeFullName","getNodeDisabledNode","getNodeType","getNodeDatasetType","getFontLoaded","getNodeTypeDisabled","getGraphNodes","getNodeActive","hoveredNode","modularPipelineActive","activeModularPipelines","nodesActiveViaModularPipeline","flatMap","activeViaTag","activeModularPipeline","activeViaModularPipeline","getNodeSelected","clickedNode","getNodeLabel","nodeName","nodeFullName","getNodeData","nodeLabel","nodeDatasetType","b","disabledNode","disabledTag","disabledType","getNodeDataObject","getGroupedNodes","item","getNodeTextWidth","nodeTextWidth","svg","select","body","append","attr","selectAll","enter","text","each","width","this","getBBox","remove","getNodeSize","iconSize","padding","showLabels","x","y","getPadding","textWidth","showText","height","textOffset","iconOffset","getVisibleNodes","nodeSize","nodeRank","getNodesWithInputParams","nodesList","getInputOutputNodesForFocusedModularPipeline","focusedModularPipelineID","graphNodes","getClickedNode","sortAlpha","localeCompare","getVisibleMetaSidebar","getClickedNodeMetaData","nodeId","tagNames","nodeFilepaths","nodeInputs","nodeOutputs","nodeCodes","nodeParameters","nodePlot","nodeMetrics","nodeDatasetTypes","nodeOriginalTypes","nodeTranscodedTypes","nodeRunCommand","entries","Math","round","metadata","getTriggerLargeGraphWarning","graphHasNodes","sizeWarningFlag","getGraphInput","triggerLargeGraphWarning","getSidebarWidth","getChartSize","visibleSidebar","visibleMetaSidebar","visibleCodeSidebar","left","top","sidebarWidthActual","metaSidebarWidthActual","codeSidebarWidthActual","outerWidth","outerHeight","minWidthScale","getChartZoom","updateGraphOnChange","store","watchGraph","watch","subscribe","graphInput","configureStore","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","reducer","applyMiddleware","thunk","otherVisibleProps","saveStateToLocalStorage","connect","sidebarVisible","onDisable","onHide","className","classnames","onClick","size","mode","animation","getLayers","layerName","bounds","nearestLayer","bound","Infinity","currentBound","prevBound","nextBound","start","end","rectWidth","max","getVisibleEdgesByNode","sourceEdges","targetEdges","findLinkedNodes","edgesByNode","visited","getLinkedNodes","linkedNodes","modifiers","others","classes","modifier","replace","paths","plotly","NodeIcon","viewBox","lineShape","line","curve","curveBasis","matchFloats","toSinglePoint","parseFloat","toFixed","drawLayers","el","layerGroup","enterLayers","exit","merge","drawLayerNames","layerNameGroup","transition","duration","DURATION","style","layerNames","enterLayerNames","updateNodeRects","nodeRects","updateParameterRect","drawNodes","changed","nodeActive","nodeSelected","nodesWithInputParams","inputOutputDataNodes","focusMode","isInputOutputNode","nodeGroup","updateNodes","enterNodes","exitNodes","allNodes","classed","on","handleNodeClick","handleNodeMouseOver","handleNodeMouseOut","handleNodeKeyDown","handleParamsIndicatorMouseOver","call","nodeIcons","order","drawEdges","inputOutputDataEdges","isInputOutputEdge","edgeGroup","updateEdges","enterEdges","exitEdges","allEdges","sourceNode","attrTween","current","points","previous","interpolatePath","viewing","container","wrapper","onViewChanged","onViewEnd","allowUserInput","d3Zoom","event","transform","isInvalidTransform","interpolate","origin","zoomIdentity","isOrigin","k","isFinite","isNaN","getViewTransform","view","zoomTransform","negateTransform","translate","scale","setViewTransformExact","final","__zoom","viewTransformToFit","offset","focus","viewWidth","viewHeight","objectWidth","objectHeight","minScaleX","minScaleFocus","focusOffset","scaleY","scaleX","scaleXClamp","min","isCroppedY","objectCenterY","focusCenterOffsetX","focusCenterOffsetY","zeroWidthSpace","String","fromCharCode","insertZeroWidthSpace","Tooltip","targetRect","isRight","isTop","xOffset","yOffset","defaultProps","FlowChart","handleWindowResize","updateChartSize","handleBeforePrint","graphSize","marginx","marginy","handleAfterPrint","getHoveredParameterLabel","parameterNames","onLoadNodeData","stopPropagation","handleChartClick","onToggleNodeHovered","showTooltip","label","hideTooltip","keyCode","tooltip","onViewChange","bind","onViewChangeEnd","containerRef","React","createRef","svgRef","wrapperRef","edgesRef","nodesRef","layersRef","layerNamesRef","MARGIN","MIN_SCALE","MAX_SCALE","selectD3Elements","updateViewExtents","addGlobalEventListeners","update","removeGlobalEventListeners","prevProps","chartZoom","resetView","onChartZoomChanged","objectA","objectB","prop","onUpdateChartSize","chartSizeTestFallback","getBoundingClientRect","ResizeObserver","resizeObserver","observe","addEventListener","unobserve","removeEventListener","updateY","extents","scaleExtent","translateExtent","minX","minY","maxX","maxY","minK","maxK","getViewExtents","onUpdateZoom","applied","relative","minScale","maxScale","chartWidth","chartHeight","graphWidth","graphHeight","leftSidebarOffset","rightSidebarOffset","margin","setViewExtents","reset","hasTranslation","translateTo","scaleTo","setViewTransform","find","isFirstTransform","options","setState","visibleGraph","ref","refX","refY","markerUnits","markerWidth","markerHeight","orient","Component","right","bottom","emptyEdges","emptyNodes","emptyGraphSize","ownProps","visibleCode","asyncDataSource","onUpdateActivePipeline","pipelineID","onToggleOpen","onOpened","onClosed","onChanged","defaultText","primaryText","onUpdateSearchValue","useRef","handleWindowKeyDown","isKeyF","isKeyCtrlOrCmd","ctrlKey","metaKey","input","querySelector","activeElement","preventDefault","blur","useEffect","onKeyDown","onChange","placeholder","VisibleIcon","InvisibleIcon","FocusModeIcon","checked","xmlns","shouldMemo","nextProps","NodeListRow","memo","Container","allUnchecked","faded","focused","count","kind","onMouseEnter","onMouseLeave","selected","visibleIcon","invisibleIcon","focusModeIcon","rowType","VisibilityIcon","TextButton","title","onFocus","onBlur","dangerouslySetInnerHTML","__html","htmlFor","aria-label","range","rangeUnion","rangeA","rangeB","rangeEqual","visibleRangeOf","element","buffer","childTotal","childHeight","clip","list","bufferCount","ceil","viewport","innerHeight","documentElement","clientHeight","floor","useRequestFrameOnce","request","useCallback","cancelAnimationFrame","requestAnimationFrame","thresholds","from","_","useIntersection","observer","useLayoutEffect","disconnect","IntersectionObserver","LazyList","lazy","dispose","offsetParent","supported","useState","setRange","rangeRef","listRef","upperRef","lowerRef","itemHeight","useMemo","totalHeight","upperHeight","lowerHeight","requestUpdate","visibleRange","effectiveRange","observerOptions","threshold","childProps","listStyle","position","undefined","paddingTop","upperStyle","display","lowerStyle","NodeRowList","items","group","collapsed","onItemClick","onItemChange","onItemMouseEnter","onItemMouseLeave","fade","slice","NodeListGroup","onToggleChecked","onToggleCollapsed","toLowerCase","storedState","NodeListGroups","groups","onGroupToggleChanged","groupsCollapsed","setCollapsed","onToggleGroupCollapsed","groupID","getNodeTypeIDs","isModularPipelineType","getTypeNodeCount","types","typeNodeIDs","visibleTypeNodeIDs","getNodeTypes","typeName","typeNodeCount","nodeCount","arrowIconColor","NodeListTreeItem","TreeItem","collapseIcon","color","expandIcon","GROUPED_NODES_DISPLAY_ORDER","parameter","useStyles","makeStyles","root","flexGrow","maxWidth","StyledTreeView","withStyles","TreeView","isOnFocusedModePath","focusModeID","getModularPipelineRowData","getNodeRowData","modularPipelinesSearchResult","onNodeToggleExpanded","renderTree","sortBy","renderLeafNode","isFocusedModularPipeline","noop","defaultCollapseIcon","defaultExpandIcon","onNodeToggle","expandedItemIds","SplitPanel","splitDefault","splitMin","splitMax","keyboardStep","orientation","handleRef","getRects","handle","clamp","splitValue","rects","handleSize","isResizing","setIsResizing","split","setSplit","onMouse","mouseOffsetVertical","clientY","onMouseMove","onMouseUp","panelA","panelB","role","tabIndex","onMouseDown","keyboardOffset","ArrowUp","ArrowLeft","ArrowDown","ArrowRight","NodeList","getGroupState","onModularPipelineToggleExpanded","autoHide","hideTracksWhenNotNeeded","IndicatorIcon","rx","strokeWidth","OffIndicatorIcon","PartialIndicatorIcon","isTagType","isElementType","isGroupType","nodeGroups","highlightMatch","highlightedGroups","nodeMatchesSearch","filterNodeGroups","filteredGroups","nodeGroupId","getFilteredNodes","filteredNodes","getFilteredTags","getFilteredTagItems","tagNodeCounts","filteredTags","IndicatorOffIcon","getFilteredElementTypes","getFilteredElementTypeItems","nodeTypes","filteredElementTypes","compareEnabledThenAlpha","itemA","itemB","byEnabledTag","Number","byAlpha","getFilteredNodeItems","filteredNodeItems","getGroups","itemsOfType","allChecked","IndicatorPartialIcon","getFilteredItems","filteredTagItems","filteredElementTypeItems","onToggleTagActive","toggleTagActive","onToggleTagFilter","toggleTagFilter","onToggleModularPipelineActive","toggleModularPipelineActive","onToggleTypeDisabled","typeID","toggleTypeDisabled","onToggleNodeSelected","onToggleModularPipelineExpanded","onToggleNodeActive","onToggleParametersActive","onToggleNodesDisabled","toggleNodesDisabled","onToggleFocusMode","updateSearchValue","onGroupItemChange","wasChecked","handleKeyDown","handleKeyEvent","escape","debounce","groupType","groupItems","groupItemsDisabled","groupItem","tye","IconButton","ariaLabel","ariaLive","labelText","Icon","aria-live","MenuIcon","ThemeIcon","LabelIcon","ExportIcon","LayersIcon","SettingsIcon","disableLayerBtn","visibleLayers","onToggleExportModal","onToggleSettingsModal","onToggleLayers","onToggleSidebar","toggleSidebar","onToggleTextLabels","onToggleTheme","MapIcon","PlusIcon","MinusIcon","ResetIcon","scaleZoom","factor","onToggleMiniMap","onUpdateChartZoom","drawViewport","mapSize","getViewport","sizeOffset","MiniMap","onPointerEnter","isPointerInside","onPointerLeave","onPointerUpGlobal","isPointerDown","onPointerDown","onPointerMove","onPointerWheel","deltaY","ZOOM_RATE","onPointerWheelGlobal","contains","useTransition","time","Date","lastTransitionTime","TRANSITION_WAIT","chartScale","containerRect","pointerX","clientX","pointerY","centerX","centerY","viewportRef","passive","pointerEventName","mapWidth","mapHeight","mapScale","translateX","translateY","transformStyle","inputEvents","onWheel","PointerEvent","getMapSize","scaledWidth","pipelineIsOpen","togglePipeline","darkTemplate","autosize","annotationdefaults","arrowcolor","arrowhead","arrowwidth","autotypenumbers","coloraxis","autocolorscale","colorbar","thickness","showticklabels","ticks","tickwidth","tickcolor","ticklen","tickfont","ticklabelposition","font","colorscale","diverging","sequential","sequentialminus","colorway","hoverlabel","align","hovermode","legend","mapbox","paper_bgcolor","plot_bgcolor","xref","yref","xanchor","yanchor","xaxis","automargin","gridcolor","linewidth","linecolor","rangemode","showline","zerolinecolor","zerolinewidth","yaxis","l","r","t","darkPreviewTemplate","showlegend","nticks","darkModalTemplate","lightTemplate","lightPreviewTemplate","lightModalTemplate","Plot","createPlotlyComponent","Plotly","updateLayout","layout","plotConfig","staticPlot","config","useResizeHandler","CopyIcon","CloseIcon","ExpandIcon","MetaDataValue","empty","MetaDataList","property","inline","commas","limit","setExpanded","showValues","remainder","index","aria-expanded","darkjsonViewerTheme","base00","base01","base02","base03","base04","base05","base06","base07","base08","base09","base0A","base0B","base0C","base0D","base0E","base0F","lightjsonViewerTheme","MetaDataObject","indentWidth","collapseStringsAfterLength","enableClipboard","displayDataTypes","src","MetaDataRow","showList","showObject","data-label","hljs","registerLanguage","python","yaml","javascript","codeRef","highlighted","detected","highlightAuto","language","second_best","highlight","Toggle","onToggleCode","toggleCode","onTogglePlotModal","showCopied","setShowCopied","isTaskNode","isDataNode","isParametersNode","nodeTypeIcon","hasPlot","hasMetrics","hasCode","isTranscoded","showCodePanel","showCodeSwitch","onExpandPlotClick","Fragment","navigator","clipboard","writeText","setTimeout","exportGraph","format","mockFn","downloadFormats","png","downloadPng","downloadSvg","download","clone","parentNode","appendChild","cloneNode","classList","hasGraph","setAttribute","removeAttribute","createElement","innerHTML","prepend","css","removeChild","onToggle","onClose","SettingsModalRow","toggleValue","onToggleChange","onToggleFlag","onTogglePrettyName","flagData","settingsConfig","CollapseIcon","BackIcon","onCollapsePlotClick","LoadingIcon","isLoading","graphLoading","pipelineLoading","fontLoading","nodeLoading","App","loadWebFonts","announceFlags","updatePipelineData","message","flagsEnabled","allNames","info","private","isEnabled","status","statusIcon","getFlagsMessage","setFontLoaded","LoadWebFont","inactive","getSeedFromURL","seed","get","characters","charAt","random","generateHash","set","toString","getNumberArray","LOREM_IPSUM","randomUtils","seedrandom","randomIndex","randomNumber","getRandom","randomNumberBetween","getRandomName","numWords","getRandomSelection","numItems","len","taken","LAYERS","Pipeline","generatePipelines","rankCount","getRankCount","rankLayers","getRankLayers","generateTags","generateNodes","generateEdges","generateModularPipelines","finalise","pipelineCount","__root__","layerSize","rankNodeCount","getRankNodeCount","createNode","_sources","initialRank","getNodePipelines","getRandomTags","_targets","generateCodeSnippet","getOwnPropertyNames","prototype","nodesByRank","edgeCount","getNodesByRank","ranks","getRandomNodeAtRank","rankIndex","rankValue","rankNodes","sourceRankIndex","remainingRankCount","biasedRandom","_sourceNode","_targetNode","degree","visibleNodes","sortedNodes","getType","getNodeMetaData","activeNodes","activeTags","activeEdges","generateRandomPipeline","all","getPipelineData","nameSource","spaceflights","demo","selectors","getRandomPipeline","getDataValue","REACT_APP_DATA_SOURCE","process","isDemo","host","encodeURIComponent","getSourceID","ReactDOM","render","getElementById","HALF_PI","PI","snap","unit","angle","atan2","nodeLeft","nodeRight","nodeTop","nodeBottom","groupByRow","rows","rowNumbers","row","sortedRows","compare","delta","offsetNode","offsetEdge","point","nearestOnLine","ax","ay","bx","by","dx","dy","positionClamped","solveLoose","constraints","iterations","constants","constraint","base","solve","solveStrict","solver","Solver","variables","variableId","addVariable","variable","Variable","unsolvableCount","addConstraint","strict","updateVariables","rowConstraint","variableA","variableB","Constraint","minus","Operator","Ge","spaceY","Strength","required","layerConstraint","layerSpace","parallelConstraint","strength","Eq","create","crossingConstraint","edgeA","edgeB","separationA","separationB","resolveSource","resolveTarget","targetNode","separationConstraint","separation","spaceX","spreadX","layerSpaceY","rowConstraints","createRowConstraints","layerConstraints","createLayerConstraints","crossingConstraints","createCrossingConstraints","parallelConstraints","createParallelConstraints","separationConstraints","createSeparationConstraints","expandDenseRows","layerGroups","nextLayerNodes","intermediary","sourceA","targetA","edgeADegree","j","sourceB","targetB","edgeBDegree","rowNodes","nodeA","nodeB","degreeA","degreeB","spread","space","densities","rowDensity","spaceYUnit","currentOffsetY","density","offsetY","edgeAngle","abs","sourceRow","targetRow","routing","minPassageGap","stemUnit","stemMinSource","stemMinTarget","stemMax","stemSpaceSource","stemSpaceTarget","sourceOffsetX","currentPoint","firstNode","nearestPoint","nearestDistance","rowExtended","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","nextNode","nodeGap","offsetX","candidatePoint","distance","sourceSeparation","targetSeparation","sourceEdgeDistance","targetEdgeDistance","targetOffsetX","sourceOffsetY","targetOffsetY","sourceStem","targetStem","pointYMax","defaultOptions","addEdgeLinks","nodeById","addNearestLayers","validLayers","hasValidLayer","lastLayer","layerNode","findNodeBy","targetNodes","orderRankAscending","successors","accept","successor"],"mappings":"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","file":"static/js/main.3d8c07be.chunk.js","sourcesContent":["\n\t\t\t\tvar addMethods = require(\"../../../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"graphNew\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(URL.createObjectURL(new Blob([\"!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){\\\"undefined\\\"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\\\"Module\\\"}),Object.defineProperty(t,\\\"__esModule\\\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\\\"object\\\"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\\\"default\\\",{enumerable:!0,value:t}),2&e&&\\\"string\\\"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\\\"a\\\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\\\"./\\\",r(r.s=0)}([function(t,e,r){\\\"use strict\\\";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){if(t){if(\\\"string\\\"===typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return\\\"Object\\\"===r&&t.constructor&&(r=t.constructor.name),\\\"Map\\\"===r||\\\"Set\\\"===r?Array.from(t):\\\"Arguments\\\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function u(t,e){var r;if(\\\"undefined\\\"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=s(t))||e&&t&&\\\"number\\\"===typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError(\\\"Invalid attempt to iterate non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\\\")}var i,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}r.r(e),r.d(e,\\\"graphNew\\\",(function(){return ut}));var c=.5*Math.PI,f=function(t,e){return Math.round(t/e)*e},p=function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)},l=function(t){return t.x-.5*t.width},h=function(t){return t.x+.5*t.width},d=function(t){return t.y-.5*t.height},y=function(t){return t.y+.5*t.height},v=function(t){var e,r={},n=u(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;r[o.y]=r[o.y]||[],r[o.y].push(o)}}catch(p){n.e(p)}finally{n.f()}var i=Object.keys(r).map((function(t){return parseFloat(t)}));i.sort((function(t,e){return t-e}));for(var a=i.map((function(t){return r[t]})),s=0;s<a.length;s+=1){a[s].sort((function(t,e){return m(t.x,e.x,t.id,e.id)}));var c,f=u(a[s]);try{for(f.s();!(c=f.n()).done;){c.value.row=s}}catch(p){f.e(p)}finally{f.f()}}return a},m=function t(e,r){for(var n=\\\"string\\\"===typeof e?e.localeCompare(r):e-r,o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];return 0!==n||0===i.length?n:t.apply(void 0,i)},g=function(t,e){return t.x=t.x-e.x,t.y=t.y-e.y,t.order=t.x+9999*t.y,t},_=function(t,e){return t.points.forEach((function(t){t.x=t.x-e.x,t.y=t.y-e.y})),t},b=function(t,e,r,n,o,i){var a,s,u,c=o-r,f=i-n,p=(u=1,(a=((t-r)*c+(e-n)*f)/(c*c+f*f||1))<(s=0)?s:a>u?u:a);return{x:r+c*p,y:n+f*p,ax:r,ay:n,bx:o,by:i}};function x(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if(\\\"undefined\\\"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError(\\\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\\\")}()}function w(){return new M}var M=function(){function t(){this.index={},this.array=[]}return t.prototype.size=function(){return this.array.length},t.prototype.empty=function(){return 0===this.array.length},t.prototype.itemAt=function(t){return this.array[t]},t.prototype.contains=function(t){return void 0!==this.index[t.id()]},t.prototype.find=function(t){var e=this.index[t.id()];return void 0===e?void 0:this.array[e]},t.prototype.setDefault=function(t,e){var r=this.index[t.id()];if(void 0===r){var n=new S(t,e());return this.index[t.id()]=this.array.length,this.array.push(n),n}return this.array[r]},t.prototype.insert=function(t,e){var r=new S(t,e),n=this.index[t.id()];return void 0===n?(this.index[t.id()]=this.array.length,this.array.push(r)):this.array[n]=r,r},t.prototype.erase=function(t){var e=this.index[t.id()];if(void 0!==e){this.index[t.id()]=void 0;var r=this.array[e],n=this.array.pop();return r!==n&&(this.array[e]=n,this.index[n.first.id()]=e),r}},t.prototype.copy=function(){for(var e=new t,r=0;r<this.array.length;r++){var n=this.array[r].copy();e.array[r]=n,e.index[n.first.id()]=r}return e},t}(),S=function(){function t(t,e){this.first=t,this.second=e}return t.prototype.copy=function(){return new t(this.first,this.second)},t}(),E=function(){function t(t){void 0===t&&(t=\\\"\\\"),this._value=0,this._context=null,this._id=N++,this._name=t}return t.prototype.id=function(){return this._id},t.prototype.name=function(){return this._name},t.prototype.setName=function(t){this._name=t},t.prototype.context=function(){return this._context},t.prototype.setContext=function(t){this._context=t},t.prototype.value=function(){return this._value},t.prototype.setValue=function(t){this._value=t},t.prototype.plus=function(t){return new k(this,t)},t.prototype.minus=function(t){return new k(this,\\\"number\\\"===typeof t?-t:[-1,t])},t.prototype.multiply=function(t){return new k([t,this])},t.prototype.divide=function(t){return new k([1/t,this])},t.prototype.toJSON=function(){return{name:this._name,value:this._value}},t.prototype.toString=function(){return this._context+\\\"[\\\"+this._name+\\\":\\\"+this._value+\\\"]\\\"},t}(),N=0,k=function(){function t(){var t=A(arguments);this._terms=t.terms,this._constant=t.constant}return t.prototype.terms=function(){return this._terms},t.prototype.constant=function(){return this._constant},t.prototype.value=function(){for(var t=this._constant,e=0,r=this._terms.size();e<r;e++){var n=this._terms.itemAt(e);t+=n.first.value()*n.second}return t},t.prototype.plus=function(e){return new t(this,e)},t.prototype.minus=function(e){return new t(this,\\\"number\\\"===typeof e?-e:[-1,e])},t.prototype.multiply=function(e){return new t([e,this])},t.prototype.divide=function(e){return new t([1/e,this])},t.prototype.isConstant=function(){return 0==this._terms.size()},t.prototype.toString=function(){var t=this._terms.array.map((function(t){return t.second+\\\"*\\\"+t.first.toString()})).join(\\\" + \\\");return this.isConstant()||0===this._constant||(t+=\\\" + \\\"),t+=this._constant},t}();function A(t){for(var e=0,r=function(){return 0},n=w(),o=0,i=t.length;o<i;++o){var a=t[o];if(\\\"number\\\"===typeof a)e+=a;else if(a instanceof E)n.setDefault(a,r).second+=1;else if(a instanceof k){e+=a.constant();for(var s=0,u=(l=a.terms()).size();s<u;s++){var c=l.itemAt(s);n.setDefault(c.first,r).second+=c.second}}else{if(!(a instanceof Array))throw new Error(\\\"invalid Expression argument: \\\"+a);if(2!==a.length)throw new Error(\\\"array must have length 2\\\");var f=a[0],p=a[1];if(\\\"number\\\"!==typeof f)throw new Error(\\\"array item 0 must be a number\\\");if(p instanceof E)n.setDefault(p,r).second+=f;else{if(!(p instanceof k))throw new Error(\\\"array item 1 must be a variable or expression\\\");e+=p.constant()*f;var l;for(s=0,u=(l=p.terms()).size();s<u;s++){c=l.itemAt(s);n.setDefault(c.first,r).second+=c.second*f}}}}return{terms:n,constant:e}}var j,O=function(){function t(){}return t.create=function(t,e,r,n){void 0===n&&(n=1);var o=0;return o+=1e6*Math.max(0,Math.min(1e3,t*n)),o+=1e3*Math.max(0,Math.min(1e3,e*n)),o+=Math.max(0,Math.min(1e3,r*n))},t.clip=function(e){return Math.max(0,Math.min(t.required,e))},t.required=t.create(1e3,1e3,1e3),t.strong=t.create(1,0,0),t.medium=t.create(0,1,0),t.weak=t.create(0,0,1),t}();!function(t){t[t.Le=0]=\\\"Le\\\",t[t.Ge=1]=\\\"Ge\\\",t[t.Eq=2]=\\\"Eq\\\"}(j||(j={}));var z,P=function(){function t(t,e,r,n){void 0===n&&(n=O.required),this._id=C++,this._operator=e,this._strength=O.clip(n),this._expression=void 0===r&&t instanceof k?t:t.minus(r)}return t.prototype.id=function(){return this._id},t.prototype.expression=function(){return this._expression},t.prototype.op=function(){return this._operator},t.prototype.strength=function(){return this._strength},t.prototype.toString=function(){return this._expression.toString()+\\\" \\\"+[\\\"<=\\\",\\\">=\\\",\\\"=\\\"][this._operator]+\\\" 0 (\\\"+this._strength.toString()+\\\")\\\"},t}(),C=0,D=function(){function t(){this._cnMap=w(),this._rowMap=w(),this._varMap=w(),this._editMap=w(),this._infeasibleRows=[],this._objective=new q,this._artificial=null,this._idTick=0}return t.prototype.createConstraint=function(t,e,r,n){void 0===n&&(n=O.required);var o=new P(t,e,r,n);return this.addConstraint(o),o},t.prototype.addConstraint=function(t){if(void 0!==this._cnMap.find(t))throw new Error(\\\"duplicate constraint\\\");var e=this._createRow(t),r=e.row,n=e.tag,o=this._chooseSubject(r,n);if(o.type()===z.Invalid&&r.allDummies()){if(!I(r.constant()))throw new Error(\\\"unsatisfiable constraint\\\");o=n.marker}if(o.type()===z.Invalid){if(!this._addWithArtificialVariable(r))throw new Error(\\\"unsatisfiable constraint\\\")}else r.solveFor(o),this._substitute(o,r),this._rowMap.insert(o,r);this._cnMap.insert(t,n),this._optimize(this._objective)},t.prototype.removeConstraint=function(t){var e=this._cnMap.erase(t);if(void 0===e)throw new Error(\\\"unknown constraint\\\");this._removeConstraintEffects(t,e.second);var r=e.second.marker,n=this._rowMap.erase(r);if(void 0===n){var o=this._getMarkerLeavingSymbol(r);if(o.type()===z.Invalid)throw new Error(\\\"failed to find leaving row\\\");(n=this._rowMap.erase(o)).second.solveForEx(o,r),this._substitute(r,n.second)}this._optimize(this._objective)},t.prototype.hasConstraint=function(t){return this._cnMap.contains(t)},t.prototype.addEditVariable=function(t,e){if(void 0!==this._editMap.find(t))throw new Error(\\\"duplicate edit variable\\\");if((e=O.clip(e))===O.required)throw new Error(\\\"bad required strength\\\");var r=new k(t),n=new P(r,j.Eq,void 0,e);this.addConstraint(n);var o={tag:this._cnMap.find(n).second,constraint:n,constant:0};this._editMap.insert(t,o)},t.prototype.removeEditVariable=function(t){var e=this._editMap.erase(t);if(void 0===e)throw new Error(\\\"unknown edit variable\\\");this.removeConstraint(e.second.constraint)},t.prototype.hasEditVariable=function(t){return this._editMap.contains(t)},t.prototype.suggestValue=function(t,e){var r=this._editMap.find(t);if(void 0===r)throw new Error(\\\"unknown edit variable\\\");var n=this._rowMap,o=r.second,i=e-o.constant;o.constant=e;var a=o.tag.marker,s=n.find(a);if(void 0!==s)return s.second.add(-i)<0&&this._infeasibleRows.push(a),void this._dualOptimize();var u=o.tag.other;if(void 0!==(s=n.find(u)))return s.second.add(i)<0&&this._infeasibleRows.push(u),void this._dualOptimize();for(var c=0,f=n.size();c<f;++c){var p=n.itemAt(c),l=p.second,h=l.coefficientFor(a);0!==h&&l.add(i*h)<0&&p.first.type()!==z.External&&this._infeasibleRows.push(p.first)}this._dualOptimize()},t.prototype.updateVariables=function(){for(var t=this._varMap,e=this._rowMap,r=0,n=t.size();r<n;++r){var o=t.itemAt(r),i=e.find(o.second);void 0!==i?o.first.setValue(i.second.constant()):o.first.setValue(0)}},t.prototype._getVarSymbol=function(t){var e=this;return this._varMap.setDefault(t,(function(){return e._makeSymbol(z.External)})).second},t.prototype._createRow=function(t){for(var e=t.expression(),r=new q(e.constant()),n=e.terms(),o=0,i=n.size();o<i;++o){var a=n.itemAt(o);if(!I(a.second)){var s=this._getVarSymbol(a.first),u=this._rowMap.find(s);void 0!==u?r.insertRow(u.second,a.second):r.insertSymbol(s,a.second)}}var c=this._objective,f=t.strength(),p={marker:R,other:R};switch(t.op()){case j.Le:case j.Ge:var l=t.op()===j.Le?1:-1,h=this._makeSymbol(z.Slack);if(p.marker=h,r.insertSymbol(h,l),f<O.required){var d=this._makeSymbol(z.Error);p.other=d,r.insertSymbol(d,-l),c.insertSymbol(d,f)}break;case j.Eq:if(f<O.required){var y=this._makeSymbol(z.Error),v=this._makeSymbol(z.Error);p.marker=y,p.other=v,r.insertSymbol(y,-1),r.insertSymbol(v,1),c.insertSymbol(y,f),c.insertSymbol(v,f)}else{var m=this._makeSymbol(z.Dummy);p.marker=m,r.insertSymbol(m)}}return r.constant()<0&&r.reverseSign(),{row:r,tag:p}},t.prototype._chooseSubject=function(t,e){for(var r=t.cells(),n=0,o=r.size();n<o;++n){var i=r.itemAt(n);if(i.first.type()===z.External)return i.first}var a=e.marker.type();return(a===z.Slack||a===z.Error)&&t.coefficientFor(e.marker)<0?e.marker:((a=e.other.type())===z.Slack||a===z.Error)&&t.coefficientFor(e.other)<0?e.other:R},t.prototype._addWithArtificialVariable=function(t){var e=this._makeSymbol(z.Slack);this._rowMap.insert(e,t.copy()),this._artificial=t.copy(),this._optimize(this._artificial);var r=I(this._artificial.constant());this._artificial=null;var n=this._rowMap.erase(e);if(void 0!==n){var o=n.second;if(o.isConstant())return r;var i=this._anyPivotableSymbol(o);if(i.type()===z.Invalid)return!1;o.solveForEx(e,i),this._substitute(i,o),this._rowMap.insert(i,o)}for(var a=this._rowMap,s=0,u=a.size();s<u;++s)a.itemAt(s).second.removeSymbol(e);return this._objective.removeSymbol(e),r},t.prototype._substitute=function(t,e){for(var r=this._rowMap,n=0,o=r.size();n<o;++n){var i=r.itemAt(n);i.second.substitute(t,e),i.second.constant()<0&&i.first.type()!==z.External&&this._infeasibleRows.push(i.first)}this._objective.substitute(t,e),this._artificial&&this._artificial.substitute(t,e)},t.prototype._optimize=function(t){for(;;){var e=this._getEnteringSymbol(t);if(e.type()===z.Invalid)return;var r=this._getLeavingSymbol(e);if(r.type()===z.Invalid)throw new Error(\\\"the objective is unbounded\\\");var n=this._rowMap.erase(r).second;n.solveForEx(r,e),this._substitute(e,n),this._rowMap.insert(e,n)}},t.prototype._dualOptimize=function(){for(var t=this._rowMap,e=this._infeasibleRows;0!==e.length;){var r=e.pop(),n=t.find(r);if(void 0!==n&&n.second.constant()<0){var o=this._getDualEnteringSymbol(n.second);if(o.type()===z.Invalid)throw new Error(\\\"dual optimize failed\\\");var i=n.second;t.erase(r),i.solveForEx(r,o),this._substitute(o,i),t.insert(o,i)}}},t.prototype._getEnteringSymbol=function(t){for(var e=t.cells(),r=0,n=e.size();r<n;++r){var o=e.itemAt(r),i=o.first;if(o.second<0&&i.type()!==z.Dummy)return i}return R},t.prototype._getDualEnteringSymbol=function(t){for(var e=Number.MAX_VALUE,r=R,n=t.cells(),o=0,i=n.size();o<i;++o){var a=n.itemAt(o),s=a.first,u=a.second;if(u>0&&s.type()!==z.Dummy){var c=this._objective.coefficientFor(s)/u;c<e&&(e=c,r=s)}}return r},t.prototype._getLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,r=R,n=this._rowMap,o=0,i=n.size();o<i;++o){var a=n.itemAt(o),s=a.first;if(s.type()!==z.External){var u=a.second,c=u.coefficientFor(t);if(c<0){var f=-u.constant()/c;f<e&&(e=f,r=s)}}}return r},t.prototype._getMarkerLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,r=e,n=e,o=R,i=o,a=o,s=o,u=this._rowMap,c=0,f=u.size();c<f;++c){var p=u.itemAt(c),l=p.second,h=l.coefficientFor(t);if(0!==h){var d=p.first;if(d.type()===z.External)s=d;else if(h<0){(y=-l.constant()/h)<r&&(r=y,i=d)}else{var y;(y=l.constant()/h)<n&&(n=y,a=d)}}}return i!==o?i:a!==o?a:s},t.prototype._removeConstraintEffects=function(t,e){e.marker.type()===z.Error&&this._removeMarkerEffects(e.marker,t.strength()),e.other.type()===z.Error&&this._removeMarkerEffects(e.other,t.strength())},t.prototype._removeMarkerEffects=function(t,e){var r=this._rowMap.find(t);void 0!==r?this._objective.insertRow(r.second,-e):this._objective.insertSymbol(t,-e)},t.prototype._anyPivotableSymbol=function(t){for(var e=t.cells(),r=0,n=e.size();r<n;++r){var o=e.itemAt(r),i=o.first.type();if(i===z.Slack||i===z.Error)return o.first}return R},t.prototype._makeSymbol=function(t){return new F(t,this._idTick++)},t}();function I(t){return t<0?-t<1e-8:t<1e-8}!function(t){t[t.Invalid=0]=\\\"Invalid\\\",t[t.External=1]=\\\"External\\\",t[t.Slack=2]=\\\"Slack\\\",t[t.Error=3]=\\\"Error\\\",t[t.Dummy=4]=\\\"Dummy\\\"}(z||(z={}));var F=function(){function t(t,e){this._id=e,this._type=t}return t.prototype.id=function(){return this._id},t.prototype.type=function(){return this._type},t}(),R=new F(z.Invalid,-1),q=function(){function t(t){void 0===t&&(t=0),this._cellMap=w(),this._constant=t}return t.prototype.cells=function(){return this._cellMap},t.prototype.constant=function(){return this._constant},t.prototype.isConstant=function(){return this._cellMap.empty()},t.prototype.allDummies=function(){for(var t=this._cellMap,e=0,r=t.size();e<r;++e){if(t.itemAt(e).first.type()!==z.Dummy)return!1}return!0},t.prototype.copy=function(){var e=new t(this._constant);return e._cellMap=this._cellMap.copy(),e},t.prototype.add=function(t){return this._constant+=t},t.prototype.insertSymbol=function(t,e){void 0===e&&(e=1),I(this._cellMap.setDefault(t,(function(){return 0})).second+=e)&&this._cellMap.erase(t)},t.prototype.insertRow=function(t,e){void 0===e&&(e=1),this._constant+=t._constant*e;for(var r=t._cellMap,n=0,o=r.size();n<o;++n){var i=r.itemAt(n);this.insertSymbol(i.first,i.second*e)}},t.prototype.removeSymbol=function(t){this._cellMap.erase(t)},t.prototype.reverseSign=function(){this._constant=-this._constant;for(var t=this._cellMap,e=0,r=t.size();e<r;++e){var n=t.itemAt(e);n.second=-n.second}},t.prototype.solveFor=function(t){var e=this._cellMap,r=-1/e.erase(t).second;this._constant*=r;for(var n=0,o=e.size();n<o;++n)e.itemAt(n).second*=r},t.prototype.solveForEx=function(t,e){this.insertSymbol(t,-1),this.solveFor(e)},t.prototype.coefficientFor=function(t){var e=this._cellMap.find(t);return void 0!==e?e.second:0},t.prototype.substitute=function(t,e){var r=this._cellMap.erase(t);void 0!==r&&this.insertRow(e,r.second)},t}(),V=function(t,e,r){for(var n=0;n<e;n+=1){var o,i=u(t);try{for(i.s();!(o=i.n()).done;){var a=o.value;a.base.solve(a,r)}}catch(s){i.e(s)}finally{i.f()}}},X=function(t,e){var r,n=new D,o={},i=function(t,e){return\\\"\\\".concat(t.id,\\\"_\\\").concat(e)},a=function(t,e){var r=i(t,e);if(!o[r]){var n=o[r]=new E;n.property=e,n.obj=t}},s=u(t);try{for(s.s();!(r=s.n()).done;){var c=r.value;a(c.a,c.base.property),a(c.b,c.base.property)}}catch(m){s.e(m)}finally{s.f()}var f,p=0,l=u(t);try{for(l.s();!(f=l.n()).done;){var h=f.value;try{n.addConstraint(h.base.strict(h,e,o[i(h.a,h.base.property)],o[i(h.b,h.base.property)]))}catch(m){p+=1}}}catch(m){l.e(m)}finally{l.f()}p>0&&console.warn(\\\"Skipped \\\".concat(p,\\\" unsolvable constraints\\\")),n.updateVariables();for(var d=0,y=Object.values(o);d<y.length;d++){var v=y[d];v.obj[v.property]=v.value()}},L={property:\\\"y\\\",strict:function(t,e,r,n){return new P(r.minus(n),j.Ge,e.spaceY,O.required)}},T={property:\\\"y\\\",strict:function(t,e,r,n){return new P(r.minus(n),j.Ge,e.layerSpace,O.required)}},G={property:\\\"x\\\",solve:function(t){var e=t.a,r=t.b,n=t.strength*(e.x-r.x);e.x-=n,r.x+=n},strict:function(t,e,r,n){return new P(r.minus(n),j.Eq,0,O.create(1,0,0,t.strength))}},Y={property:\\\"x\\\",solve:function(t){var e=t.edgeA,r=t.edgeB,n=t.separationA,o=t.separationB,i=t.strength,a=i*((e.sourceNode.x-r.sourceNode.x-n)/n),s=i*((e.targetNode.x-r.targetNode.x-o)/o);e.sourceNode.x-=a,r.sourceNode.x+=a,e.targetNode.x-=s,r.targetNode.x+=s}},U={property:\\\"x\\\",strict:function(t,e,r,n){return new P(n.minus(r),j.Ge,t.separation,O.required)}},B=function(t){var e,r=t.nodes,n=t.edges,o=t.layers,i=t.spaceX,a=t.spaceY,s=t.spreadX,c=t.layerSpaceY,f=t.iterations,p=u(r);try{for(p.s();!(e=p.n()).done;){var l=e.value;l.x=0,l.y=0}}catch(M){p.e(M)}finally{p.f()}var h={spaceX:i,spaceY:a,spreadX:s,layerSpace:.5*(a+c)},d=W(n),y=J(r,o);X([].concat(x(d),x(y)),h);for(var m=v(r),g=$(n,h),_=H(n,h),b=0;b<f;b+=1)V(g,1,h),V(_,50,h);var w=K(m,h);X([].concat(x(w),x(_)),h),Q(n,m,a)},W=function(t){return t.map((function(t){return{base:L,a:t.targetNode,b:t.sourceNode}}))},J=function(t,e){var r=[];if(!e)return r;for(var n=e.map((function(e){return t.filter((function(t){return t.nearestLayer===e}))})),o=0;o<n.length-1;o+=1){var i,a=n[o],s=n[o+1],c={id:\\\"layer-\\\".concat(o),x:0,y:0},f=u(a);try{for(f.s();!(i=f.n()).done;){var p=i.value;r.push({base:T,a:c,b:p})}}catch(y){f.e(y)}finally{f.f()}var l,h=u(s);try{for(h.s();!(l=h.n()).done;){var d=l.value;r.push({base:T,a:d,b:c})}}catch(y){h.e(y)}finally{h.f()}}return r},$=function(t,e){for(var r=e.spaceX,n=[],o=0;o<t.length;o+=1)for(var i=t[o],a=i.sourceNode,s=i.targetNode,u=a.sources.length+a.targets.length+s.sources.length+s.targets.length,c=o+1;c<t.length;c+=1){var f=t[c],p=f.sourceNode,l=f.targetNode;if(!(a.row>=l.row||s.row<=p.row)){var h=p.sources.length+p.targets.length+l.sources.length+l.targets.length;n.push({base:Y,edgeA:i,edgeB:f,separationA:.5*a.width+r+.5*p.width,separationB:.5*s.width+r+.5*l.width,strength:1/Math.max(1,(u+h)/4)})}}return n},H=function(t){return t.map((function(t){var e=t.sourceNode,r=t.targetNode;return{base:G,a:e,b:r,strength:.6/Math.max(1,e.targets.length+r.sources.length-2)}}))},K=function(t,e){for(var r=e.spaceX,n=[],o=0;o<t.length;o+=1){var i=t[o];i.sort((function(t,e){return m(t.x,e.x,t.id,e.id)}));for(var a=0;a<i.length-1;a+=1){var s=i[a],u=i[a+1],c=Math.max(1,s.targets.length+s.sources.length-2),p=Math.max(1,u.targets.length+u.sources.length-2),l=Math.min(10,c*p*e.spreadX),h=f(l*r,r);n.push({base:U,a:s,b:u,separation:.5*s.width+h+.5*u.width})}}return n},Q=function(t,e,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.25,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.25,i=Z(t),a=Math.round(r*o),s=0,c=0;c<e.length-1;c+=1){var p=i[c]||0,l=f(p*n*r,a);s+=l;var h,d=u(e[c+1]);try{for(d.s();!(h=d.n()).done;){var y=h.value;y.y+=s}}catch(v){d.e(v)}finally{d.f()}}},Z=function(t){var e,r={},n=u(t);try{for(n.s();!(e=n.n()).done;){var o=e.value,i=Math.abs(p(o.targetNode,o.sourceNode)-c)/c,a=o.sourceNode.row,s=o.targetNode.row-1;r[a]=r[a]||[0,0],r[a][0]+=i,r[a][1]+=1,s!==a&&(r[s]=r[s]||[0,0],r[s][0]+=i,r[s][1]+=1)}}catch(l){n.e(l)}finally{n.f()}for(var f in r)r[f]=r[f][0]/(r[f][1]||1);return Object.values(r)},tt=function(t){var e,r=t.nodes,n=t.edges,o=t.spaceX,a=t.spaceY,s=t.minPassageGap,c=t.stemUnit,f=t.stemMinSource,g=t.stemMinTarget,_=t.stemMax,w=t.stemSpaceSource,M=t.stemSpaceTarget,S=v(r),E=u(r);try{for(E.s();!(e=E.n()).done;){e.value.targets.sort((function(t,e){return m(p(e.sourceNode,e.targetNode),p(t.sourceNode,t.targetNode))}))}}catch(mt){E.e(mt)}finally{E.f()}var N,k,A,j=u(n);try{for(j.s();!(N=j.n()).done;){var O=N.value,z=O.sourceNode,P=O.targetNode;O.points=[];for(var C=Math.min((z.width-w)/z.targets.length,w)*(z.targets.indexOf(O)-.5*(z.targets.length-1)),D={x:z.x+C,y:z.y},I=z.row+1;I<P.row;I+=1){for(var F=S[I][0],R={x:l(F)-o,y:F.y},q=1/0,V=[i(i({},F),{},{x:Number.MIN_SAFE_INTEGER})].concat(x(S[I]),[i(i({},F),{},{x:Number.MAX_SAFE_INTEGER})]),X=0;X<V.length-1;X+=1){var L=V[X],T=V[X+1],G=l(T)-h(L);if(!(G<s)){var Y=Math.min(o,.5*G),U=b(D.x,D.y,h(L)+Y,d(L)-a,l(T)-Y,d(T)-a),B=(k=D.x,A=U.x,Math.abs(k-A));if(B>q)break;B<q&&(q=B,R=U)}}var W=F.height+a;O.points.push({x:R.x+C,y:R.y}),O.points.push({x:R.x+C,y:R.y+W}),D={x:R.x,y:R.y+W}}}}catch(mt){j.e(mt)}finally{j.f()}var J,$=u(r);try{for($.s();!(J=$.n()).done;){var H=J.value;H.targets.sort((function(t,e){return m(p(e.sourceNode,e.points[0]||e.targetNode),p(t.sourceNode,t.points[0]||t.targetNode))})),H.sources.sort((function(t,e){return m(p(t.points[t.points.length-1]||t.sourceNode,t.targetNode),p(e.points[e.points.length-1]||e.sourceNode,e.targetNode))}))}}catch(mt){$.e(mt)}finally{$.f()}var K,Q=u(n);try{for(Q.s();!(K=Q.n()).done;){var Z,tt=K.value,et=tt.sourceNode,rt=tt.targetNode,nt=Math.min((et.width-w)/et.targets.length,w),ot=Math.min((rt.width-M)/rt.sources.length,M),it=et.targets.indexOf(tt)-.5*(et.targets.length-1),at=rt.sources.indexOf(tt)-.5*(rt.sources.length-1),st=nt*it,ut=ot*at,ct=c*et.targets.length*(1-Math.abs(it)/et.targets.length),ft=c*rt.sources.length*(1-Math.abs(at)/rt.sources.length),pt=[{x:et.x+st,y:y(et)},{x:et.x+st,y:y(et)+f},{x:et.x+st,y:y(et)+f+Math.min(ct,_)}],lt=[{x:rt.x+ut,y:d(rt)-g-Math.min(ft,_)},{x:rt.x+ut,y:d(rt)-g},{x:rt.x+ut,y:d(rt)}],ht=[].concat(pt,x(tt.points),lt),dt=ht[0].y,yt=u(ht);try{for(yt.s();!(Z=yt.n()).done;){var vt=Z.value;vt.y<dt?vt.y=dt:dt=vt.y}}catch(mt){yt.e(mt)}finally{yt.f()}tt.points=ht}}catch(mt){Q.e(mt)}finally{Q.f()}},et={layout:{spaceX:14,spaceY:110,layerSpaceY:55,spreadX:2.2,padding:100,iterations:25},routing:{spaceX:26,spaceY:28,minPassageGap:40,stemUnit:8,stemMinSource:5,stemMinTarget:5,stemMax:20,stemSpaceSource:6,stemSpaceTarget:10}},rt=function(t,e){var r,n={},o=u(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i.id]=i,i.targets=[],i.sources=[]}}catch(f){o.e(f)}finally{o.f()}var a,s=u(e);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.sourceNode=n[c.source],c.targetNode=n[c.target],c.sourceNode.targets.push(c),c.targetNode.sources.push(c)}}catch(f){s.e(f)}finally{s.f()}},nt=function(t,e){if(e&&e.length>0){var r,n={},o=u(e);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i]=!0}}catch(h){o.e(h)}finally{o.f()}var a,s=function(t){return Boolean(t&&t.layer in n)},c=e[e.length-1],f=u(t);try{for(f.s();!(a=f.n()).done;){var p=a.value,l=at(p,ot,it,s);p.nearestLayer=l?l.layer:c}}catch(h){f.e(h)}finally{f.f()}}},ot=function(t){return t.targets.map((function(t){return t.targetNode}))},it=function(t,e){return t.rank-e.rank},at=function t(e,r,n,o,i){return o(e)?e:((i=i||{})[e.id]=!0,r(e).filter((function(t){return!i[t.id]})).sort(n).map((function(e){return t(e,r,n,o,i)})).filter(o).sort(n)[0])},st=function(t,e){var r,n={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},o=u(t);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=i.x,s=i.y;a<n.min.x&&(n.min.x=a),a>n.max.x&&(n.max.x=a),s<n.min.y&&(n.min.y=s),s>n.max.y&&(n.max.y=s)}}catch(c){o.e(c)}finally{o.f()}return n.width=n.max.x-n.min.x+2*e,n.height=n.max.y-n.min.y+2*e,n.min.x-=e,n.min.y-=e,n},ut=function(t){var e=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:et;rt(t,e),nt(t,r),B(i({nodes:t,edges:e,layers:r},n.layout)),tt(i({nodes:t,edges:e,layers:r},n.routing));var o=st(t,n.layout.padding);return t.forEach((function(t){return g(t,o.min)})),e.forEach((function(t){return _(t,o.min)})),{nodes:t,edges:e,layers:r,size:o}}(t.nodes,t.edges,t.layers);return i(i({},e),{},{size:i(i({},e.size),{},{marginx:100,marginy:100})})};addEventListener(\\\"message\\\",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;\\\"RPC\\\"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject(\\\"No such method\\\")).then((function(t){postMessage({type:\\\"RPC\\\",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:\\\"RPC\\\",id:a,error:e})}))})),postMessage({type:\\\"RPC\\\",method:\\\"ready\\\"})}]);\\n//# sourceMappingURL=2f1baf0dc7e9501ac0ca.worker.js.map\"])), { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","export const RESET_DATA = 'RESET_DATA';\n\n/**\n * Overwrite the existing data store when receiving new data from upstream\n * @param {Object} data New pipeline state data\n */\nexport function resetData(data) {\n  return {\n    type: RESET_DATA,\n    data,\n  };\n}\n\nexport const TOGGLE_LAYERS = 'TOGGLE_LAYERS';\n\n/**\n * Toggle whether to show layers on/off\n * @param {Boolean} visible True if layers are to be shown\n */\nexport function toggleLayers(visible) {\n  return {\n    type: TOGGLE_LAYERS,\n    visible,\n  };\n}\n\nexport const TOGGLE_EXPORT_MODAL = 'TOGGLE_EXPORT_MODAL';\n\n/**\n * Toggle whether to show the export modal\n * @param {Boolean} visible True if the modal is to be shown\n */\nexport function toggleExportModal(visible) {\n  return {\n    type: TOGGLE_EXPORT_MODAL,\n    visible,\n  };\n}\n\nexport const TOGGLE_SETTINGS_MODAL = 'TOGGLE_SETTINGS_MODAL';\n\n/**\n * Toggle whether to show the settings modal\n * @param {Boolean} visible True if the modal is to be shown\n */\nexport function toggleSettingsModal(visible) {\n  return {\n    type: TOGGLE_SETTINGS_MODAL,\n    visible,\n  };\n}\n\nexport const TOGGLE_PLOT_MODAL = 'TOGGLE_PLOT_MODAL';\n\n/**\n * Toggle whether to show the plot modal\n * @param {Boolean} visible True if the modal is to be shown\n */\nexport function togglePlotModal(visible) {\n  return {\n    type: TOGGLE_PLOT_MODAL,\n    visible,\n  };\n}\n\nexport const TOGGLE_GRAPH = 'TOGGLE_GRAPH';\n\n/**\n * Toggle graph visible/hidden\n * @param {boolean} visible Whether graph is shown\n */\nexport function toggleGraph(visible) {\n  return {\n    type: TOGGLE_GRAPH,\n    visible,\n  };\n}\n\nexport const TOGGLE_TEXT_LABELS = 'TOGGLE_TEXT_LABELS';\n\n/**\n * Toggle whether to show text labels on/off\n * @param {Boolean} textLabels True if text labels are to be shown\n */\nexport function toggleTextLabels(textLabels) {\n  return {\n    type: TOGGLE_TEXT_LABELS,\n    textLabels,\n  };\n}\n\nexport const TOGGLE_PRETTY_NAME = 'TOGGLE_PRETTY_NAME';\n\n/**\n * Toggle whether to show pretty name on/off\n * @param {Boolean} prettyName True if pretty name is to be shown\n */\nexport function togglePrettyName(prettyName) {\n  return {\n    type: TOGGLE_PRETTY_NAME,\n    prettyName,\n  };\n}\n\nexport const TOGGLE_SIDEBAR = 'TOGGLE_SIDEBAR';\n\n/**\n * Toggle sidebar visible/hidden\n * @param {boolean} visible Whether sidebar nav is shown\n */\nexport function toggleSidebar(visible) {\n  return {\n    type: TOGGLE_SIDEBAR,\n    visible,\n  };\n}\n\nexport const TOGGLE_THEME = 'TOGGLE_THEME';\n\n/**\n * Switch between light/dark theme\n * @param {string} theme Theme name\n */\nexport function toggleTheme(theme) {\n  return {\n    type: TOGGLE_THEME,\n    theme,\n  };\n}\n\nexport const UPDATE_CHART_SIZE = 'UPDATE_CHART_SIZE';\n\n/**\n * Store the chart size, based on the window\n * @param {Object} chartSize getBoundingClientRect value\n */\nexport function updateChartSize(chartSize) {\n  return {\n    type: UPDATE_CHART_SIZE,\n    chartSize,\n  };\n}\n\nexport const UPDATE_ZOOM = 'UPDATE_ZOOM';\n\n/**\n * Store the zoom\n * @param {Object} zoom The zoom transform\n */\nexport function updateZoom(zoom) {\n  return {\n    type: UPDATE_ZOOM,\n    zoom,\n  };\n}\n\nexport const UPDATE_FONT_LOADED = 'UPDATE_FONT_LOADED';\n\n/**\n * Update whether the webfont has loaded, which should block the chart render\n * @param {Boolean} fontLoaded Whether the font has loaded\n */\nexport function updateFontLoaded(fontLoaded) {\n  return {\n    type: UPDATE_FONT_LOADED,\n    fontLoaded,\n  };\n}\n\nexport const TOGGLE_MINIMAP = 'TOGGLE_MINIMAP';\n\n/**\n * Toggle mini map\n * @param {string} visible Visibility status\n */\nexport function toggleMiniMap(visible) {\n  return {\n    type: TOGGLE_MINIMAP,\n    visible,\n  };\n}\n\nexport const CHANGE_FLAG = 'CHANGE_FLAG';\n\n/**\n * Change the given feature flag\n * @param {string} name The flag name\n * @param {value} value The value to set\n */\nexport function changeFlag(name, value) {\n  return {\n    type: CHANGE_FLAG,\n    name,\n    value,\n  };\n}\n\nexport const TOGGLE_IGNORE_LARGE_WARNING = 'TOGGLE_IGNORE_LARGE_WARNING';\n\n/**\n * Resets the ignoreLargeWarning field in the state indicating user preference to enable large graphs to load\n * @param {boolean} ignoreLargeWarning\n */\nexport function toggleIgnoreLargeWarning(ignoreLargeWarning) {\n  return {\n    type: TOGGLE_IGNORE_LARGE_WARNING,\n    ignoreLargeWarning,\n  };\n}\n\nexport const TOGGLE_CODE = 'TOGGLE_CODE';\n\n/**\n * Toggle code panel\n * @param {string} visible Visibility status\n */\nexport function toggleCode(visible) {\n  return {\n    type: TOGGLE_CODE,\n    visible,\n  };\n}\n\nexport const TOGGLE_PARAMETERS_HOVERED = 'TOGGLE_PARAMETERS_HOVERED';\n\n/**\n * Update the value of the currently-active hovered node\n * @param {string|null} nodeHovered The node's unique identifier\n */\nexport function toggleParametersHovered(hoveredParameters) {\n  return {\n    type: TOGGLE_PARAMETERS_HOVERED,\n    hoveredParameters,\n  };\n}\n\nexport const TOGGLE_MODULAR_PIPELINE_FOCUS_MODE =\n  'TOGGLE_MODULAR_PIPELINE_FOCUS_MODE';\n\n/**\n * Update the value of the selected modular pipeline under focus mode\n * @param {Object} modularPipeline The selected modular pipeline for focus mode\n */\nexport function toggleFocusMode(modularPipeline) {\n  return {\n    type: TOGGLE_MODULAR_PIPELINE_FOCUS_MODE,\n    modularPipeline,\n  };\n}\n","import { CHANGE_FLAG } from '../actions';\n\nfunction flagsReducer(flagsState = {}, action) {\n  switch (action.type) {\n    case CHANGE_FLAG: {\n      return Object.assign({}, flagsState, {\n        [action.name]: action.value,\n      });\n    }\n\n    default:\n      return flagsState;\n  }\n}\n\nexport default flagsReducer;\n","// This file contains any web-workers used in the app, which are inlined by\n// webpack + workerize-loader, so that they can be used in the exported library\n// without needing any special configuration on the part of the consumer.\n// Web workers don't work in Jest, so in a test environment we directly import\n// them instead, and then mock up a faux-worker function\n\n/* eslint-disable import/no-webpack-loader-syntax */\n\n// Check for test environment\nconst isTest = typeof jest !== 'undefined';\n\n// Conditionally load task via web worker only in non-test env\nconst graphWorker = isTest\n  ? require('./graph')\n  : require('workerize-loader?inline!./graph');\n\n/**\n * Emulate a web worker for testing purposes\n */\nconst createMockWorker = (worker) => {\n  if (!isTest) {\n    return worker;\n  }\n  return () => {\n    const mockWorker = {\n      terminate: () => {},\n    };\n    Object.keys(worker).forEach((name) => {\n      mockWorker[name] = (payload) =>\n        new Promise((resolve) => resolve(worker[name](payload)));\n    });\n    return mockWorker;\n  };\n};\n\nexport const graph = createMockWorker(graphWorker);\n\n/**\n * Manage the worker, avoiding race conditions by terminating running\n * processes when a new request is made, and reinitialising the instance.\n * Example getJob: (instance, payload) => instance.job(payload)\n * @param {function} worker Init worker and return job functions\n * @param {function} getJob Callback to select correct job function\n * @return {function} Function which returns a promise\n */\nexport function preventWorkerQueues(worker, getJob) {\n  let instance = worker();\n  let running = false;\n\n  return (payload) => {\n    if (running) {\n      // If worker is already processing a job, cancel it and restart\n      instance.terminate();\n      instance = worker();\n    }\n    running = true;\n\n    return getJob(instance, payload).then((response) => {\n      running = false;\n      return response;\n    });\n  };\n}\n","import { graph as worker, preventWorkerQueues } from '../utils/worker';\nimport { toggleGraph } from './index';\n\nexport const TOGGLE_GRAPH_LOADING = 'TOGGLE_GRAPH_LOADING';\n\n/**\n * Toggle whether to display the loading spinner\n * @param {boolean} loading\n */\nexport function toggleLoading(loading) {\n  return {\n    type: TOGGLE_GRAPH_LOADING,\n    loading,\n  };\n}\n\nexport const UPDATE_GRAPH_LAYOUT = 'UPDATE_GRAPH_LAYOUT';\n\n/**\n * Update the graph layout object\n * @param {Object} graph\n */\nexport function updateGraph(graph) {\n  return {\n    type: UPDATE_GRAPH_LAYOUT,\n    graph,\n  };\n}\n\n/**\n * Assign layout engine to use based on the newgraph\n * @param {Object} instance Worker parent instance\n * @param {Object} state A subset of main state\n * @return {function} Promise function\n */\nconst layout = (instance, state) => instance.graphNew(state);\n\n// Prepare new layout worker\nconst layoutWorker = preventWorkerQueues(worker, layout);\n\n/**\n * Async action to calculate graph layout in a web worker\n * whiled displaying a loading spinner\n * @param {Object} graphState A subset of main state\n * @return {function} A promise that resolves when the calcuation is done\n */\nexport function calculateGraph(graphState) {\n  if (!graphState) {\n    return updateGraph(graphState);\n  }\n  return async function (dispatch) {\n    dispatch(toggleLoading(true));\n    const graph = await layoutWorker(graphState);\n    dispatch(toggleGraph(true));\n    dispatch(toggleLoading(false));\n    return dispatch(updateGraph(graph));\n  };\n}\n","import { UPDATE_GRAPH_LAYOUT } from '../actions/graph';\n\nfunction nodeReducer(graphState = {}, action) {\n  const updateState = (newState) => Object.assign({}, graphState, newState);\n\n  switch (action.type) {\n    case UPDATE_GRAPH_LAYOUT: {\n      return updateState(action.graph);\n    }\n\n    default:\n      return graphState;\n  }\n}\n\nexport default nodeReducer;\n","import { TOGGLE_LAYERS } from '../actions';\n\nfunction layerReducer(layerState = {}, action) {\n  switch (action.type) {\n    case TOGGLE_LAYERS: {\n      return Object.assign({}, layerState, {\n        visible: action.visible,\n      });\n    }\n\n    default:\n      return layerState;\n  }\n}\n\nexport default layerReducer;\n","export const pathRoot = './api';\n\nexport const localStorageName = 'KedroViz';\n\n// These values are used in both SCSS and JS, and we don't have variable-sharing\n// across Sass and JavaScript, so they're defined in two places. If you update their\n// value here, please also update their corresponding value in src/styles/_variables.scss\nexport const metaSidebarWidth = {\n  open: 400,\n  closed: 0,\n};\nexport const sidebarWidth = {\n  open: 400,\n  closed: 56,\n  breakpoint: 700,\n};\nexport const codeSidebarWidth = {\n  open: 480,\n  closed: 0,\n};\n\nexport const chartMinWidthScale = 0.25;\n\n// Determine the number of nodes and edges in pipeline to trigger size warning\nexport const largeGraphThreshold = 1000;\n\n// Remember to update the 'Flags' section in the README when updating these:\nexport const flags = {\n  sizewarning: {\n    name: 'Size Warning',\n    description: 'Show a warning before rendering very large graphs',\n    default: true,\n    icon: '',\n  },\n};\n\nexport const settings = {\n  prettyName: {\n    name: 'Pretty Name',\n    description: 'Display a formatted name for the kedro nodes',\n    default: true,\n  },\n};\n\n// Sidebar groups is an ordered map of { id: label }\nexport const sidebarGroups = {\n  elementType: 'Element types',\n  tag: 'Tags',\n};\n\n// Sidebar element types is an ordered map of { id: label }\nexport const sidebarElementTypes = {\n  task: 'Nodes',\n  data: 'Datasets',\n  parameters: 'Parameters',\n};\n\nexport const shortTypeMapping = {\n  'kedro.extras.datasets.plotly.plotly_dataset.PlotlyDataSet': 'plotly',\n};\n","//--- Useful JS utility functions ---//\n\nimport { pathRoot } from '../config';\n\n/**\n * Loop through an array and output to an object\n * @param {Array} array\n * @param {Function} callback\n */\nexport const arrayToObject = (array, callback) => {\n  const newObject = {};\n  array.forEach((key) => {\n    newObject[key] = callback(key);\n  });\n  return newObject;\n};\n\n/**\n * Determine the endpoint URL for loading different data types\n * @param {string} type Data type\n * @param {string=} id Endpoint identifier e.g. pipeline ID\n */\nexport const getUrl = (type, id) => {\n  switch (type) {\n    case 'main':\n      return [pathRoot, 'main'].join('/');\n    case 'pipeline':\n      if (!id) {\n        throw new Error('No pipeline ID provided');\n      }\n      return [pathRoot, 'pipelines', id].join('/');\n    case 'nodes':\n      if (!id) {\n        throw new Error('No node ID provided');\n      }\n      return [pathRoot, 'nodes', id].join('/');\n    default:\n      throw new Error('Unknown URL type');\n  }\n};\n\n/**\n * Filter duplicate values from an array\n * @param {any} d Datum\n * @param {number} i Index\n * @param {Array} arr The array to remove duplicate values from\n */\nexport const unique = (d, i, arr) => arr.indexOf(d) === i;\n\n/**\n * Returns true if any of the given props are different between given objects.\n * Only shallow changes are detected.\n * @param {Array} props The prop names to check\n * @param {object} objectA The first object\n * @param {object} objectB The second object\n * @returns {boolean} True if any prop changed else false\n */\nexport const changed = (props, objectA, objectB) => {\n  return (\n    objectA && objectB && props.some((prop) => objectA[prop] !== objectB[prop])\n  );\n};\n","import { json } from 'd3-fetch';\nimport { getUrl } from '../utils';\n\n/**\n * Asynchronously load and parse data from json file using d3-fetch.\n * Throws an error if the request for `main` fails.\n * For requests other than `main`, returns the given or default fallback response.\n * @param {string} path JSON file location. Defaults to main data url from config.js\n * @param {object} fallback The fallback response object on request failure. Default `{}`.\n * @return {function} A promise that will return when the file is loaded and parsed\n */\nconst loadJsonData = (path = getUrl('main'), fallback = {}) =>\n  json(path).catch(() => {\n    const fullPath = `/public${path.substr(1)}`;\n\n    // For main route throw a user error\n    if (path === getUrl('main')) {\n      throw new Error(\n        `Unable to load data from ${path}. If you're running Kedro-Viz as a standalone (e.g. for JavaScript development), please check that you have placed a data file at ${fullPath}.`\n      );\n    }\n\n    return new Promise((resolve) => resolve(fallback));\n  });\n\nexport default loadJsonData;\n","import { localStorageName } from '../config';\n\nconst noWindow = typeof window === 'undefined';\n\n/**\n * Retrieve state data from localStorage\n * @return {Object} State\n */\nexport const loadState = () => {\n  if (noWindow) {\n    return {};\n  }\n  try {\n    const serializedState = window.localStorage.getItem(localStorageName);\n    if (serializedState === null) {\n      return {};\n    }\n    return JSON.parse(serializedState);\n  } catch (err) {\n    console.error(err);\n    return {};\n  }\n};\n\n/**\n * Save updated state to localStorage\n * @param {Object} state New state object\n */\nexport const saveState = (state) => {\n  if (noWindow) {\n    return;\n  }\n  try {\n    const newState = Object.assign(loadState(), state);\n    // Remove deprecated key from localStorage to suppress error.\n    // This can be removed in future versions of KedroViz:\n    if (newState.hasOwnProperty('nodeTypeDisabled')) {\n      delete newState.nodeTypeDisabled;\n    }\n    const serializedState = JSON.stringify(newState);\n    window.localStorage.setItem(localStorageName, serializedState);\n  } catch (err) {\n    console.error(err);\n  }\n};\n\n/**\n * Remove unnecessary keys to prevent them being stored in state forever\n * @param {object} obj An object containing keys and booleans\n * @return {object} A new clone object but with the falsey keys removed\n */\nexport const pruneFalseyKeys = (obj) => {\n  const newObj = {};\n  for (let key in obj) {\n    if (obj.hasOwnProperty(key) && obj[key]) {\n      newObj[key] = obj[key];\n    }\n  }\n  return newObj;\n};\n","import { arrayToObject } from '../utils';\n\n/**\n * Create new default pipeline state instance\n * @return {object} state\n */\nexport const createInitialPipelineState = () => ({\n  pipeline: {\n    ids: [],\n    name: {},\n  },\n  modularPipeline: {\n    ids: [],\n    tree: {},\n    visible: {},\n    expanded: [],\n    active: {},\n  },\n  node: {\n    ids: [],\n    name: {},\n    fullName: {},\n    type: {},\n    tags: {},\n    layer: {},\n    disabled: {},\n    pipelines: {},\n    clicked: null,\n    hovered: null,\n    fetched: {},\n    code: {},\n    parameters: {},\n    filepath: {},\n    inputs: {},\n    outputs: {},\n    plot: {},\n    metrics: {},\n    datasetType: {},\n    originalType: {},\n    transcodedTypes: {},\n    runCommand: {},\n    modularPipelines: {},\n  },\n  nodeType: {\n    ids: ['task', 'data', 'parameters', 'modularPipeline'],\n    name: {\n      data: 'Datasets',\n      task: 'Nodes',\n      parameters: 'Parameters',\n      modularPipeline: 'Modular Pipelines',\n    },\n    disabled: {},\n  },\n  edge: {\n    ids: [],\n    sources: {},\n    targets: {},\n  },\n  layer: {\n    ids: [],\n    name: {},\n    visible: true,\n  },\n  tag: {\n    ids: [],\n    name: {},\n    active: {},\n    enabled: {},\n  },\n  hoveredParameters: false,\n});\n\n/**\n * Check whether data is in expected format\n * @param {Object} data - The parsed data input\n * @return {Boolean} True if valid for formatting\n */\nconst validateInput = (data) => {\n  if (!data) {\n    throw new Error('No data provided to Kedro-Viz');\n  }\n  if (data === 'json') {\n    // Data is still loading\n    return false;\n  }\n  if (!Array.isArray(data.edges) || !Array.isArray(data.nodes)) {\n    if (typeof jest === 'undefined') {\n      console.error('Invalid Kedro-Viz data:', data);\n    }\n    throw new Error(\n      'Invalid Kedro-Viz data input. Please ensure that your pipeline data includes arrays of nodes and edges'\n    );\n  }\n  return true;\n};\n\n/**\n * Get unique, reproducible ID for each edge, based on its nodes\n * @param {Object} source - Name and type of the source node\n * @param {Object} target - Name and type of the target node\n */\nconst createEdgeID = (source, target) => [source, target].join('|');\n\n/**\n * Add a new pipeline\n * @param {string} pipeline.id - Unique ID\n * @param {string} pipeline.name - Pipeline name\n */\nconst addPipeline = (state) => (pipeline) => {\n  const { id } = pipeline;\n  if (state.pipeline.name[id]) {\n    return;\n  }\n  state.pipeline.ids.push(id);\n  state.pipeline.name[id] = pipeline.name;\n};\n\n/**\n * Add a new node if it doesn't already exist\n * @param {string} name - Default node name\n * @param {string} type - 'data' or 'task'\n * @param {Array} tags - List of associated tags\n */\nconst addNode = (state) => (node) => {\n  const { id } = node;\n  if (state.node.name[id]) {\n    return;\n  }\n  state.node.ids.push(id);\n  state.node.name[id] = node.name;\n  state.node.fullName[id] = node.full_name || node.name;\n  state.node.type[id] = node.type;\n  state.node.layer[id] = node.layer;\n  state.node.pipelines[id] = node.pipelines\n    ? arrayToObject(node.pipelines, () => true)\n    : {};\n  state.node.tags[id] = node.tags || [];\n  // supports for metadata in case it exists on initial load\n  state.node.code[id] = node.code;\n  state.node.parameters[id] = node.parameters;\n  state.node.filepath[id] = node.filepath;\n  state.node.plot[id] = node.plot;\n  state.node.datasetType[id] = node.dataset_type;\n  state.node.originalType[id] = node.original_type;\n  state.node.transcodedTypes[id] = node.transcoded_types;\n  state.node.runCommand[id] = node.runCommand;\n  state.node.modularPipelines[id] = node.modular_pipelines || [];\n};\n\n/**\n * Create a new link between two nodes and add it to the edges array\n * @param {Object} source - Parent node\n * @param {Object} target - Child node\n */\nconst addEdge =\n  (state) =>\n  ({ source, target }) => {\n    const id = createEdgeID(source, target);\n    if (state.edge.ids.includes(id)) {\n      return;\n    }\n    state.edge.ids.push(id);\n    state.edge.sources[id] = source;\n    state.edge.targets[id] = target;\n  };\n\n/**\n * Add a new Tag if it doesn't already exist\n * @param {Object} tag - Tag object\n */\nconst addTag = (state) => (tag) => {\n  const { id } = tag;\n  state.tag.ids.push(id);\n  state.tag.name[id] = tag.name;\n};\n\n/**\n * Add a new Layer if it doesn't already exist\n * @param {Object} layer - Layer object\n */\nconst addLayer = (state) => (layer) => {\n  // using layer name as both layerId and name.\n  // It futureproofs it if we need a separate layer ID in the future.\n  state.layer.ids.push(layer);\n  state.layer.name[layer] = layer;\n};\n\n/**\n * Convert the pipeline data into a normalized state object\n * @param {Object} data Raw unformatted data input\n * @return {Object} Formatted, normalized state\n */\nconst normalizeData = (data) => {\n  const state = createInitialPipelineState();\n\n  if (data === 'json') {\n    state.dataSource = 'json';\n  } else if (data.source) {\n    state.dataSource = data.source;\n  }\n\n  if (!validateInput(data)) {\n    return state;\n  }\n\n  data.nodes.forEach(addNode(state));\n  data.edges.forEach(addEdge(state));\n  if (data.pipelines) {\n    data.pipelines.forEach(addPipeline(state));\n    if (state.pipeline.ids.length) {\n      state.pipeline.main = data.selected_pipeline || state.pipeline.ids[0];\n      state.pipeline.active = state.pipeline.main;\n    }\n  }\n  if (data.modular_pipelines) {\n    state.modularPipeline.ids = Object.keys(data.modular_pipelines);\n    state.modularPipeline.tree = data.modular_pipelines;\n    for (const child of data.modular_pipelines['__root__'].children) {\n      state.modularPipeline.visible[child.id] = true;\n    }\n  }\n\n  if (data.tags) {\n    data.tags.forEach(addTag(state));\n  }\n  if (data.layers) {\n    data.layers.forEach(addLayer(state));\n  }\n\n  return state;\n};\n\nexport default normalizeData;\n","import { flags as flagsConfig } from '../config';\n\n/**\n * Flag definitions\n */\nexport const Flags = {\n  /**\n   * Returns `true` if the flag is defined otherwise `false`\n   * @param {string} name The flag name to test\n   * @returns {boolean} The result\n   */\n  isDefined: (name) => Flags.names().includes(name),\n\n  /**\n   * Returns an array of defined flag names\n   * @returns {array} The defined flag names\n   */\n  names: () => Object.keys(flagsConfig),\n\n  /**\n   * Returns an object mapping flag names to their default values\n   * @returns {object} The defined flag defaults\n   */\n  defaults: () =>\n    Flags.names().reduce(\n      (result, flag) =>\n        Object.assign(result, { [flag]: flagsConfig[flag].default }),\n      {}\n    ),\n};\n\n/**\n * Returns an object with flags as set in given or current URL\n * @param {string=} url The URL (optional, default current location)\n * @returns {object} An object with flags and their values\n */\nexport const getFlagsFromUrl = (url) => {\n  const flags = {};\n\n  let urlParams;\n  try {\n    urlParams = new URL(url || document.location.href).searchParams;\n  } catch (e) {\n    console.warn('Feature flags are not supported in this browser');\n    return flags;\n  }\n\n  [...urlParams].forEach(([name, value]) =>\n    Flags.isDefined(name)\n      ? (flags[name] = value === 'true' || value === '1' || value === '')\n      : null\n  );\n\n  return flags;\n};\n\n/**\n * Returns a user info message describing the status of all defined flags\n * @param {object} flagsEnabled An object mapping of flag status\n * @returns {string} The info message\n */\nexport const getFlagsMessage = (flagsEnabled) => {\n  const allNames = Flags.names();\n\n  if (allNames.length > 0) {\n    let info = 'Experimental features \\n';\n\n    allNames.forEach((name) => {\n      if (flagsConfig[name].private) {\n        return;\n      }\n      const isEnabled = flagsEnabled[name];\n      const status = isEnabled ? 'Enabled' : 'Disabled';\n      const statusIcon = isEnabled ? '' : '';\n      const icon = flagsConfig[name].icon;\n      const description = flagsConfig[name].description;\n      info += `\\n${statusIcon} ${icon} \"${name}\"  ${description}  ${status}`;\n    });\n\n    info += `\\n\\nSee docs on flags for more info `;\n    info += `\\nhttps://github.com/quantumblacklabs/kedro-viz#flags`;\n\n    return info;\n  }\n};\n\nexport const getFlagsState = () => {\n  const allNames = Flags.names();\n  return allNames.map((flag) => {\n    return {\n      name: flagsConfig[flag].name,\n      value: flag,\n      description: flagsConfig[flag].description,\n    };\n  });\n};\n","import deepmerge from 'deepmerge';\nimport { loadState, saveState } from './helpers';\nimport normalizeData from './normalize-data';\nimport { getFlagsFromUrl, Flags } from '../utils/flags';\nimport { settings, sidebarWidth } from '../config';\n\n/**\n * Create new default state instance for properties that aren't overridden\n * when the pipeline is reset with new data via the App component's data prop\n * @return {object} state\n */\nexport const createInitialState = () => ({\n  chartSize: {},\n  flags: Flags.defaults(),\n  textLabels: true,\n  theme: 'dark',\n  prettyName: settings.prettyName.default,\n  ignoreLargeWarning: false,\n  loading: {\n    graph: false,\n    pipeline: false,\n    node: false,\n  },\n  visible: {\n    graph: true,\n    labelBtn: true,\n    layerBtn: true,\n    exportBtn: true,\n    settingsBtn: true,\n    exportModal: false,\n    plotModal: false,\n    settingsModal: false,\n    sidebar: window.innerWidth > sidebarWidth.breakpoint,\n    code: false,\n    themeBtn: true,\n    miniMapBtn: true,\n    miniMap: true,\n    modularPipelineFocusMode: null,\n  },\n  zoom: {},\n});\n\n/**\n * Load values from localStorage and combine with existing state,\n * but filter out any unused values from localStorage\n * @param {object} state Initial/extant state\n * @return {object} Combined state from localStorage\n */\nexport const mergeLocalStorage = (state) => {\n  const localStorageState = loadState();\n  Object.keys(localStorageState).forEach((key) => {\n    if (!state[key]) {\n      delete localStorageState[key];\n    }\n  });\n  return deepmerge(state, localStorageState);\n};\n\n/**\n * Prepare the pipeline data part of the state by normalizing the raw data,\n * and applying saved state from localStorage.\n * This part is separated so that it can be reset without overriding user settings,\n * because it can be run both on initial state load and again later on.\n * The applyFixes part should only ever be run once, on first load.\n * Exactly when it runs depends on whether the data is loaded asynchronously or not.\n * @param {object} data Data prop passed to App component\n * @param {boolean} applyFixes Whether to override initialState\n */\nexport const preparePipelineState = (data, applyFixes) => {\n  const state = mergeLocalStorage(normalizeData(data));\n  if (applyFixes) {\n    // Use main pipeline if active pipeline from localStorage isn't recognised\n    if (!state.pipeline.ids.includes(state.pipeline.active)) {\n      state.pipeline.active = state.pipeline.main;\n    }\n  }\n  return state;\n};\n\n/**\n * Prepare the non-pipeline data part of the state. This part is separated so that it\n * will persist if the pipeline data is reset.\n * Merge local storage and add custom state overrides from props etc\n * @param {object} props Props passed to App component\n * @return {object} Updated initial state\n */\nexport const prepareNonPipelineState = (props) => {\n  const state = mergeLocalStorage(createInitialState());\n\n  return {\n    ...state,\n    flags: { ...state.flags, ...getFlagsFromUrl() },\n    theme: props.theme || state.theme,\n    visible: { ...state.visible, ...props.visible },\n  };\n};\n\n/**\n * Configure the redux store's initial state, by merging default values\n * with normalised pipeline data and localStorage.\n * If parameters flag is set to true, then disable parameters on initial load\n * @param {object} props App component props\n * @return {object} Initial state\n */\nconst getInitialState = (props = {}) => {\n  const nonPipelineState = prepareNonPipelineState(props);\n  saveState({\n    nodeType: {\n      // Default to disabled parameters and other types enabled\n      disabled: { parameters: true, task: false, data: false },\n    },\n  });\n  const pipelineState = preparePipelineState(props.data, props.data !== 'json');\n  return {\n    ...nonPipelineState,\n    ...pipelineState,\n  };\n};\n\nexport default getInitialState;\n","import { getUrl } from '../utils';\nimport loadJsonData from '../store/load-data';\nimport { preparePipelineState } from '../store/initial-state';\nimport { resetData, toggleGraph } from './index';\n\n/**\n * This file contains actions that update the active pipeline, and if loading data\n * asynchronously, they also handle loading this pipeline data from different endpoints.\n *\n * Many different cases need to be addressed, including:\n * 1. Loading data synchronously, or asynchonously.\n * 2. Loading data and updating the pipeline on first page load, or on user actions.\n * 3. Whether the dataset has pipelines defined in it, or not.\n * 4. Whether localStorage has an active pipeline already defined.\n * 5. If so, whether it exists in the current dataset.\n * 6. Whether the requested endpoint is the 'main' one, or not.\n *\n * These are mostly handled either within this file, in the preparePipelineState\n * utility, or in the getNodeDisabledPipeline selector. Please see their tests\n * for more info about implementation requirements.\n */\n\nexport const UPDATE_ACTIVE_PIPELINE = 'UPDATE_ACTIVE_PIPELINE';\n\n/**\n * Update the actively-selected pipeline\n * @param {string} pipeline Pipeline ID\n */\nexport function updateActivePipeline(pipeline) {\n  return {\n    type: UPDATE_ACTIVE_PIPELINE,\n    pipeline,\n  };\n}\n\nexport const TOGGLE_PIPELINE_LOADING = 'TOGGLE_PIPELINE_LOADING';\n\n/**\n * Toggle whether to display the loading spinner\n * @param {boolean} loading True if pipeline is still loading\n */\nexport function toggleLoading(loading) {\n  return {\n    type: TOGGLE_PIPELINE_LOADING,\n    loading,\n  };\n}\n\n/**\n * Determine where to load data from\n * @param {object} pipeline Pipeline state\n */\nexport const getPipelineUrl = (pipeline) => {\n  if (pipeline.active === pipeline.main) {\n    return getUrl('main');\n  }\n  return getUrl('pipeline', pipeline.active);\n};\n\n/**\n * Check whether another async data pipeline request is needed on first page-load.\n * A second request is typically only required when an active pipeline is set in\n * localStorage, and it's not the 'main' pipeline endpoint.\n * @param {object} pipeline Pipeline state\n * @return {boolean} True if another request is needed\n */\nexport const requiresSecondRequest = (pipeline) => {\n  // Pipelines are not present in the data\n  if (!pipeline.ids.length || !pipeline.main) {\n    return false;\n  }\n  // There is no active pipeline set\n  if (!pipeline.active) {\n    return false;\n  }\n  // The active pipeline is not 'main'\n  return pipeline.active !== pipeline.main;\n};\n\n/**\n * Load pipeline data on initial page-load\n * @return {function} A promise that resolves when the data is loaded\n */\nexport function loadInitialPipelineData() {\n  return async function (dispatch, getState) {\n    // Get a copy of the full state from the store\n    const state = getState();\n    // If data is passed synchronously then this process isn't necessary\n    if (state.dataSource !== 'json') {\n      return;\n    }\n    dispatch(toggleLoading(true));\n    // Load 'main' data file. This is always loaded first, because it's needed\n    // in order to obtain the list of pipelines, which is required for determining\n    // whether the active pipeline (from localStorage) exists in the data.\n    const url = getUrl('main');\n    let newState = await loadJsonData(url).then((data) =>\n      preparePipelineState(data, true)\n    );\n    // If the active pipeline isn't 'main' then request data from new URL\n    if (requiresSecondRequest(newState.pipeline)) {\n      const url = getPipelineUrl(newState.pipeline);\n      newState = await loadJsonData(url).then(preparePipelineState);\n    }\n    dispatch(resetData(newState));\n    dispatch(toggleLoading(false));\n  };\n}\n\n/**\n * Change pipeline on selection, loading new data if necessary\n * @param {string} pipelineID Unique ID for new pipeline\n * @return {function} A promise that resolves when the data is loaded\n */\nexport function loadPipelineData(pipelineID) {\n  return async function (dispatch, getState) {\n    const { dataSource, pipeline } = getState();\n    if (pipelineID && pipelineID === pipeline.active) {\n      return;\n    }\n    if (dataSource === 'json') {\n      dispatch(toggleLoading(true));\n      // Remove the previous graph to show that a new pipeline is being loaded\n      dispatch(toggleGraph(false));\n      const url = getPipelineUrl({\n        main: pipeline.main,\n        active: pipelineID,\n      });\n      const newState = await loadJsonData(url).then(preparePipelineState);\n      // Set active pipeline here rather than dispatching two separate actions,\n      // to improve performance by only requiring one state recalculation\n      newState.pipeline.active = pipelineID;\n      dispatch(resetData(newState));\n      dispatch(toggleLoading(false));\n    } else {\n      dispatch(updateActivePipeline(pipelineID));\n    }\n  };\n}\n","import { getUrl } from '../utils';\nimport loadJsonData from '../store/load-data';\n\nexport const TOGGLE_NODE_CLICKED = 'TOGGLE_NODE_CLICKED';\n\n/**\n * Update the value of the currently-active clicked node\n * @param {string|null} nodeClicked The node's unique identifier\n */\nexport function toggleNodeClicked(nodeClicked) {\n  return {\n    type: TOGGLE_NODE_CLICKED,\n    nodeClicked,\n  };\n}\n\nexport const TOGGLE_NODES_DISABLED = 'TOGGLE_NODES_DISABLED';\n\n/**\n * Toggle a selected group of nodes' visibility on/off\n * @param {Array} nodeIDs The nodes' unique identifiers\n * @param {Boolean} isDisabled Whether the node should be visible\n */\nexport function toggleNodesDisabled(nodeIDs, isDisabled) {\n  return {\n    type: TOGGLE_NODES_DISABLED,\n    nodeIDs,\n    isDisabled,\n  };\n}\n\nexport const TOGGLE_NODE_HOVERED = 'TOGGLE_NODE_HOVERED';\n\n/**\n * Update the value of the currently-active hovered node\n * @param {string|null} nodeHovered The node's unique identifier\n */\nexport function toggleNodeHovered(nodeHovered) {\n  return {\n    type: TOGGLE_NODE_HOVERED,\n    nodeHovered,\n  };\n}\n\nexport const TOGGLE_NODE_DATA_LOADING = 'TOGGLE_NODE_DATA_LOADING';\n\n/**\n * Toggle whether to display the loading spinner\n * @param {boolean} loading True if pipeline is still loading\n */\nexport function toggleNodeDataLoading(loading) {\n  return {\n    type: TOGGLE_NODE_DATA_LOADING,\n    loading,\n  };\n}\n\nexport const ADD_NODE_METADATA = 'ADD_NODE_METADATA';\n\n/**\n * Toggle whether to display the loading spinner\n * @param {boolean} loading True if pipeline is still loading\n */\nexport function addNodeMetadata(data) {\n  return {\n    type: ADD_NODE_METADATA,\n    data,\n  };\n}\n\n/**\n * update node metadata on selection, loading new data if it has not been previously called\n * @param {string} nodeID node id of clicked node\n * @return {function} A promise that resolves when the data is loaded\n */\nexport function loadNodeData(nodeID) {\n  return async function (dispatch, getState) {\n    const { dataSource, node } = getState();\n\n    // since we don't have design for a modular pipeline metadata side panel just yet,\n    // disable clicking on modular pipeline node\n    if (node.type[nodeID] === 'modularPipeline') {\n      return;\n    }\n\n    dispatch(toggleNodeClicked(nodeID));\n\n    if (dataSource === 'json' && nodeID && !node.fetched[nodeID]) {\n      dispatch(toggleNodeDataLoading(true));\n      const url = getUrl('nodes', nodeID);\n      const nodeData = await loadJsonData(url);\n      dispatch(addNodeMetadata({ id: nodeID, data: nodeData }));\n      dispatch(toggleNodeDataLoading(false));\n    }\n  };\n}\n","import { TOGGLE_GRAPH_LOADING } from '../actions/graph';\nimport { TOGGLE_PIPELINE_LOADING } from '../actions/pipelines';\nimport { TOGGLE_NODE_DATA_LOADING } from '../actions/nodes';\n\nfunction loadingReducer(loadingState = {}, action) {\n  switch (action.type) {\n    case TOGGLE_PIPELINE_LOADING: {\n      return Object.assign({}, loadingState, {\n        pipeline: action.loading,\n      });\n    }\n\n    case TOGGLE_GRAPH_LOADING: {\n      return Object.assign({}, loadingState, {\n        graph: action.loading,\n      });\n    }\n\n    case TOGGLE_NODE_DATA_LOADING: {\n      return Object.assign({}, loadingState, {\n        node: action.loading,\n      });\n    }\n\n    default:\n      return loadingState;\n  }\n}\n\nexport default loadingReducer;\n","import {\n  TOGGLE_NODE_CLICKED,\n  TOGGLE_NODES_DISABLED,\n  TOGGLE_NODE_HOVERED,\n  ADD_NODE_METADATA,\n} from '../actions/nodes';\nimport { UPDATE_ACTIVE_PIPELINE } from '../actions/pipelines';\n\nfunction nodeReducer(nodeState = {}, action) {\n  const updateState = (newState) => Object.assign({}, nodeState, newState);\n\n  switch (action.type) {\n    case TOGGLE_NODE_CLICKED: {\n      return updateState({\n        clicked: action.nodeClicked,\n      });\n    }\n\n    case TOGGLE_NODES_DISABLED: {\n      return updateState({\n        clicked: action.nodeIDs.includes(nodeState.clicked)\n          ? null\n          : nodeState.clicked,\n        disabled: action.nodeIDs.reduce(\n          (disabled, id) =>\n            Object.assign({}, disabled, {\n              [id]: action.isDisabled,\n            }),\n          nodeState.disabled\n        ),\n      });\n    }\n\n    case TOGGLE_NODE_HOVERED: {\n      return updateState({\n        hovered: action.nodeHovered,\n      });\n    }\n\n    case UPDATE_ACTIVE_PIPELINE: {\n      return updateState({\n        clicked: null,\n        hovered: null,\n      });\n    }\n\n    case ADD_NODE_METADATA: {\n      const { id, data } = action.data;\n      return updateState({\n        fetched: Object.assign({}, nodeState.fetched, {\n          [id]: true,\n        }),\n        code: Object.assign({}, nodeState.code, {\n          [id]: data.code,\n        }),\n        filepath: Object.assign({}, nodeState.filepath, {\n          [id]: data.filepath,\n        }),\n        parameters: Object.assign({}, nodeState.parameters, {\n          [id]: data.parameters,\n        }),\n        inputs: Object.assign({}, nodeState.inputs, {\n          [id]: data.inputs,\n        }),\n        outputs: Object.assign({}, nodeState.outputs, {\n          [id]: data.outputs,\n        }),\n        // the data returned from the API under the field name 'type' for dataset type nodes\n        datasetType: Object.assign({}, nodeState.datasetType, {\n          [id]: data.type,\n        }),\n        originalType: Object.assign({}, nodeState.originalType, {\n          [id]: data.original_type,\n        }),\n        transcodedTypes: Object.assign({}, nodeState.transcodedTypes, {\n          [id]: data.transcoded_types,\n        }),\n        plot: Object.assign({}, nodeState.plot, {\n          [id]: data.plot,\n        }),\n        metrics: Object.assign({}, nodeState.metrics, {\n          [id]: data.metrics,\n        }),\n        runCommand: Object.assign({}, nodeState.runCommand, {\n          [id]: data.run_command,\n        }),\n      });\n    }\n\n    default:\n      return nodeState;\n  }\n}\n\nexport default nodeReducer;\n","export const TOGGLE_TYPE_DISABLED = 'TOGGLE_TYPE_DISABLED';\n\n/**\n * The default enabled / disabled value for all types is 'unset', meaning not explicitly set by user.\n * The value `0` is chosen to be falsy, JSON serializable but distinct from `false`.\n * In this state the type is effectively enabled by default, see reducers/node-type.js for usage.\n */\nexport const NODE_TYPE_DISABLED_UNSET = 0;\n\n/**\n * Toggle one or more node-type's visibility on/off\n * @param {string|Object} typeIDs A single type id string, or an object map of type id to disabled booleans\n * @param {?Boolean} disabled True if type is disabled (when passing a single type id string)\n */\nexport function toggleTypeDisabled(typeIDs, disabled) {\n  return {\n    type: TOGGLE_TYPE_DISABLED,\n    typeIDs: typeof typeIDs === 'string' ? { [typeIDs]: disabled } : typeIDs,\n  };\n}\n","import {\n  TOGGLE_TYPE_DISABLED,\n  NODE_TYPE_DISABLED_UNSET,\n} from '../actions/node-type';\n\n/**\n * See actions/node-type.js for details on the 'unset' value.\n */\nconst allNodeTypesUnset = {\n  parameters: NODE_TYPE_DISABLED_UNSET,\n  task: NODE_TYPE_DISABLED_UNSET,\n  data: NODE_TYPE_DISABLED_UNSET,\n};\n\nconst isNodeTypeUnset = (nodeTypeValue) =>\n  nodeTypeValue === NODE_TYPE_DISABLED_UNSET;\n\nconst isNodeTypeDisabled = (nodeTypeValue) => nodeTypeValue === true;\n\nfunction nodeTypeReducer(nodeTypeState = {}, action) {\n  switch (action.type) {\n    case TOGGLE_TYPE_DISABLED: {\n      const nextDisabledState = {\n        ...nodeTypeState.disabled,\n        ...action.typeIDs,\n      };\n\n      const nextTypesDisabled = Object.values(nextDisabledState);\n\n      // If no types will be enabled\n      if (nextTypesDisabled.every(isNodeTypeDisabled)) {\n        // Then reset all types to unset (defaulting to enabled)\n        return {\n          ...nodeTypeState,\n          disabled: { ...allNodeTypesUnset },\n        };\n      }\n\n      // At least one type is enabled, set any unset types to disabled\n      for (const type in nextDisabledState) {\n        if (isNodeTypeUnset(nextDisabledState[type])) {\n          nextDisabledState[type] = true;\n        }\n      }\n\n      return {\n        ...nodeTypeState,\n        disabled: nextDisabledState,\n      };\n    }\n    default:\n      return nodeTypeState;\n  }\n}\n\nexport default nodeTypeReducer;\n","import { UPDATE_ACTIVE_PIPELINE } from '../actions/pipelines';\n\nfunction pipelineReducer(pipelineState = {}, action) {\n  switch (action.type) {\n    case UPDATE_ACTIVE_PIPELINE: {\n      return Object.assign({}, pipelineState, {\n        active: action.pipeline,\n      });\n    }\n\n    default:\n      return pipelineState;\n  }\n}\n\nexport default pipelineReducer;\n","export const TOGGLE_TAG_ACTIVE = 'TOGGLE_TAG_ACTIVE';\n\n/**\n * Toggle a tag's highlighting on/off (or array of tags)\n * @param {string|Array} tagIDs Tag id(s)\n * @param {Boolean} active True if tag(s) active\n */\nexport function toggleTagActive(tagIDs, active) {\n  return {\n    type: TOGGLE_TAG_ACTIVE,\n    tagIDs: Array.isArray(tagIDs) ? tagIDs : [tagIDs],\n    active,\n  };\n}\n\nexport const TOGGLE_TAG_FILTER = 'TOGGLE_TAG_FILTER';\n\n/**\n * Toggle a tag's filtering on/off (or array of tags)\n * @param {string|Array} tagIDs Tag id(s)\n * @param {Boolean} enabled True if tag(s) enabled\n */\nexport function toggleTagFilter(tagIDs, enabled) {\n  return {\n    type: TOGGLE_TAG_FILTER,\n    tagIDs: Array.isArray(tagIDs) ? tagIDs : [tagIDs],\n    enabled,\n  };\n}\n","import { TOGGLE_TAG_ACTIVE, TOGGLE_TAG_FILTER } from '../actions/tags';\n\nfunction tagReducer(tagState = {}, action) {\n  const updateState = (newState) => Object.assign({}, tagState, newState);\n\n  /**\n   * Batch update tags from an array of tag IDs\n   * @param {string} key Tag action value prop\n   */\n  const batchChanges = (key) =>\n    action.tagIDs.reduce((result, tagID) => {\n      result[tagID] = action[key];\n      return result;\n    }, {});\n\n  switch (action.type) {\n    case TOGGLE_TAG_ACTIVE: {\n      return updateState({\n        active: Object.assign({}, tagState.active, batchChanges('active')),\n      });\n    }\n\n    case TOGGLE_TAG_FILTER: {\n      return updateState({\n        enabled: Object.assign({}, tagState.enabled, batchChanges('enabled')),\n      });\n    }\n\n    default:\n      return tagState;\n  }\n}\n\nexport default tagReducer;\n","export const TOGGLE_MODULAR_PIPELINE_ACTIVE = 'TOGGLE_MODULAR_PIPELINE_ACTIVE';\n\n/**\n * Toggle a modular pipeline item's highlighting on/off (or array of modular pipelines)\n * @param {string|Array} modularPipelineIDs Modular pipeline id(s)\n * @param {Boolean} active True if modualr pipeline(s) active\n */\nexport function toggleModularPipelineActive(modularPipelineIDs, active) {\n  return {\n    type: TOGGLE_MODULAR_PIPELINE_ACTIVE,\n    modularPipelineIDs: Array.isArray(modularPipelineIDs)\n      ? modularPipelineIDs\n      : [modularPipelineIDs],\n    active,\n  };\n}\n\nexport const TOGGLE_MODULAR_PIPELINE_EXPANDED =\n  'TOGGLE_MODULAR_PIPELINE_EXPANDED';\n\n/**\n * Toggle a set of modular pipelines to be expanded.\n * @param {Array[Number]} expandedIDs\n */\nexport function toggleModularPipelineExpanded(expandedIDs) {\n  return {\n    type: TOGGLE_MODULAR_PIPELINE_EXPANDED,\n    expandedIDs,\n  };\n}\n","import {\n  TOGGLE_MODULAR_PIPELINE_ACTIVE,\n  TOGGLE_MODULAR_PIPELINE_EXPANDED,\n} from '../actions/modular-pipelines';\n\nfunction modularPipelineReducer(modularPipelineState = {}, action) {\n  const updateState = (newState) =>\n    Object.assign({}, modularPipelineState, newState);\n\n  /**\n   * Batch update tags from an array of tag IDs\n   * @param {string} key Tag action value prop\n   */\n  const batchChanges = (key) =>\n    action.modularPipelineIDs.reduce((result, modularPipelineID) => {\n      result[modularPipelineID] = action[key];\n      return result;\n    }, {});\n\n  switch (action.type) {\n    case TOGGLE_MODULAR_PIPELINE_ACTIVE: {\n      return updateState({\n        active: Object.assign(\n          {},\n          modularPipelineState.active,\n          batchChanges('active')\n        ),\n      });\n    }\n\n    // The expanded IDs for tree nodes directly emitted from modular pipelines\n    // are not directly usable for our purpose. For example, for a tree a -> b -> c,\n    // when a is collapsed, [b,c] are passed to the action payload as expanded.\n    // What we care about, however, is not what is currently \"expanded\", but actually\n    // what is currently \"visible\" on the tree.\n    // Therefore there are 2 states here: expanded and visible.\n    // We use expanded state and the action's payload to work out what's visible:\n    // - When a modular pipeline is collapsed, we have to mark all of its children\n    // as invisible recursively.\n    // - When a modular pipeline is expanded, we have to mark all of its children\n    // as visible, but not recursively.\n    case TOGGLE_MODULAR_PIPELINE_EXPANDED: {\n      const newVisibleState = { ...modularPipelineState.visible };\n      const isExpanding =\n        action.expandedIDs.length > modularPipelineState.expanded.length;\n      let expandedIDs = action.expandedIDs;\n\n      if (isExpanding) {\n        const expandedModularPipelines = expandedIDs.filter(\n          (expandedID) => !modularPipelineState.expanded.includes(expandedID)\n        );\n        expandedModularPipelines.forEach((expandedModularPipeline) => {\n          newVisibleState[expandedModularPipeline] = false;\n          modularPipelineState.tree[expandedModularPipeline].children.forEach(\n            (child) => (newVisibleState[child.id] = true)\n          );\n        });\n      } else {\n        const collapsedModularPipelines = modularPipelineState.expanded.filter(\n          (expandedID) => !expandedIDs.includes(expandedID)\n        );\n\n        // recursively set all children of a node in the tree as invisible\n        const setChildrenInvisible = (node) => {\n          modularPipelineState.tree[node].children.forEach((child) => {\n            newVisibleState[child.id] = false;\n            if (child.type === 'modularPipeline') {\n              setChildrenInvisible(child.id);\n            }\n          });\n        };\n\n        collapsedModularPipelines.forEach((collapsedModularPipeline) => {\n          newVisibleState[collapsedModularPipeline] = true;\n          setChildrenInvisible(collapsedModularPipeline);\n          expandedIDs = expandedIDs.filter(\n            (id) => !id.startsWith(collapsedModularPipeline)\n          );\n        });\n      }\n\n      return updateState({\n        expanded: expandedIDs,\n        visible: newVisibleState,\n      });\n    }\n\n    default:\n      return modularPipelineState;\n  }\n}\n\nexport default modularPipelineReducer;\n","import {\n  TOGGLE_GRAPH,\n  TOGGLE_EXPORT_MODAL,\n  TOGGLE_SETTINGS_MODAL,\n  TOGGLE_PLOT_MODAL,\n  TOGGLE_SIDEBAR,\n  TOGGLE_CODE,\n  TOGGLE_MINIMAP,\n  TOGGLE_MODULAR_PIPELINE_FOCUS_MODE,\n} from '../actions';\n\nfunction visibleReducer(visibleState = {}, action) {\n  switch (action.type) {\n    case TOGGLE_GRAPH: {\n      return Object.assign({}, visibleState, {\n        graph: action.visible,\n      });\n    }\n\n    case TOGGLE_PLOT_MODAL: {\n      return Object.assign({}, visibleState, {\n        plotModal: action.visible,\n      });\n    }\n\n    case TOGGLE_EXPORT_MODAL: {\n      return Object.assign({}, visibleState, {\n        exportModal: action.visible,\n      });\n    }\n\n    case TOGGLE_SETTINGS_MODAL: {\n      return Object.assign({}, visibleState, {\n        settingsModal: action.visible,\n      });\n    }\n\n    case TOGGLE_SIDEBAR: {\n      return Object.assign({}, visibleState, {\n        sidebar: action.visible,\n      });\n    }\n\n    case TOGGLE_MINIMAP: {\n      return Object.assign({}, visibleState, {\n        miniMap: action.visible,\n      });\n    }\n\n    case TOGGLE_CODE: {\n      return Object.assign({}, visibleState, {\n        code: action.visible,\n      });\n    }\n\n    case TOGGLE_MODULAR_PIPELINE_FOCUS_MODE: {\n      return Object.assign({}, visibleState, {\n        modularPipelineFocusMode: action.modularPipeline,\n      });\n    }\n\n    default:\n      return visibleState;\n  }\n}\n\nexport default visibleReducer;\n","import { combineReducers } from 'redux';\nimport flags from './flags';\nimport graph from './graph';\nimport layer from './layers';\nimport loading from './loading';\nimport node from './nodes';\nimport nodeType from './node-type';\nimport pipeline from './pipeline';\nimport tag from './tags';\nimport modularPipeline from './modular-pipelines';\nimport visible from './visible';\nimport {\n  RESET_DATA,\n  TOGGLE_TEXT_LABELS,\n  TOGGLE_THEME,\n  UPDATE_CHART_SIZE,\n  UPDATE_ZOOM,\n  UPDATE_FONT_LOADED,\n  TOGGLE_IGNORE_LARGE_WARNING,\n  TOGGLE_PRETTY_NAME,\n} from '../actions';\nimport { TOGGLE_PARAMETERS_HOVERED } from '../actions';\n\n/**\n * Create a generic reducer\n * @param {*} initialState Default state\n * @param {string} type Action type\n * @param {string} key Action payload key\n * @return {*} Updated state\n */\nconst createReducer =\n  (initialState, type, key) =>\n  (state = initialState, action) => {\n    if (typeof key !== 'undefined' && action.type === type) {\n      return action[key];\n    }\n    return state;\n  };\n\n/**\n * Reset/update application-wide data\n * @param {Object} state Complete app state\n * @param {Object} action Redux action\n * @return {Object} Updated(?) state\n */\nfunction resetDataReducer(state = {}, action) {\n  if (action.type === RESET_DATA) {\n    return Object.assign({}, state, action.data);\n  }\n  return state;\n}\n\nconst combinedReducer = combineReducers({\n  // These props have their own reducers in other files\n  flags,\n  graph,\n  layer,\n  loading,\n  node,\n  nodeType,\n  pipeline,\n  tag,\n  modularPipeline,\n  visible,\n  // These props don't have any actions associated with them\n  dataSource: createReducer(null),\n  edge: createReducer({}),\n  // These props have very simple non-nested actions\n  chartSize: createReducer({}, UPDATE_CHART_SIZE, 'chartSize'),\n  zoom: createReducer({}, UPDATE_ZOOM, 'zoom'),\n  fontLoaded: createReducer(false, UPDATE_FONT_LOADED, 'fontLoaded'),\n  textLabels: createReducer(true, TOGGLE_TEXT_LABELS, 'textLabels'),\n  theme: createReducer('dark', TOGGLE_THEME, 'theme'),\n  prettyName: createReducer(true, TOGGLE_PRETTY_NAME, 'prettyName'),\n  hoveredParameters: createReducer(\n    false,\n    TOGGLE_PARAMETERS_HOVERED,\n    'hoveredParameters'\n  ),\n  ignoreLargeWarning: createReducer(\n    false,\n    TOGGLE_IGNORE_LARGE_WARNING,\n    'ignoreLargeWarning'\n  ),\n});\n\nconst rootReducer = (state, action) =>\n  combinedReducer(resetDataReducer(state, action), action);\n\nexport default rootReducer;\n","import { createSelector } from 'reselect';\nimport { arrayToObject } from '../utils';\n\nconst getNodeIDs = (state) => state.node.ids;\nconst getNodePipelines = (state) => state.node.pipelines;\nconst getActivePipeline = (state) => state.pipeline.active;\nconst getNodeTags = (state) => state.node.tags;\nconst getNodeModularPipelines = (state) => state.node.modularPipelines;\nconst getDataSource = (state) => state.dataSource;\nconst getModularPipelineIDs = (state) => state.modularPipeline.ids;\n\n/**\n * Calculate whether nodes should be disabled based on their registered pipelines\n */\nexport const getNodeDisabledPipeline = createSelector(\n  [getNodeIDs, getNodePipelines, getActivePipeline, getDataSource],\n  (nodeIDs, nodePipelines, activePipeline, dataSource) => {\n    if (dataSource === 'json' || !activePipeline) {\n      return {};\n    }\n    return arrayToObject(\n      nodeIDs,\n      (nodeID) => !nodePipelines[nodeID][activePipeline]\n    );\n  }\n);\n\n/**\n * Get a list of just the IDs for the active pipeline\n */\nexport const getPipelineNodeIDs = createSelector(\n  [getNodeIDs, getNodeDisabledPipeline],\n  (nodeIDs, nodeDisabledPipeline) =>\n    nodeIDs.filter((nodeID) => !nodeDisabledPipeline[nodeID])\n);\n\n/**\n * Get IDs of tags used in the current pipeline\n */\nexport const getPipelineTagIDs = createSelector(\n  [getPipelineNodeIDs, getNodeTags],\n  (nodeIDs, nodeTags) => {\n    const visibleTags = {};\n    nodeIDs.forEach((nodeID) => {\n      nodeTags[nodeID].forEach((tagID) => {\n        if (!visibleTags[tagID]) {\n          visibleTags[tagID] = true;\n        }\n      });\n    });\n    return Object.keys(visibleTags);\n  }\n);\n\n/**\n * Get IDs of modular pipelines used in the current pipeline\n */\nexport const getPipelineModularPipelineIDs = createSelector(\n  [getPipelineNodeIDs, getNodeModularPipelines, getModularPipelineIDs],\n  (nodeIDs, nodeModularPipelines, modularPipelineIDs) => {\n    const visibleModularPipelines = {};\n    // check if pipeline contains defined modular pipelines\n    if (modularPipelineIDs.length > 0) {\n      nodeIDs.forEach((nodeID) => {\n        nodeModularPipelines[nodeID].forEach((modularPipelineID) => {\n          if (\n            modularPipelineID &&\n            !visibleModularPipelines[modularPipelineID]\n          ) {\n            visibleModularPipelines[modularPipelineID] = true;\n          }\n        });\n      });\n    }\n    return Object.keys(visibleModularPipelines);\n  }\n);\n","import utils from '@quantumblack/kedro-ui/lib/utils';\n\nconst { escapeRegExp, getHighlightedText } = utils;\nexport const getModularPipelineIDs = (state) => state.modularPipeline.ids;\nexport const getFocusedModularPipeline = (state) =>\n  state.visible.modularPipelineFocusMode;\nexport const getModularPipelinesTree = (state) => state.modularPipeline.tree;\n\n/**\n * Search a given string in a string target.\n * Return whether there is a match.\n * @param {String} searchValue the string to search for.\n * @param {String} target the target to search in.\n * @return {Boolean} whether there is a match.\n */\nexport const searchString = (searchValue, target) => {\n  if (!searchValue || !target) {\n    return false;\n  }\n  return new RegExp(escapeRegExp(target), 'gi').test(searchValue);\n};\n\n/**\n * Return whether a tree node in a modular pipeline tree is a leaf.\n */\nconst isTreeLeaf = (treeNode) => treeNode.type !== 'modularPipeline';\n\n/**\n * Search a given string in a (modular pipelines) tree.\n */\nexport const searchTree = (\n  searchValue,\n  tree,\n  currentNodeID = '__root__',\n  result = {}\n) => {\n  const treeNode = tree[currentNodeID];\n  if (!treeNode) {\n    return false;\n  }\n\n  const foundChildren = [];\n\n  for (const childNode of treeNode.children) {\n    if (isTreeLeaf(childNode)) {\n      // if the child node is a leaf, simply search the leaf's name\n      // and add to the search result if there is a match.\n      const found = searchString(childNode.data.name, searchValue);\n      if (found) {\n        foundChildren.push({\n          ...childNode,\n          data: {\n            ...childNode.data,\n            highlightedLabel: getHighlightedText(\n              childNode.data.name,\n              searchValue\n            ),\n          },\n        });\n      }\n    } else {\n      // if the child node is a tree, recursively search it\n      // and add the child node to the list of found children\n      // if there is a matching value in its tree.\n      const found = searchTree(searchValue, tree, childNode.id, result);\n      if (found) {\n        foundChildren.push({\n          ...childNode,\n          highlightedLabel: getHighlightedText(\n            result[childNode.id]?.name || '',\n            searchValue\n          ),\n        });\n      }\n    }\n  }\n\n  if (foundChildren.length > 0 || searchString(treeNode.name, searchValue)) {\n    result[currentNodeID] = {\n      ...treeNode,\n      highlightedLabel: getHighlightedText(treeNode.name, searchValue),\n      children: foundChildren,\n    };\n    return true;\n  }\n\n  return false;\n};\n\n/**\n * Search a given value in a modularPipelinesTree\n * and return a tree structure containing the searchResult.\n * @param {Object} modularPipelinesTree the modular pipelines tree to search in.\n * @param {String} searchValue the value to search for in the given modular pipelines tree.\n * @return {Object} a tree structure containing the searchResult.\n */\nexport const getModularPipelinesSearchResult = (\n  modularPipelinesTree,\n  searchValue\n) => {\n  if (!modularPipelinesTree) {\n    return {};\n  }\n  const searchResult = {};\n  searchTree(searchValue, modularPipelinesTree, '__root__', searchResult);\n  return searchResult;\n};\n","import { createSelector } from 'reselect';\nimport { getPipelineTagIDs } from './pipeline';\n\nconst getNodeTags = (state) => state.node.tags;\nconst getTagName = (state) => state.tag.name;\nconst getTagActive = (state) => state.tag.active;\nconst getTagEnabled = (state) => state.tag.enabled;\n\n/**\n * Retrieve the formatted list of tag filters\n */\nexport const getTagData = createSelector(\n  [getPipelineTagIDs, getTagName, getTagActive, getTagEnabled],\n  (tagIDs, tagName, tagActive, tagEnabled) =>\n    tagIDs.sort().map((id) => ({\n      id,\n      name: tagName[id],\n      active: Boolean(tagActive[id]),\n      enabled: Boolean(tagEnabled[id]),\n    }))\n);\n\n/**\n * Get the total and enabled number of tags\n */\nexport const getTagCount = createSelector(\n  [getPipelineTagIDs, getTagEnabled],\n  (tagIDs, tagEnabled) => ({\n    total: tagIDs.length,\n    enabled: tagIDs.filter((id) => tagEnabled[id]).length,\n  })\n);\n\n/**\n * Get the total number of nodes for each tag\n */\nexport const getTagNodeCounts = createSelector([getNodeTags], (nodeTags) => {\n  const counts = {};\n\n  for (const tagIds of Object.values(nodeTags)) {\n    for (const tagId of tagIds) {\n      counts[tagId] = counts[tagId] + 1 || 1;\n    }\n  }\n\n  return counts;\n});\n","import { createSelector } from 'reselect';\nimport { arrayToObject } from '../utils';\nimport { getNodeDisabledPipeline, getPipelineNodeIDs } from './pipeline';\nimport {\n  getFocusedModularPipeline,\n  getModularPipelinesTree,\n} from './modular-pipelines';\nimport { getTagCount } from './tags';\n\nconst getNodeIDs = (state) => state.node.ids;\nconst getNodeDisabledNode = (state) => state.node.disabled;\nconst getNodeTags = (state) => state.node.tags;\nconst getNodeType = (state) => state.node.type;\nconst getTagEnabled = (state) => state.tag.enabled;\nconst getNodeTypeDisabled = (state) => state.nodeType.disabled;\nconst getEdgeIDs = (state) => state.edge.ids;\nconst getEdgeSources = (state) => state.edge.sources;\nconst getEdgeTargets = (state) => state.edge.targets;\nconst getLayerIDs = (state) => state.layer.ids;\nconst getLayersVisible = (state) => state.layer.visible;\nconst getNodeLayer = (state) => state.node.layer;\nconst getNodeModularPipelines = (state) => state.node.modularPipelines;\nconst getVisibleSidebarNodes = (state) => state.modularPipeline.visible;\n\n/**\n * Return all inputs and outputs of currently visible modular pipelines\n * so that even if they are not expanded, their inputs and outputs are still rendered.\n */\nconst getVisibleModularPipelineInputsOutputs = createSelector(\n  [getVisibleSidebarNodes, getModularPipelinesTree],\n  (visibleSidebarNodes, modularPipelineData) => {\n    const result = new Set();\n    for (const nodeID in visibleSidebarNodes) {\n      if (visibleSidebarNodes[nodeID] && nodeID in modularPipelineData) {\n        [\n          ...modularPipelineData[nodeID].inputs,\n          ...modularPipelineData[nodeID].outputs,\n        ].forEach((nodeID) => result.add(nodeID));\n      }\n    }\n    return result;\n  }\n);\n\n/**\n * Calculate whether nodes should be disabled based on their tags\n */\nexport const getNodeDisabledTag = createSelector(\n  [getNodeIDs, getTagEnabled, getTagCount, getNodeTags],\n  (nodeIDs, tagEnabled, tagCount, nodeTags) =>\n    arrayToObject(nodeIDs, (nodeID) => {\n      if (tagCount.enabled === 0) {\n        return false;\n      }\n      if (nodeTags[nodeID].length) {\n        // Hide task nodes that don't have at least one tag filter enabled\n        return !nodeTags[nodeID].some((tag) => tagEnabled[tag]);\n      }\n      return true;\n    })\n);\n\n/**\n * Set disabled status if the node is specifically hidden, and/or via a tag/view/type/modularPipeline\n */\nexport const getNodeDisabled = createSelector(\n  [\n    getNodeIDs,\n    getNodeDisabledNode,\n    getNodeDisabledTag,\n    getNodeDisabledPipeline,\n    getNodeType,\n    getNodeTypeDisabled,\n    getNodeModularPipelines,\n    getModularPipelinesTree,\n    getFocusedModularPipeline,\n    getVisibleSidebarNodes,\n    getVisibleModularPipelineInputsOutputs,\n  ],\n  (\n    nodeIDs,\n    nodeDisabledNode,\n    nodeDisabledTag,\n    nodeDisabledPipeline,\n    nodeType,\n    typeDisabled,\n    nodeModularPipelines,\n    modularPipelinesTree,\n    focusedModularPipeline,\n    visibleSidebarNodes,\n    visibleModularPipelineInputsOutputs\n  ) =>\n    arrayToObject(nodeIDs, (id) => {\n      const isDisabledViaSidebar =\n        !visibleSidebarNodes[id] &&\n        !visibleModularPipelineInputsOutputs.has(id);\n\n      let isDisabledViaFocusedModularPipeline = false;\n      if (focusedModularPipeline) {\n        const inputOutputNodeIDs = [\n          ...modularPipelinesTree[focusedModularPipeline.id].inputs,\n          ...modularPipelinesTree[focusedModularPipeline.id].outputs,\n        ];\n        if (nodeType[id] === 'modularPipeline') {\n          isDisabledViaFocusedModularPipeline =\n            id !== focusedModularPipeline.id &&\n            !id.startsWith(`${focusedModularPipeline.id}.`);\n        } else {\n          isDisabledViaFocusedModularPipeline =\n            !nodeModularPipelines[id].includes(focusedModularPipeline.id) &&\n            !inputOutputNodeIDs.includes(id);\n        }\n      }\n      return [\n        nodeDisabledNode[id],\n        nodeDisabledTag[id],\n        nodeDisabledPipeline[id],\n        typeDisabled[nodeType[id]],\n        isDisabledViaSidebar,\n        isDisabledViaFocusedModularPipeline,\n      ].some(Boolean);\n    })\n);\n\n/**\n * Get a list of just the IDs for the remaining visible nodes\n */\nexport const getVisibleNodeIDs = createSelector(\n  [getPipelineNodeIDs, getNodeDisabled],\n  (nodeIDs, nodeDisabled) => {\n    return nodeIDs.filter((id) => !nodeDisabled[id]);\n  }\n);\n\n/**\n * Get a list of just the IDs for the remaining visible layers\n */\nexport const getVisibleLayerIDs = createSelector(\n  [getVisibleNodeIDs, getNodeLayer, getLayerIDs, getLayersVisible],\n  (nodeIDs, nodeLayer, layerIDs, layersVisible) => {\n    if (!layersVisible) {\n      return [];\n    }\n    const visibleLayerIDs = {};\n    for (const nodeID of nodeIDs) {\n      visibleLayerIDs[nodeLayer[nodeID]] = true;\n    }\n    return layerIDs.filter((layerID) => visibleLayerIDs[layerID]);\n  }\n);\n\n/**\n * Determine whether an edge should be disabled based on their source/target nodes\n */\nexport const getEdgeDisabled = createSelector(\n  [getEdgeIDs, getNodeDisabled, getEdgeSources, getEdgeTargets],\n  (edgeIDs, nodeDisabled, edgeSources, edgeTargets) =>\n    arrayToObject(edgeIDs, (edgeID) => {\n      const source = edgeSources[edgeID];\n      const target = edgeTargets[edgeID];\n      return Boolean(nodeDisabled[source] || nodeDisabled[target]);\n    })\n);\n","import { shortTypeMapping } from '../config';\n\nconst getShortType = (longTypeName, fallback) =>\n  shortTypeMapping[longTypeName] || fallback;\n\nexport default getShortType;\n","import { createSelector } from 'reselect';\nimport { getNodeDisabled, getEdgeDisabled } from './disabled';\nimport { getFocusedModularPipeline } from './modular-pipelines';\n\nconst getNodeIDs = (state) => state.node.ids;\nconst getEdgeIDs = (state) => state.edge.ids;\nconst getEdgeSources = (state) => state.edge.sources;\nconst getEdgeTargets = (state) => state.edge.targets;\nconst getNodeModularPipelines = (state) => state.node.modularPipelines;\nconst getVisibleSidebarNodes = (state) => state.modularPipeline.visible;\n\n/**\n * Create a new transitive edge from the first and last edge in the path\n * @param {string} target Node ID for the new edge\n * @param {string} source Node ID for the new edge\n * @param {object} transitiveEdges Store of existing edges\n */\nexport const addNewEdge = (source, target, { edgeIDs, sources, targets }) => {\n  const id = [source, target].join('|');\n  if (!edgeIDs.includes(id)) {\n    edgeIDs.push(id);\n    sources[id] = source;\n    targets[id] = target;\n  }\n};\n\n/**\n * Create new edges to connect nodes which have a disabled node (or nodes)\n * in between them\n */\nexport const getTransitiveEdges = createSelector(\n  [\n    getNodeIDs,\n    getEdgeIDs,\n    getNodeDisabled,\n    getEdgeSources,\n    getEdgeTargets,\n    getFocusedModularPipeline,\n    getNodeModularPipelines,\n    getVisibleSidebarNodes,\n  ],\n  (\n    nodeIDs,\n    edgeIDs,\n    nodeDisabled,\n    edgeSources,\n    edgeTargets,\n    focusedModularPipeline,\n    nodeModularPipelines,\n    visibleModularPipelines\n  ) => {\n    const transitiveEdges = {\n      edgeIDs: [],\n      sources: {},\n      targets: {},\n    };\n\n    /**\n     * Recursively walk through the graph, stepping over disabled nodes,\n     * generating a list of nodes visited so far, and create transitive edges\n     * for each path that visits disabled nodes between enabled nodes.\n     * @param {Array} path The route that has been explored so far\n     */\n    const walkGraphEdges = (path) => {\n      edgeIDs.forEach((edgeID) => {\n        const source = path[path.length - 1];\n        // Filter to only edges where the source node is the previous target\n        if (edgeSources[edgeID] !== source) {\n          return;\n        }\n        const target = edgeTargets[edgeID];\n\n        if (!visibleModularPipelines[target]) {\n          return;\n        }\n\n        // Further filter out connections between indicative input / output nodes under focus mode\n        const isNotInputEdge =\n          focusedModularPipeline !== null &&\n          !nodeModularPipelines[source].includes(focusedModularPipeline.id) &&\n          !nodeModularPipelines[target].includes(focusedModularPipeline.id);\n\n        if (nodeDisabled[target]) {\n          // If target node is disabled then keep walking the graph\n          walkGraphEdges(path.concat(target));\n        } else if (path.length > 1 && !isNotInputEdge) {\n          // Else only create a new edge if there would be 3 or more nodes in the path\n          addNewEdge(path[0], target, transitiveEdges);\n        }\n      });\n    };\n\n    // Only run walk if some nodes are disabled\n    if (nodeIDs.some((nodeID) => nodeDisabled[nodeID])) {\n      // Examine the children of every enabled node. The walk only needs\n      // to be run in a single direction (i.e. top down), because links\n      // that end in a terminus can never be transitive.\n      nodeIDs.forEach((nodeID) => {\n        if (!nodeDisabled[nodeID]) {\n          walkGraphEdges([nodeID]);\n        }\n      });\n    }\n\n    return transitiveEdges;\n  }\n);\n\n/**\n * Get only the visible edges (plus transitive edges),\n * and return them formatted as an array of objects\n */\nexport const getVisibleEdges = createSelector(\n  [\n    getEdgeIDs,\n    getEdgeDisabled,\n    getEdgeSources,\n    getEdgeTargets,\n    getTransitiveEdges,\n  ],\n  (edgeIDs, edgeDisabled, edgeSources, edgeTargets, transitiveEdges) =>\n    edgeIDs\n      .filter((id) => !edgeDisabled[id])\n      .concat(transitiveEdges.edgeIDs)\n      .map((id) => ({\n        id,\n        source: edgeSources[id] || transitiveEdges.sources[id],\n        target: edgeTargets[id] || transitiveEdges.targets[id],\n      }))\n);\n\n/**\n * Obtain all the edges that belongs to input and output data\n * nodes when under focus mode.\n */\nexport const getInputOutputDataEdges = createSelector(\n  [getVisibleEdges, getNodeModularPipelines, getFocusedModularPipeline],\n  (visibleEdges, nodeModularPipelines, focusedModularPipeline) => {\n    const edgesList = {};\n    if (focusedModularPipeline !== null) {\n      visibleEdges.forEach((edge) => {\n        if (\n          !nodeModularPipelines[edge.source]?.includes(\n            focusedModularPipeline.id\n          ) ||\n          !nodeModularPipelines[edge.target]?.includes(\n            focusedModularPipeline.id\n          )\n        ) {\n          edgesList[edge.id] = edge;\n        }\n      });\n    }\n\n    return edgesList;\n  }\n);\n","import { createSelector } from 'reselect';\nimport batchingToposort from 'batching-toposort';\nimport { getVisibleNodeIDs, getVisibleLayerIDs } from './disabled';\nimport { getVisibleEdges } from './edges';\n\nconst getNodeLayer = (state) => state.node.layer;\n\n/**\n * Get list of visible nodes for each visible layer\n */\nexport const getLayerNodes = createSelector(\n  [getVisibleNodeIDs, getVisibleLayerIDs, getNodeLayer],\n  (nodeIDs, layerIDs, nodeLayer) => {\n    if (!layerIDs.length) {\n      return [];\n    }\n    // Create object containing a list of every node for each layer\n    const layerNodes = {};\n    for (const nodeID of nodeIDs) {\n      const layer = nodeLayer[nodeID];\n      if (!layerNodes[layer]) {\n        layerNodes[layer] = [];\n      }\n      layerNodes[layer].push(nodeID);\n    }\n\n    // Convert to a nested array of layers of nodes\n    return layerIDs.map((layerID) => layerNodes[layerID]);\n  }\n);\n\n/**\n * Calculate ranks (vertical placement) for each node,\n * by toposorting while taking layers into account\n */\nexport const getNodeRank = createSelector(\n  [getVisibleNodeIDs, getVisibleEdges, getLayerNodes, getVisibleLayerIDs],\n  (nodeIDs, edges, layerNodes, layerIDs) => {\n    if (!layerIDs.length) {\n      return {};\n    }\n\n    // For each node, create a list of nodes that depend on that node\n    const nodeDeps = {};\n\n    // Initialise empty dependency arrays for each node\n    for (const nodeID of nodeIDs) {\n      nodeDeps[nodeID] = [];\n    }\n\n    // Add dependencies for visible edges\n    for (const edge of edges) {\n      nodeDeps[edge.source].push(edge.target);\n    }\n\n    // Add \"false edge\" dependencies for layered nodes to prevent layer overlaps\n    for (let i = 1; i < layerNodes.length; i++) {\n      for (const sourceID of layerNodes[i - 1]) {\n        for (const targetID of layerNodes[i]) {\n          nodeDeps[sourceID].push(targetID);\n        }\n      }\n    }\n\n    // Run toposort algorithm to rank nodes by dependency\n    const toposortedNodes = batchingToposort(nodeDeps);\n\n    // Convert toposort order into rank numbering\n    const nodeRanks = {};\n    for (let rank = 0; rank < toposortedNodes.length; rank++) {\n      for (const nodeID of toposortedNodes[rank]) {\n        nodeRanks[nodeID] = rank;\n      }\n    }\n\n    return nodeRanks;\n  }\n);\n","import { createSelector } from 'reselect';\nimport { select } from 'd3-selection';\nimport { arrayToObject } from '../utils';\nimport { getPipelineNodeIDs } from './pipeline';\nimport {\n  getNodeDisabled,\n  getNodeDisabledTag,\n  getVisibleNodeIDs,\n} from './disabled';\nimport getShortType from '../utils/short-type';\nimport { getNodeRank } from './ranks';\n\nconst getNodeName = (state) => state.node.name;\nconst getNodeFullName = (state) => state.node.fullName;\nconst getNodeDisabledNode = (state) => state.node.disabled;\nconst getNodeTags = (state) => state.node.tags;\nexport const getNodeModularPipelines = (state) => state.node.modularPipelines;\nconst getNodeType = (state) => state.node.type;\nconst getNodeDatasetType = (state) => state.node.datasetType;\nconst getNodeLayer = (state) => state.node.layer;\nconst getHoveredNode = (state) => state.node.hovered;\nconst getPrettyName = (state) => state.prettyName;\nconst getTagActive = (state) => state.tag.active;\nconst getModularPipelineActive = (state) => state.modularPipeline.active;\nconst getTextLabels = (state) => state.textLabels;\nconst getFontLoaded = (state) => state.fontLoaded;\nconst getNodeTypeDisabled = (state) => state.nodeType.disabled;\nconst getClickedNode = (state) => state.node.clicked;\nconst getEdgeIDs = (state) => state.edge.ids;\nconst getEdgeSources = (state) => state.edge.sources;\nconst getEdgeTargets = (state) => state.edge.targets;\n\n/**\n * Gets a map of nodeIds to graph nodes\n */\nexport const getGraphNodes = createSelector(\n  [(state) => state.graph.nodes],\n  (nodes = []) =>\n    nodes.reduce((result, node) => {\n      result[node.id] = node;\n      return result;\n    }, {})\n);\n\n/**\n * Set active status if the node is specifically highlighted, and/or via an associated tag or modular pipeline\n */\nexport const getNodeActive = createSelector(\n  [\n    getPipelineNodeIDs,\n    getHoveredNode,\n    getNodeTags,\n    getTagActive,\n    getNodeModularPipelines,\n    getModularPipelineActive,\n    (state) => state.modularPipeline.tree,\n  ],\n  (\n    nodeIDs,\n    hoveredNode,\n    nodeTags,\n    tagActive,\n    nodeModularPipelines,\n    modularPipelineActive,\n    modularPipelinesTree\n  ) => {\n    const activeModularPipelines = Object.keys(modularPipelineActive).filter(\n      (modularPipelineID) => modularPipelineActive[modularPipelineID]\n    );\n    const nodesActiveViaModularPipeline = activeModularPipelines.flatMap((id) =>\n      modularPipelinesTree[id].children.map((child) => child.id)\n    );\n\n    return arrayToObject(nodeIDs, (nodeID) => {\n      if (nodeID === hoveredNode) {\n        return true;\n      }\n      const activeViaTag = nodeTags[nodeID].some((tag) => tagActive[tag]);\n      const activeModularPipeline = activeModularPipelines.includes(nodeID);\n      const activeViaModularPipeline =\n        nodesActiveViaModularPipeline.includes(nodeID) ||\n        (nodeModularPipelines[nodeID] &&\n          nodeModularPipelines[nodeID].some(\n            (modularPipeline) => modularPipelineActive[modularPipeline]\n          ));\n      return (\n        Boolean(activeViaTag) ||\n        Boolean(activeViaModularPipeline) ||\n        Boolean(activeModularPipeline)\n      );\n    });\n  }\n);\n\n/**\n * Set selected status if the node is clicked\n */\nexport const getNodeSelected = createSelector(\n  [getPipelineNodeIDs, getClickedNode, getNodeDisabled],\n  (nodeIDs, clickedNode, nodeDisabled) =>\n    arrayToObject(\n      nodeIDs,\n      (nodeID) => nodeID === clickedNode && !nodeDisabled[nodeID]\n    )\n);\n\n/**\n * Returns node label based on if pretty name is turned on/off\n */\nexport const getNodeLabel = createSelector(\n  [getPrettyName, getNodeName, getNodeFullName],\n  (prettyName, nodeName, nodeFullName) => (prettyName ? nodeName : nodeFullName)\n);\n\n/**\n * Returns formatted nodes as an array, with all relevant properties\n */\nexport const getNodeData = createSelector(\n  [\n    getPipelineNodeIDs,\n    getNodeLabel,\n    getNodeType,\n    getNodeDatasetType,\n    getNodeDisabled,\n    getNodeDisabledNode,\n    getNodeDisabledTag,\n    getNodeTypeDisabled,\n    getNodeModularPipelines,\n  ],\n  (\n    nodeIDs,\n    nodeLabel,\n    nodeType,\n    nodeDatasetType,\n    nodeDisabled,\n    nodeDisabledNode,\n    nodeDisabledTag,\n    typeDisabled,\n    nodeModularPipelines\n  ) =>\n    nodeIDs\n      .sort((a, b) => {\n        if (nodeLabel[a] < nodeLabel[b]) {\n          return -1;\n        }\n        if (nodeLabel[a] > nodeLabel[b]) {\n          return 1;\n        }\n        return 0;\n      })\n      .map((id) => ({\n        id,\n        name: nodeLabel[id],\n        type: nodeType[id],\n        icon: getShortType([nodeDatasetType[id]], nodeType[id]),\n        modularPipelines: nodeModularPipelines[id],\n        disabled: nodeDisabled[id],\n        disabledNode: Boolean(nodeDisabledNode[id]),\n        disabledTag: nodeDisabledTag[id],\n        disabledType: Boolean(typeDisabled[nodeType[id]]),\n      }))\n);\n\n/**\n * Returns formatted nodes as an object, with all relevant properties.\n * This is similar to `getNodeData`, but instead of returning an Array,\n * it returns all nodes as an Object.\n */\nexport const getNodeDataObject = createSelector(\n  [\n    getPipelineNodeIDs,\n    getNodeLabel,\n    getNodeType,\n    getNodeDatasetType,\n    getNodeDisabled,\n    getNodeDisabledNode,\n    getNodeDisabledTag,\n    getNodeTypeDisabled,\n    getNodeModularPipelines,\n  ],\n  (\n    nodeIDs,\n    nodeLabel,\n    nodeType,\n    nodeDatasetType,\n    nodeDisabled,\n    nodeDisabledNode,\n    nodeDisabledTag,\n    typeDisabled,\n    nodeModularPipelines\n  ) =>\n    nodeIDs.reduce((obj, id) => {\n      obj[id] = {\n        id,\n        name: nodeLabel[id],\n        type: nodeType[id],\n        icon: getShortType([nodeDatasetType[id]], nodeType[id]),\n        modularPipelines: nodeModularPipelines[id],\n        disabled: nodeDisabled[id],\n        disabledNode: Boolean(nodeDisabledNode[id]),\n        disabledTag: Boolean(nodeDisabledTag[id]),\n        disabledType: Boolean(typeDisabled[nodeType[id]]),\n      };\n      return obj;\n    }, {})\n);\n\n/**\n * Return the modular pipelines tree with full data for each tree node for display.\n */\nexport const getModularPipelinesTree = createSelector(\n  [(state) => state.modularPipeline.tree, getNodeDataObject],\n  (modularPipelinesTree, nodes) => {\n    if (!modularPipelinesTree) {\n      return {};\n    }\n    for (const modularPipelineID in modularPipelinesTree) {\n      modularPipelinesTree[modularPipelineID].data = {\n        ...nodes[modularPipelineID],\n      };\n      for (const child of modularPipelinesTree[modularPipelineID].children) {\n        child.data = { ...nodes[child.id] };\n      }\n    }\n    return modularPipelinesTree;\n  }\n);\n\n/**\n * Returns formatted nodes grouped by type\n */\nexport const getGroupedNodes = createSelector([getNodeData], (nodes) =>\n  nodes.reduce(function (obj, item) {\n    const key = item.type;\n    if (!obj.hasOwnProperty(key)) {\n      obj[key] = [];\n    }\n    obj[key].push(item);\n    return obj;\n  }, {})\n);\n\n/**\n * Temporarily create a new SVG container in the DOM, write a node to it,\n * measure its width with getBBox, then delete the container and store the value\n */\nexport const getNodeTextWidth = createSelector(\n  [getPipelineNodeIDs, getNodeLabel, getFontLoaded],\n  (nodeIDs, nodeLabel, fontLoaded) => {\n    if (!fontLoaded) {\n      return {};\n    }\n    const nodeTextWidth = {};\n    const svg = select(document.body)\n      .append('svg')\n      .attr('class', 'kedro pipeline-node');\n    svg\n      .selectAll('text')\n      .data(nodeIDs)\n      .enter()\n      .append('text')\n      .text((nodeID) => nodeLabel[nodeID])\n      .each(function (nodeID) {\n        const width = this.getBBox ? this.getBBox().width : 0;\n        nodeTextWidth[nodeID] = width;\n      });\n    svg.remove();\n    return nodeTextWidth;\n  }\n);\n\n/**\n * Get the top/bottom and left/right padding for a node\n * @param {Boolean} showLabels Whether labels are visible\n * @param {Boolean} isTask Whether the node is a task type (vs data/params)\n */\nexport const getPadding = (showLabels, nodeType) => {\n  if (showLabels) {\n    switch (nodeType) {\n      case 'modularPipeline':\n        return { x: 30, y: 22 };\n      case 'task':\n        return { x: 16, y: 10 };\n      default:\n        return { x: 20, y: 10 };\n    }\n  }\n  switch (nodeType) {\n    case 'modularPipeline':\n      return { x: 25, y: 25 };\n    case 'task':\n      return { x: 14, y: 14 };\n    default:\n      return { x: 16, y: 16 };\n  }\n};\n\n/**\n * Calculate node width/height and icon/text positioning\n */\nexport const getNodeSize = createSelector(\n  [\n    getPipelineNodeIDs,\n    getNodeTextWidth,\n    getTextLabels,\n    getNodeType,\n    getFontLoaded,\n  ],\n  (nodeIDs, nodeTextWidth, textLabels, nodeType, fontLoaded) => {\n    if (!fontLoaded) {\n      return {};\n    }\n    return arrayToObject(nodeIDs, (nodeID) => {\n      const iconSize = textLabels ? 24 : 28;\n      const padding = getPadding(textLabels, nodeType[nodeID]);\n      const textWidth = textLabels ? nodeTextWidth[nodeID] : 0;\n      const textGap = textLabels ? 6 : 0;\n      const innerWidth = iconSize + textWidth + textGap;\n      return {\n        showText: textLabels,\n        width: innerWidth + padding.x * 2,\n        height: iconSize + padding.y * 2,\n        textOffset: (innerWidth - textWidth) / 2 - 1,\n        iconOffset: -innerWidth / 2,\n        iconSize,\n      };\n    });\n  }\n);\n\n/**\n * Returns only visible nodes as an array, but without any extra properties\n * that are unnecessary for the chart layout calculation\n */\nexport const getVisibleNodes = createSelector(\n  [\n    getVisibleNodeIDs,\n    getNodeLabel,\n    getNodeType,\n    getNodeDatasetType,\n    getNodeFullName,\n    getNodeSize,\n    getNodeLayer,\n    getNodeRank,\n    getFontLoaded,\n  ],\n  (\n    nodeIDs,\n    nodeLabel,\n    nodeType,\n    nodeDatasetType,\n    nodeFullName,\n    nodeSize,\n    nodeLayer,\n    nodeRank,\n    fontLoaded\n  ) =>\n    fontLoaded\n      ? nodeIDs.map((id) => ({\n          id,\n          name: nodeLabel[id],\n          fullName: nodeFullName[id],\n          icon: getShortType([nodeDatasetType[id]], nodeType[id]),\n          type: nodeType[id],\n          layer: nodeLayer[id],\n          rank: nodeRank[id],\n          ...nodeSize[id],\n        }))\n      : []\n);\n\n/**\n * Returns a map of task nodeIDs to graph nodes that have parameter nodes as their source\n */\n\nexport const getNodesWithInputParams = createSelector(\n  [\n    getGraphNodes,\n    getNodeName,\n    getEdgeIDs,\n    getNodeType,\n    getEdgeSources,\n    getEdgeTargets,\n  ],\n  (nodes, nodeName, edgeIDs, nodeType, edgeSources, edgeTargets) => {\n    const nodesList = {};\n    for (const edgeID of edgeIDs) {\n      const source = edgeSources[edgeID];\n      const target = edgeTargets[edgeID];\n      if (nodeType[source] === 'parameters' && nodeType[target] === 'task') {\n        if (!nodesList[target]) {\n          nodesList[target] = [];\n        }\n        nodesList[target].push(nodeName[source]);\n      }\n    }\n    return nodesList;\n  }\n);\n\n/**\n * Returns a list of dataset nodes that are input and output nodes of the modular pipeline under focus mode\n */\nexport const getInputOutputNodesForFocusedModularPipeline = createSelector(\n  [\n    (state) => state.visible.modularPipelineFocusMode?.id,\n    getGraphNodes,\n    getModularPipelinesTree,\n  ],\n  (focusedModularPipelineID, graphNodes, modularPipelinesTree) => {\n    const focusedModularPipeline = focusedModularPipelineID\n      ? modularPipelinesTree[focusedModularPipelineID]\n      : null;\n    const nodeIDs = focusedModularPipeline\n      ? [...focusedModularPipeline.inputs, ...focusedModularPipeline.outputs]\n      : [];\n    const result = nodeIDs.reduce((result, nodeID) => {\n      result[nodeID] = graphNodes[nodeID];\n      return result;\n    }, {});\n    return result;\n  }\n);\n","import { createSelector } from 'reselect';\nimport { getGraphNodes } from './nodes';\nconst getClickedNode = (state) => state.node.clicked;\n/**\n * Comparison for sorting alphabetically by name, otherwise by value\n */\nconst sortAlpha = (a, b) => (a.name || a).localeCompare(b.name || b);\n\n/**\n * Returns true if metadata sidebar is visible\n */\nexport const getVisibleMetaSidebar = createSelector(\n  [getClickedNode],\n  (nodeClicked) => Boolean(nodeClicked)\n);\n\n/**\n * Gets metadata for the currently clicked node if any\n */\nexport const getClickedNodeMetaData = createSelector(\n  [\n    getClickedNode,\n    getGraphNodes,\n    (state) => state.node.tags,\n    (state) => state.tag.name,\n    (state) => state.pipeline,\n    (state) => state.node.filepath,\n    (state) => state.node.inputs,\n    (state) => state.node.outputs,\n    (state) => state.node.code,\n    (state) => state.node.parameters,\n    (state) => state.node.plot,\n    (state) => state.node.metrics,\n    (state) => state.node.datasetType,\n    (state) => state.node.originalType,\n    (state) => state.node.transcodedTypes,\n    (state) => state.node.runCommand,\n  ],\n  (\n    nodeId,\n    nodes = {},\n    nodeTags,\n    tagNames,\n    pipeline,\n    nodeFilepaths,\n    nodeInputs,\n    nodeOutputs,\n    nodeCodes,\n    nodeParameters,\n    nodePlot,\n    nodeMetrics,\n    nodeDatasetTypes,\n    nodeOriginalTypes,\n    nodeTranscodedTypes,\n    nodeRunCommand\n  ) => {\n    const node = nodes[nodeId];\n    if (!node) {\n      return null;\n    }\n    //rounding of metrics data\n    nodeMetrics[node.id] &&\n      Object.entries(nodeMetrics[node.id]).forEach(([key, value]) => {\n        nodeMetrics[node.id][key] = Math.round(value * 100) / 100;\n      });\n\n    const metadata = {\n      node,\n      tags: [...nodeTags[node.id]]\n        .map((tagId) => tagNames[tagId])\n        .sort(sortAlpha),\n      pipeline: pipeline.name[pipeline.active],\n      parameters: nodeParameters[node.id],\n      runCommand: nodeRunCommand[node.id],\n      code: nodeCodes[node.id],\n      filepath: nodeFilepaths[node.id],\n      plot: nodePlot[node.id],\n      metrics: nodeMetrics[node.id],\n      datasetType: nodeDatasetTypes[node.id],\n      originalType: nodeOriginalTypes[node.id],\n      transcodedTypes: nodeTranscodedTypes[node.id],\n      inputs: nodeInputs[node.id],\n      outputs: nodeOutputs[node.id],\n    };\n    return metadata;\n  }\n);\n","import { createSelector } from 'reselect';\nimport { getVisibleNodes } from './nodes';\nimport { getVisibleEdges } from './edges';\nimport { getVisibleLayerIDs } from './disabled';\nimport { getVisibleMetaSidebar } from './metadata';\nimport {\n  sidebarWidth,\n  metaSidebarWidth,\n  chartMinWidthScale,\n  largeGraphThreshold,\n  codeSidebarWidth,\n} from '../config';\n\nconst getSizeWarningFlag = (state) => state.flags.sizewarning;\nconst getVisibleSidebar = (state) => state.visible.sidebar;\nconst getVisibleCode = (state) => state.visible.code;\nconst getFontLoaded = (state) => state.fontLoaded;\nconst getIgnoreLargeWarning = (state) => state.ignoreLargeWarning;\nconst getGraphHasNodes = (state) => Boolean(state.graph?.nodes?.length);\nconst getChartSizeState = (state) => state.chartSize;\n\n/**\n * Show the large graph warning only if there are sufficient nodes + edges,\n * and it hasn't been toggled off (by clicking the Render Anyway button), and\n * the graph layout hasn't already previously been calculated (due to a user\n * filtering the graph to a smaller subset), and the flag isn't set to false.\n */\nexport const getTriggerLargeGraphWarning = createSelector(\n  [\n    getVisibleNodes,\n    getVisibleEdges,\n    getIgnoreLargeWarning,\n    getGraphHasNodes,\n    getSizeWarningFlag,\n  ],\n  (nodes, edges, ignoreLargeWarning, graphHasNodes, sizeWarningFlag) =>\n    nodes.length + 1.5 * edges.length > largeGraphThreshold &&\n    !ignoreLargeWarning &&\n    !graphHasNodes &&\n    sizeWarningFlag\n);\n\n/**\n * Select a subset of state that is watched by graph layout calculators\n * and used to prepare state.graph via async web worker actions\n */\nexport const getGraphInput = createSelector(\n  [\n    getVisibleNodes,\n    getVisibleEdges,\n    getVisibleLayerIDs,\n    getFontLoaded,\n    getTriggerLargeGraphWarning,\n  ],\n  (nodes, edges, layers, fontLoaded, triggerLargeGraphWarning) => {\n    if (!fontLoaded || triggerLargeGraphWarning) {\n      return null;\n    }\n\n    return { nodes, edges, layers, fontLoaded };\n  }\n);\n\n/**\n * Calculate the displayed width of a sidebar\n */\nexport const getSidebarWidth = (visible, { open, closed }) =>\n  visible ? open : closed;\n\n/**\n * Convert the DOMRect into an Object, mutate some of the properties,\n * and add some useful new ones\n */\nexport const getChartSize = createSelector(\n  [getVisibleSidebar, getVisibleMetaSidebar, getVisibleCode, getChartSizeState],\n  (visibleSidebar, visibleMetaSidebar, visibleCodeSidebar, chartSize) => {\n    const { left, top, width, height } = chartSize;\n    if (!width || !height) {\n      return {};\n    }\n\n    // Get the actual sidebar width\n    const sidebarWidthActual = getSidebarWidth(visibleSidebar, sidebarWidth);\n    const metaSidebarWidthActual = getSidebarWidth(\n      visibleMetaSidebar,\n      metaSidebarWidth\n    );\n    const codeSidebarWidthActual = getSidebarWidth(\n      visibleCodeSidebar,\n      codeSidebarWidth\n    );\n\n    // Find the resulting space for the chart\n    let chartWidth =\n      width -\n      sidebarWidthActual -\n      metaSidebarWidthActual -\n      codeSidebarWidthActual;\n\n    return {\n      left,\n      top,\n      outerWidth: width,\n      outerHeight: height,\n      height,\n      width: chartWidth,\n      minWidthScale: chartMinWidthScale,\n      sidebarWidth: sidebarWidthActual,\n      metaSidebarWidth: metaSidebarWidthActual,\n      codeSidebarWidth: codeSidebarWidthActual,\n    };\n  }\n);\n\n/**\n * Gets the current chart zoom\n */\nexport const getChartZoom = createSelector([(state) => state.zoom], (zoom) => ({\n  ...zoom,\n}));\n","import { createStore, compose, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport watch from 'redux-watch';\nimport reducer from '../reducers';\nimport { getGraphInput } from '../selectors/layout';\nimport { calculateGraph } from '../actions/graph';\nimport { saveState, pruneFalseyKeys } from './helpers';\n\n/**\n * Watch the getGraphInput selector, and dispatch an asynchronous action to\n * update state.graph via a web worker when it changes.\n * @param {object} store Redux store\n */\nconst updateGraphOnChange = (store) => {\n  const watchGraph = watch(() => getGraphInput(store.getState()));\n  store.subscribe(\n    watchGraph((graphInput) => {\n      store.dispatch(calculateGraph(graphInput));\n    })\n  );\n};\n\n/**\n * Save selected state properties to window.localStorage\n * @param {object} state Redux state snapshot\n */\nconst saveStateToLocalStorage = (state) => {\n  // does not save modal state to localStorage\n  const {\n    exportModal,\n    plotModal,\n    settingsModal,\n    modularPipelineFocusMode,\n    ...otherVisibleProps\n  } = state.visible;\n  saveState({\n    node: {\n      disabled: pruneFalseyKeys(state.node.disabled),\n    },\n    nodeType: {\n      disabled: state.nodeType.disabled,\n    },\n    pipeline: {\n      active: state.pipeline.active,\n    },\n    layer: {\n      visible: state.layer.visible,\n    },\n    tag: {\n      enabled: state.tag.enabled,\n    },\n    textLabels: state.textLabels,\n    visible: otherVisibleProps,\n    theme: state.theme,\n    prettyName: state.prettyName,\n    flags: state.flags,\n  });\n};\n\n/**\n * Configure initial state and create the Redux store\n * @param {Object} initialState Initial Redux state (from initial-state.js)\n * @return {Object} Redux store\n */\nexport default function configureStore(initialState) {\n  const composeEnhancers =\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n  const store = createStore(\n    reducer,\n    initialState,\n    composeEnhancers(applyMiddleware(thunk))\n  );\n  updateGraphOnChange(store);\n  store.subscribe(() => {\n    saveStateToLocalStorage(store.getState());\n  });\n\n  return store;\n}\n","import React from 'react';\nimport classnames from 'classnames';\nimport { connect } from 'react-redux';\nimport { changeFlag, toggleIgnoreLargeWarning } from '../../actions';\nimport { getVisibleNodes } from '../../selectors/nodes';\nimport { getTriggerLargeGraphWarning } from '../../selectors/layout';\nimport Button from '@quantumblack/kedro-ui/lib/components/button';\nimport './large-pipeline-warning.css';\n\nexport const LargePipelineWarning = ({\n  onDisable,\n  onHide,\n  nodes,\n  sidebarVisible,\n  theme,\n  visible,\n}) => {\n  return visible ? (\n    <div\n      className={classnames('kedro', 'pipeline-warning', {\n        'pipeline-warning--sidebar-visible': sidebarVisible,\n      })}>\n      <h2 className=\"pipeline-warning__title\">\n        Whoa, thats a chonky pipeline!\n      </h2>\n      <p className=\"pipeline-warning__subtitle\">\n        This graph contains <b>{nodes.length}</b> elements, which will take a\n        while to render. You can use the sidebar controls to select a smaller\n        graph.\n      </p>\n      <Button theme={theme} onClick={onHide}>\n        Render it anyway\n      </Button>\n      <Button\n        theme={theme}\n        onClick={onDisable}\n        size=\"small\"\n        mode=\"secondary\"\n        animation=\"wipe\">\n        Don't show this again\n      </Button>\n    </div>\n  ) : null;\n};\n\nexport const mapStateToProps = (state) => ({\n  theme: state.theme,\n  sidebarVisible: state.visible.sidebar,\n  nodes: getVisibleNodes(state),\n  visible: getTriggerLargeGraphWarning(state),\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onDisable: () => {\n    dispatch(changeFlag('sizewarning', false));\n  },\n  onHide: () => {\n    dispatch(toggleIgnoreLargeWarning(true));\n  },\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LargePipelineWarning);\n","import { createSelector } from 'reselect';\nimport { getVisibleLayerIDs } from './disabled';\n\nconst getGraph = (state) => state.graph;\nconst getLayerName = (state) => state.layer.name;\n\n/**\n * Get layer positions\n */\nexport const getLayers = createSelector(\n  [getGraph, getVisibleLayerIDs, getLayerName],\n  ({ nodes, size }, layerIDs, layerName) => {\n    if (!nodes || !size || !nodes.length || !layerIDs.length) {\n      return [];\n    }\n    const { width, height } = size;\n\n    const bounds = {};\n\n    for (const node of nodes) {\n      const layer = node.nearestLayer || node.layer;\n\n      if (layer) {\n        const bound = bounds[layer] || (bounds[layer] = [Infinity, -Infinity]);\n\n        if (node.y - node.height < bound[0]) {\n          bound[0] = node.y - node.height;\n        }\n\n        if (node.y + node.height > bound[1]) {\n          bound[1] = node.y + node.height;\n        }\n      }\n    }\n\n    return layerIDs.map((id, i) => {\n      const currentBound = bounds[id] || [0, 0];\n      const prevBound = bounds[layerIDs[i - 1]] || [\n        currentBound[0],\n        currentBound[0],\n      ];\n      const nextBound = bounds[layerIDs[i + 1]] || [\n        currentBound[1],\n        currentBound[1],\n      ];\n      const start = (prevBound[1] + currentBound[0]) / 2;\n      const end = (currentBound[1] + nextBound[0]) / 2;\n      const rectWidth = Math.max(width, height) * 5;\n\n      return {\n        id,\n        name: layerName[id],\n        x: (rectWidth - width) / -2,\n        y: start,\n        width: rectWidth,\n        height: Math.max(end - start, 0),\n      };\n    });\n  }\n);\n","import { createSelector } from 'reselect';\nimport { getVisibleEdges } from './edges';\n\nconst getClickedNode = (state) => state.node.clicked;\n/**\n * Gets a map of visible nodeIDs to successors nodeIDs in both directions\n * @param {Array} edges\n */\nexport const getVisibleEdgesByNode = createSelector(\n  [getVisibleEdges],\n  (edges) => {\n    const sourceEdges = {};\n    const targetEdges = {};\n\n    for (const edge of edges) {\n      if (!sourceEdges[edge.target]) {\n        sourceEdges[edge.target] = [];\n      }\n\n      sourceEdges[edge.target].push(edge.source);\n\n      if (!targetEdges[edge.source]) {\n        targetEdges[edge.source] = [];\n      }\n\n      targetEdges[edge.source].push(edge.target);\n    }\n\n    return { sourceEdges, targetEdges };\n  }\n);\n\n/**\n * Finds all visible successor nodeIDs for the given nodeID\n * @param {string} nodeID the starting nodeID\n * @param {Object} edgesByNode an object mapping nodeIDs to successor nodeIDs\n * @param {object} visited an object for storing all visited node ids\n * @returns {object} the supplied `visited` object\n */\nconst findLinkedNodes = (nodeID, edgesByNode, visited) => {\n  if (!visited[nodeID]) {\n    visited[nodeID] = true;\n\n    if (edgesByNode[nodeID]) {\n      edgesByNode[nodeID].forEach((nodeID) =>\n        findLinkedNodes(nodeID, edgesByNode, visited)\n      );\n    }\n  }\n\n  return visited;\n};\n\n/**\n * Gets all visible ancestors and descendents for the given nodeID\n * @param {Object} visibleEdgeMaps\n * @param {string} nodeID\n */\nexport const getLinkedNodes = createSelector(\n  [getVisibleEdgesByNode, getClickedNode],\n  ({ sourceEdges, targetEdges }, nodeID) => {\n    if (!nodeID) {\n      return {};\n    }\n\n    const linkedNodes = {};\n    findLinkedNodes(nodeID, sourceEdges, linkedNodes);\n\n    linkedNodes[nodeID] = false;\n    findLinkedNodes(nodeID, targetEdges, linkedNodes);\n\n    return linkedNodes;\n  }\n);\n","/**\n * Returns a className string with the given modifiers in BEM style\n * @param {string} name The main class name\n * @param {?object} modifiers Map of modifier names to boolean or string values\n * @param {?string} others Optional class name string to concatenate after\n * @return {string} The compiled class name(s)\n */\nconst modifiers = (name, modifiers, others = '') =>\n  Object.keys(modifiers || {}).reduce((classes, modifier) => {\n    const value = modifiers[modifier];\n\n    if (typeof value !== 'string' && typeof value !== 'number') {\n      return `${classes} ${name}--${value ? '' : 'no-'}${modifier}`;\n    }\n\n    return `${classes} ${name}--${modifier}-${(value + '').replace(\n      /\\s/g,\n      '-'\n    )}`;\n  }, name) + (others ? ' ' + others : '');\n\nexport default modifiers;\n","import React from 'react';\nimport modifiers from '../../utils/modifiers';\n\nexport const paths = {\n  // database icon\n  data: 'M12 4c3.31 0 6 1.67 6 3.73l-.01.27H18v9h-.02a1.1 1.1 0 01-.16.42c-1.14 1.7-3.11 2.53-5.82 2.53s-4.68-.82-5.82-2.53a1.09 1.09 0 01-.16-.42H6V8h.01A2.33 2.33 0 016 7.73C6 5.67 8.69 4 12 4zm0 11.73c-1.6 0-2.94-.31-4-.94v1.64c.74.9 2.05 1.38 4 1.38 1.95 0 3.26-.48 4-1.38v-1.65c-1.06.64-2.4.95-4 .95zm0-4.26a8.33 8.33 0 01-4-.95v1.64c.75 1.1 2.04 1.65 4 1.65s3.25-.55 4-1.65V10.5c-1.06.6-2.46.96-4 .96zm0-5.34a6.3 6.3 0 00-3.23.8c-.56.35-.77.66-.77.8 0 .15.2.45.77.8.8.5 1.96.8 3.23.8s2.44-.3 3.23-.8c.56-.35.77-.65.77-.8 0-.14-.2-.45-.77-.8a6.3 6.3 0 00-3.23-.8z',\n  // function icon\n  task: 'M20 4.2l.2.2L19 5.9c-2.3-1.8-3.8-.9-4.8 3.4h3.1v2h-3.5v.2l-.1.6c-1.2 7.9-4 11-8.3 8l-.2-.1 1.2-1.6c2.5 1.8 4.2.3 5.2-5.9l.2-1v-.2H9.2v-2h3c1.4-6 4.1-8 7.9-5z',\n  // sliders icon\n  parameters:\n    'M10.2 14v1.5H20v2h-9.8V19H8.3v-1.5H5v-2h3.3V14h2zm7.4-9v1.5H20v2h-2.4V10h-1.8V8.5H5v-2h10.8V5h1.8z',\n  modularPipeline:\n    'M8.18 4c1.11 0 2.03.8 2.17 1.86l4.4 1.61c.31-.17.68-.27 1.07-.27 1.2 0 2.18.95 2.18 2.13s-.98 2.14-2.18 2.14c-.38 0-.73-.1-1.04-.26l-4.22 2.74L13.69 16c.3-.16.66-.26 1.04-.26 1.2 0 2.18.96 2.18 2.14 0 1.18-.98 2.13-2.18 2.13a2.16 2.16 0 01-2.17-2.35l-3.34-2.18c-.3.17-.66.26-1.04.26-1.2 0-2.18-.95-2.18-2.13s.98-2.13 2.18-2.13c.61 0 1.16.24 1.56.63l3.9-2.55v-.22-.13L9.63 7.73c-.39.33-.9.54-1.45.54C6.98 8.27 6 7.3 6 6.13 6 4.95 6.98 4 8.18 4z',\n  //plotly icon\n  plotly:\n    'M6.261 11.546l5.465 5.766-1.452 1.376-4.013-4.235-2.535 2.676-1.452-1.376 3.987-4.207zm6.911-2.898l8.495 7.607-1.334 1.49-7.14-6.394-2.514 2.325-1.358-1.469 3.851-3.559zM5.5 6C6.328 6 7 6.672 7 7.5S6.328 9 5.5 9 4 8.328 4 7.5 4.672 6 5.5 6z',\n};\n\nconst NodeIcon = ({ className, icon }) =>\n  paths[icon] ? (\n    <svg\n      className={modifiers('pipeline-node-icon', { icon }, className)}\n      viewBox=\"0 0 24 24\">\n      <path d={paths[icon]} />\n    </svg>\n  ) : null;\n\nexport default NodeIcon;\n","import 'd3-transition';\nimport { interpolatePath } from 'd3-interpolate-path';\nimport { select } from 'd3-selection';\nimport { curveBasis, line } from 'd3-shape';\nimport { paths as nodeIcons } from '../icons/node-icon';\n\nconst lineShape = line()\n  .x((d) => d.x)\n  .y((d) => d.y)\n  .curve(curveBasis);\n\n/**\n * Matches all floating point numbers in a string\n */\nconst matchFloats = /\\d+\\.\\d+/g;\n\n/**\n * Limits the precision of a float value to one decimal point\n */\nconst toSinglePoint = (value) => parseFloat(value).toFixed(1);\n\n/**\n * Limits the precision of a path string to one decimal point\n */\nconst limitPrecision = (path) => path.replace(matchFloats, toSinglePoint);\n\n/**\n * Render layer bands\n */\nexport const drawLayers = function () {\n  const { layers } = this.props;\n\n  this.el.layers = this.el.layerGroup\n    .selectAll('.pipeline-layer')\n    .data(layers, (layer) => layer.id);\n\n  const enterLayers = this.el.layers\n    .enter()\n    .append('rect')\n    .attr('class', 'pipeline-layer');\n\n  this.el.layers.exit().remove();\n\n  this.el.layers = this.el.layers.merge(enterLayers);\n\n  this.el.layers\n    .attr('x', (d) => d.x)\n    .attr('y', (d) => d.y)\n    .attr('height', (d) => d.height)\n    .attr('width', (d) => d.width);\n};\n\n/**\n * Render layer name labels\n */\nexport const drawLayerNames = function () {\n  const {\n    chartSize: { sidebarWidth = 0 },\n    layers,\n  } = this.props;\n\n  this.el.layerNameGroup\n    .transition('layer-names-sidebar-width')\n    .duration(this.DURATION)\n    .style('transform', `translateX(${sidebarWidth}px)`);\n\n  this.el.layerNames = this.el.layerNameGroup\n    .selectAll('.pipeline-layer-name')\n    .data(layers, (layer) => layer.id);\n\n  const enterLayerNames = this.el.layerNames\n    .enter()\n    .append('li')\n    .attr('class', 'pipeline-layer-name');\n\n  enterLayerNames\n    .style('opacity', 0)\n    .transition('enter-layer-names')\n    .duration(this.DURATION)\n    .style('opacity', 1);\n\n  this.el.layerNames\n    .exit()\n    .style('opacity', 1)\n    .transition('exit-layer-names')\n    .duration(this.DURATION)\n    .style('opacity', 0)\n    .remove();\n\n  this.el.layerNames = this.el.layerNames.merge(enterLayerNames);\n\n  this.el.layerNames.text((d) => d.name).attr('dy', 5);\n};\n\n/**\n * Sets the size and position of the given node rects\n */\nconst updateNodeRects = (nodeRects) =>\n  nodeRects\n    .attr('width', (node) => node.width - 5)\n    .attr('height', (node) => node.height - 5)\n    .attr('x', (node) => (node.width - 5) / -2)\n    .attr('y', (node) => (node.height - 5) / -2)\n    .attr('rx', (node) => {\n      // Task and Pipeline nodes are rectangle so radius on x-axis is 0\n      if (node.type === 'task' || node.type === 'modularPipeline') {\n        return 0;\n      }\n      return node.height / 2;\n    });\n\nconst updateParameterRect = (nodeRects) =>\n  nodeRects\n    .attr('width', 12)\n    .attr('height', 12)\n    .attr('x', (node) => (node.width + 20) / -2)\n    .attr('y', -6);\n\n/**\n * Render node icons and name labels\n */\nexport const drawNodes = function (changed) {\n  const {\n    clickedNode,\n    linkedNodes,\n    nodeTypeDisabled,\n    nodeActive,\n    nodeSelected,\n    hoveredParameters,\n    nodesWithInputParams,\n    inputOutputDataNodes,\n    nodes,\n    focusMode,\n  } = this.props;\n\n  const isInputOutputNode = (nodeID) =>\n    focusMode !== null && inputOutputDataNodes[nodeID];\n\n  if (changed('nodes')) {\n    this.el.nodes = this.el.nodeGroup\n      .selectAll('.pipeline-node')\n      .data(nodes, (node) => node.id);\n  }\n\n  if (!this.el.nodes) {\n    return;\n  }\n\n  const updateNodes = this.el.nodes;\n  const enterNodes = this.el.nodes.enter().append('g');\n  const exitNodes = this.el.nodes.exit();\n  // Filter out undefined nodes on Safari\n  const allNodes = this.el.nodes\n    .merge(enterNodes)\n    .merge(exitNodes)\n    .filter((node) => typeof node !== 'undefined');\n\n  if (changed('nodes')) {\n    enterNodes\n      .attr('tabindex', '0')\n      .attr('class', 'pipeline-node')\n      .attr('transform', (node) => `translate(${node.x}, ${node.y})`)\n      .attr('data-id', (node) => node.id)\n      .classed(\n        'pipeline-node--parameters',\n        (node) => node.type === 'parameters'\n      )\n      .classed('pipeline-node--data', (node) => node.type === 'data')\n      .classed('pipeline-node--task', (node) => node.type === 'task')\n      .on('click', this.handleNodeClick)\n      .on('mouseover', this.handleNodeMouseOver)\n      .on('mouseout', this.handleNodeMouseOut)\n      .on('focus', this.handleNodeMouseOver)\n      .on('blur', this.handleNodeMouseOut)\n      .on('keydown', this.handleNodeKeyDown);\n\n    enterNodes\n      .attr('opacity', 0)\n      .transition('show-nodes')\n      .duration(this.DURATION)\n      .attr('opacity', 1);\n\n    enterNodes.append('rect').attr('class', 'pipeline-node__bg');\n\n    enterNodes\n      .append('rect')\n      .attr('class', 'pipeline-node__parameter-indicator')\n      .on('mouseover', this.handleParamsIndicatorMouseOver)\n      .call(updateParameterRect);\n\n    // Performance: use a single path per icon\n    enterNodes\n      .append('path')\n      .attr('class', 'pipeline-node__icon')\n      .attr('d', (node) => nodeIcons[node.icon]);\n\n    enterNodes\n      .append('text')\n      .attr('class', 'pipeline-node__text')\n      .text((node) => node.name)\n      .attr('text-anchor', 'middle')\n      .attr('dy', 5)\n      .attr('dx', (node) => node.textOffset);\n\n    exitNodes\n      .transition('exit-nodes')\n      .duration(this.DURATION)\n      .style('opacity', 0)\n      .remove();\n\n    // Cancel exit transitions if re-entered\n    updateNodes.transition('exit-nodes').style('opacity', null);\n\n    this.el.nodes = this.el.nodeGroup.selectAll('.pipeline-node');\n  }\n\n  if (\n    changed(\n      'nodes',\n      'nodeTypeDisabled',\n      'nodeActive',\n      'nodeSelected',\n      'hoveredParameters',\n      'nodesWithInputParams',\n      'clickedNode',\n      'linkedNodes',\n      'focusMode',\n      'inputOutputDataNodes'\n    )\n  ) {\n    allNodes\n      .classed('pipeline-node--active', (node) => nodeActive[node.id])\n      .classed('pipeline-node--selected', (node) => nodeSelected[node.id])\n      .classed(\n        'pipeline-node--collapsed-hint',\n        (node) =>\n          hoveredParameters &&\n          nodesWithInputParams[node.id] &&\n          nodeTypeDisabled.parameters\n      )\n      .classed(\n        'pipeline-node--dataset-input',\n        (node) => isInputOutputNode(node.id) && node.type === 'data'\n      )\n      .classed(\n        'pipeline-node--parameter-input',\n        (node) => isInputOutputNode(node.id) && node.type === 'parameters'\n      )\n      .classed(\n        'pipeline-node--faded',\n        (node) => clickedNode && !linkedNodes[node.id]\n      );\n  }\n\n  if (changed('nodes')) {\n    allNodes\n      .transition('update-nodes')\n      .duration(this.DURATION)\n      .attr('transform', (node) => `translate(${node.x}, ${node.y})`)\n      .on('end', () => {\n        try {\n          // Sort nodes so tab focus order follows X/Y position\n          allNodes.sort((a, b) => a.order - b.order);\n        } catch (err) {\n          // Avoid rare DOM errors thrown due to timing issues\n        }\n      });\n\n    enterNodes.select('.pipeline-node__bg').call(updateNodeRects);\n\n    updateNodes\n      .select('.pipeline-node__bg')\n      .transition('node-rect')\n      .duration((node) => (node.showText ? 200 : 600))\n      .call(updateNodeRects);\n    allNodes\n      .select('.pipeline-node__parameter-indicator')\n      .classed(\n        'pipeline-node__parameter-indicator--visible',\n        (node) => nodeTypeDisabled.parameters && nodesWithInputParams[node.id]\n      )\n      .transition('node-rect')\n      .duration((node) => (node.showText ? 200 : 600))\n      .call(updateParameterRect);\n\n    // Performance: icon transitions with CSS on GPU\n    allNodes\n      .select('.pipeline-node__icon')\n      .style('transition-delay', (node) => (node.showText ? '0ms' : '200ms'))\n      .style(\n        'transform',\n        (node) =>\n          `translate(${node.iconOffset}px, ${-node.iconSize / 2}px) ` +\n          `scale(${node.iconSize / 24})`\n      );\n\n    // Performance: text transitions with CSS on GPU\n    allNodes\n      .select('.pipeline-node__text')\n      .text((node) => node.name)\n      .style('transition-delay', (node) => (node.showText ? '200ms' : '0ms'))\n      .style('opacity', (node) => (node.showText ? 1 : 0));\n  }\n};\n\n/**\n * Render edge lines\n */\nexport const drawEdges = function (changed) {\n  const { edges, clickedNode, linkedNodes, focusMode, inputOutputDataEdges } =\n    this.props;\n\n  const isInputOutputEdge = (edgeID) =>\n    focusMode !== null && inputOutputDataEdges[edgeID];\n\n  if (changed('edges')) {\n    this.el.edges = this.el.edgeGroup\n      .selectAll('.pipeline-edge')\n      .data(edges, (edge) => edge.id);\n  }\n\n  if (!this.el.edges) {\n    return;\n  }\n\n  const updateEdges = this.el.edges;\n  const enterEdges = this.el.edges.enter().append('g');\n  const exitEdges = this.el.edges.exit();\n  const allEdges = this.el.edges.merge(enterEdges).merge(exitEdges);\n\n  if (changed('edges', 'focusMode', 'inputOutputDataNodes')) {\n    enterEdges.append('path');\n    allEdges\n      .select('path')\n      .attr('marker-end', (edge) =>\n        edge.sourceNode.type === 'parameters'\n          ? isInputOutputEdge(edge.id)\n            ? `url(#pipeline-arrowhead--accent--input)`\n            : `url(#pipeline-arrowhead--accent)`\n          : isInputOutputEdge(edge.id)\n          ? `url(#pipeline-arrowhead--input)`\n          : `url(#pipeline-arrowhead)`\n      );\n\n    enterEdges\n      .attr('data-id', (edge) => edge.id)\n      .attr('class', 'pipeline-edge');\n\n    enterEdges\n      .attr('opacity', 0)\n      .transition('show-edges')\n      .duration(this.DURATION)\n      .attr('opacity', 1);\n\n    exitEdges\n      .transition('exit-edges')\n      .duration(this.DURATION)\n      .style('opacity', 0)\n      .remove();\n\n    // Cancel exit transitions if re-entered\n    updateEdges.transition('exit-edges').style('opacity', null);\n\n    allEdges\n      .select('path')\n      .transition('update-edges')\n      .duration(this.DURATION)\n      .attrTween('d', function (edge) {\n        // Performance: Limit path precision for parsing & render\n        let current = edge.points && limitPrecision(lineShape(edge.points));\n        const previous = select(this).attr('d') || current;\n        return interpolatePath(previous, current);\n      });\n\n    this.el.edges = this.el.edgeGroup.selectAll('.pipeline-edge');\n  }\n\n  if (\n    changed(\n      'edges',\n      'clickedNode',\n      'linkedNodes',\n      'focusMode',\n      'inputOutputDataEdges'\n    )\n  ) {\n    allEdges\n      .classed(\n        'pipeline-edge--parameters',\n        (edge) =>\n          edge.sourceNode.type === 'parameters' && !isInputOutputEdge(edge.id)\n      )\n      .classed(\n        'pipeline-edge--parameters-input',\n        (edge) =>\n          edge.sourceNode.type === 'parameters' && isInputOutputEdge(edge.id)\n      )\n      .classed('pipeline-edge--dataset--input', (edge) =>\n        isInputOutputEdge(edge.id)\n      )\n      .classed(\n        'pipeline-edge--faded',\n        (edge) =>\n          edge &&\n          clickedNode &&\n          (!linkedNodes[edge.source] || !linkedNodes[edge.target])\n      );\n  }\n};\n","import 'd3-transition';\nimport { select } from 'd3-selection';\nimport { interpolate } from 'd3-interpolate';\nimport { zoom as d3Zoom, zoomIdentity, zoomTransform } from 'd3-zoom';\n\n/**\n * Applies an active viewport behaviour on the given elements using d3-zoom.\n * Returns an object representing the view for use in view related functions.\n * @param {Object} options The options to use\n * @param {React.Ref} options.container The container element ref\n * @param {React.Ref} options.wrapper The wrapper element ref\n * @param {?Function} options.onViewChanged Callback when view changes\n * @param {?Function} options.onViewEnd Callback when view change ends\n * @param {?Boolean} [options.allowUserInput=true] Enable or disable user input\n * @returns {Object} An object representing the view\n */\nexport const viewing = ({\n  container,\n  wrapper,\n  onViewChanged,\n  onViewEnd,\n  allowUserInput = true,\n}) => {\n  const zoom = d3Zoom()\n    .on('zoom', (event) => {\n      const transform = event.transform;\n\n      // Ignore invalid transforms\n      if (isInvalidTransform(transform)) {\n        return;\n      }\n\n      select(wrapper.current).attr('transform', transform);\n      onViewChanged && onViewChanged(transform);\n    })\n    .on('end', onViewEnd)\n    // Use linear interpolation\n    .interpolate(interpolate);\n\n  if (!allowUserInput) {\n    // Ignore all user input default behaviour\n    zoom.filter(() => false);\n  }\n\n  select(container.current)\n    .call(zoom)\n    // Disable default double click to avoid conflicts\n    .on('dblclick.zoom', null);\n\n  return {\n    zoom,\n    container,\n    wrapper,\n  };\n};\n\n/**\n * A constant for the origin transform { x: 0, y: 0, k: 1 }\n */\nexport const origin = zoomIdentity;\n\n/**\n * Returns true if the transform is equivalent to the origin { x: 0, y: 0, k: 1 }\n * @param {Object} transform A transform object to test\n * @returns {Boolean} True if equivalent else false\n */\nexport const isOrigin = ({ x, y, k }) =>\n  x === origin.x && y === origin.y && k === origin.k;\n\n/**\n * Returns true if the transform meets this definition:\n *  - any component (x, y or k) is infinite, `NaN` or `undefined`\n * otherwise returns false.\n * @param {Object} transform A transform object to test\n * @returns {Boolean} True if the transform is invalid else false\n */\nexport const isInvalidTransform = ({ x, y, k }) =>\n  !isFinite(x + y + k) || isNaN(x + y + k) || (x === 0 && y === 0 && k === 0);\n\n/**\n * Returns the current transform of the given view.\n * This is equivalent to the container CSS transform but negated.\n * @param {Object} view The view\n * @returns {Object} The view transform\n */\nexport const getViewTransform = (view) => {\n  const transform = zoomTransform(view.wrapper.current);\n  return isInvalidTransform(transform) ? origin : negateTransform(transform);\n};\n\n/**\n * Negates the x and y components, in effect making the direction opposite.\n * Scale component does not change. Zeroes are always positive.\n * @private\n * @param {Object} transform The transform to negate\n * @returns {Object} The new transform\n */\nconst negateTransform = (transform) =>\n  // This ensures +0 instead of -0\n  origin.translate(-transform.x || 0, -transform.y || 0).scale(transform.k);\n\n/**\n * Sets the extents of the given view.\n * Translate and scale extents may be provided individually.\n * @param {Object} view The view\n * @param {Object} extents The exents\n */\nexport const setViewExtents = (view, { translate, scale }) => {\n  if (translate) {\n    const { minX, minY, maxX, maxY } = translate;\n    view.zoom.translateExtent([\n      [minX, minY],\n      [maxX, maxY],\n    ]);\n  }\n\n  if (scale) {\n    const { minK, maxK } = scale;\n    view.zoom.scaleExtent([minK, maxK]);\n  }\n};\n\n/**\n * Gets the extents of the given view including both translate and scale.\n * @param {Object} view The view\n * @returns {Object} The view extents\n */\nexport const getViewExtents = (view) => {\n  const scale = view.zoom.scaleExtent();\n  const translate = view.zoom.translateExtent();\n  return {\n    translate: {\n      minX: translate[0][0],\n      minY: translate[0][1],\n      maxX: translate[1][0],\n      maxY: translate[1][1],\n    },\n    scale: { minK: scale[0], maxK: scale[1] },\n  };\n};\n\n/**\n * Gets the bounds of the viewport.\n * By default this retrieves the container element dimensions unless an alternative viewport is set.\n * @param {Object} view The view\n * @returns {Object} The viewport extents\n */\nexport const getViewport = (view) => {\n  const viewport = view.zoom.extent()(select(view.container.current));\n  return {\n    top: viewport[0][1],\n    left: viewport[0][0],\n    bottom: viewport[1][1],\n    right: viewport[1][0],\n  };\n};\n\n/**\n * Sets the bounds of the viewport instead of using container element dimensions.\n * @param {Object} view The view\n * @param {Object} viewport The viewport bounds\n */\nexport const setViewport = (view, viewport) => {\n  view.zoom.extent([\n    [viewport.left, viewport.top],\n    [viewport.right, viewport.bottom],\n  ]);\n};\n\n/**\n * Sets the view transform on the view with optional transition.\n * Always respects the view extent constraints.\n * Translate and scale components may be provided individually.\n * Transform is absolute unless relative option set, where it will be added.\n * @param {Object} view The view\n * @param {Object} transform The transform to set on the view\n * @param {?Number} [duration=0] The transition duration (or 0 for none)\n * @param {?Boolean} [relative=false] When true, transform added to current transform\n */\nexport const setViewTransform = (\n  view,\n  transform,\n  duration = 0,\n  relative = false\n) => {\n  const container = select(view.container.current);\n  const current = getViewTransform(view);\n  const hasTranslation =\n    typeof transform.x !== 'undefined' && typeof transform.y !== 'undefined';\n  let k, x, y;\n\n  if (typeof jest !== 'undefined') {\n    // Transitions not supported in tests\n    duration = 0;\n  }\n\n  if (relative) {\n    // Relative: v' = v + t\n    k = current.k + (transform.k || 0);\n    x = current.x + (transform.x || 0);\n    y = current.y + (transform.y || 0);\n  } else {\n    // Absolute: v' = t\n    k = transform.k || current.k;\n    x = transform.x || current.x;\n    y = transform.y || current.y;\n  }\n\n  // Only translate if requested to avoid scale offset\n  if (hasTranslation) {\n    // Apply translation respecting extents\n    container.call(view.zoom.transform, origin);\n    container.call(view.zoom.translateTo, x / k, y / k);\n  }\n\n  // Apply scale respecting extents\n  container.call(view.zoom.scaleTo, k);\n\n  // If the update requires a transition\n  if (duration) {\n    // Store the already computed final transform\n    const final = getViewTransform(view);\n\n    // Revert to the initial transform\n    container.call(view.zoom.transform, negateTransform(current));\n\n    // Transition to the final transform\n    setViewTransformExact(view, final, duration);\n  }\n};\n\n/**\n * Sets the transform on the view with optional transition.\n * Ignores the view extent constraints.\n * The transform must be absolute containing both translate and scale components.\n * @param {Object} view The view\n * @param {Object} transform The transform to set on the view\n * @param {?Number} [duration=0] The transition duration (or 0 for none)\n */\nexport const setViewTransformExact = (view, transform, duration = 0) => {\n  const container = select(view.container.current);\n\n  // Convert transform\n  const final = origin.translate(-transform.x, -transform.y).scale(transform.k);\n\n  if (typeof jest !== 'undefined') {\n    // Simulate application in tests\n    view.container.current.__zoom = final;\n    return;\n  }\n\n  // Apply the transform ignoring extents\n  (!duration\n    ? container\n    : container.transition('zoom').duration(duration)\n  ).call(view.zoom.transform, final);\n};\n\n/**\n * Returns a view transform that fits the object dimensions\n * and optional focus point inside the given view dimensions,\n * while respecting a minimum desired scale.\n * @param {Object} options The options\n * @param {Object} options.offset The origin point\n * @param {?Object} options.focus The optional point to keep in focus\n * @param {Number} options.viewWidth The width of the viewport\n * @param {Number} options.viewHeight The height of the viewport\n * @param {Number} options.objectWidth The width of the object\n * @param {Number} options.objectHeight The height of the object\n * @param {?Number} [options.minScaleX=0] The minimum X scale\n * @param {?Number} [options.minScaleFocus=0] The minimum scale when focus given\n * @param {?Number} [options.focusOffset=0.8] Offset center towards relative focus position\n * @returns {Object} A view transform that fits the constraints\n */\nexport const viewTransformToFit = ({\n  offset,\n  focus,\n  viewWidth,\n  viewHeight,\n  objectWidth,\n  objectHeight,\n  minScaleX = 0,\n  minScaleFocus = 0,\n  focusOffset = 0.8,\n}) => {\n  let scale = origin.k;\n  let x = origin.x;\n  let y = origin.y;\n\n  // Get the scales that fit each axis\n  const scaleY = viewHeight / objectHeight;\n  const scaleX = viewWidth / objectWidth;\n\n  // Apply a minimum to X but allow Y to fit\n  const scaleXClamp = Math.max(minScaleX, scaleX);\n\n  // To fit both axis, choose the smaller one\n  scale = Math.min(scaleXClamp, scaleY);\n\n  // If there is a focus point\n  if (focus) {\n    // Ensure scale is a reasonable size\n    scale = Math.max(minScaleFocus, scale);\n  }\n\n  // Offset the origin\n  x += offset.x;\n  y += offset.y;\n\n  // Offset to center whole object\n  x += (viewWidth - objectWidth * scale) * 0.5;\n  y += (viewHeight - objectHeight * scale) * 0.5;\n\n  // When there is a focus point set\n  if (focus) {\n    // Find which axes would become cropped\n    const isCroppedX = viewWidth < objectWidth * scale;\n    const isCroppedY = viewHeight < objectHeight * scale;\n\n    const objectCenterX = objectWidth * 0.5;\n    const objectCenterY = objectHeight * 0.5;\n\n    // Offset on the cropped axes only\n    const focusCenterOffsetX = isCroppedX ? objectCenterX - focus.x : 0;\n    const focusCenterOffsetY = isCroppedY ? objectCenterY - focus.y : 0;\n\n    const focusRelativeOffsetX = focusCenterOffsetX / objectWidth;\n    const focusRelativeOffsetY = focusCenterOffsetY / objectHeight;\n\n    // Offset to exactly center on the selected focus\n    x += focusCenterOffsetX * scale;\n    y += focusCenterOffsetY * scale;\n\n    // Adjust centering to better account for focus position\n    x -= focusRelativeOffsetX * viewWidth * focusOffset;\n    y -= focusRelativeOffsetY * viewHeight * focusOffset;\n  }\n\n  // This ensures +0 instead of -0\n  return { x: -x || 0, y: -y || 0, k: scale };\n};\n","import React from 'react';\nimport classnames from 'classnames';\nimport './tooltip.css';\n\nconst zeroWidthSpace = String.fromCharCode(0x200b);\n\n/**\n * Force tooltip text to break on special characters\n * @param {string} text Any text with special characters\n * @return {string} text\n */\nexport const insertZeroWidthSpace = (text) =>\n  text.replace(/([^\\w\\s]|[_])/g, `${zeroWidthSpace}$1${zeroWidthSpace}`);\n\n/**\n * Display flowchart node tooltip\n * @param {object} chartSize Chart dimensions in pixels\n * @param {object} targetRect event.target.getBoundingClientRect()\n * @param {boolean} visible Whether to show the tooltip\n * @param {string} text Tooltip display label\n */\nconst Tooltip = ({ chartSize, targetRect, visible, text }) => {\n  const { left, top, width, height, outerWidth, sidebarWidth } = chartSize;\n  const isRight = targetRect.left - sidebarWidth > width / 2;\n  const isTop = targetRect.top < height / 2;\n  const xOffset = isRight ? targetRect.left - outerWidth : targetRect.left;\n  const yOffset = isTop ? targetRect.top + targetRect.height : targetRect.top;\n  const x = xOffset - left + targetRect.width / 2;\n  const y = yOffset - top;\n\n  return (\n    <div\n      className={classnames('pipeline-tooltip', {\n        'pipeline-tooltip--visible': visible,\n        'pipeline-tooltip--right': isRight,\n        'pipeline-tooltip--top': isTop,\n      })}\n      style={{ transform: `translate(${x}px, ${y}px)` }}>\n      <div className=\"pipeline-tooltip__text\">{insertZeroWidthSpace(text)}</div>\n    </div>\n  );\n};\n\nTooltip.defaultProps = {\n  chartSize: {},\n  targetRect: {},\n  visible: false,\n  text: '',\n};\n\nexport default Tooltip;\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport classnames from 'classnames';\nimport { select } from 'd3-selection';\nimport { updateChartSize, updateZoom } from '../../actions';\nimport { loadNodeData, toggleNodeHovered } from '../../actions/nodes';\nimport {\n  getNodeActive,\n  getNodeSelected,\n  getNodesWithInputParams,\n  getInputOutputNodesForFocusedModularPipeline,\n} from '../../selectors/nodes';\nimport { getInputOutputDataEdges } from '../../selectors/edges';\nimport { getChartSize, getChartZoom } from '../../selectors/layout';\nimport { getLayers } from '../../selectors/layers';\nimport { getLinkedNodes } from '../../selectors/linked-nodes';\nimport { getVisibleMetaSidebar } from '../../selectors/metadata';\nimport { drawNodes, drawEdges, drawLayers, drawLayerNames } from './draw';\nimport {\n  viewing,\n  isOrigin,\n  viewTransformToFit,\n  setViewTransform,\n  getViewTransform,\n  setViewTransformExact,\n  setViewExtents,\n  getViewExtents,\n} from '../../utils/view';\nimport Tooltip from '../tooltip';\nimport './styles/flowchart.css';\n\n/**\n * Display a pipeline flowchart, mostly rendered with D3\n */\nexport class FlowChart extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tooltip: { visible: false },\n    };\n    this.onViewChange = this.onViewChange.bind(this);\n    this.onViewChangeEnd = this.onViewChangeEnd.bind(this);\n\n    this.containerRef = React.createRef();\n    this.svgRef = React.createRef();\n    this.wrapperRef = React.createRef();\n    this.edgesRef = React.createRef();\n    this.nodesRef = React.createRef();\n    this.layersRef = React.createRef();\n    this.layerNamesRef = React.createRef();\n\n    this.DURATION = 700;\n    this.MARGIN = 500;\n    this.MIN_SCALE = 0.8;\n    this.MAX_SCALE = 2;\n  }\n\n  componentDidMount() {\n    this.selectD3Elements();\n    this.updateChartSize();\n\n    this.view = viewing({\n      container: this.svgRef,\n      wrapper: this.wrapperRef,\n      onViewChanged: this.onViewChange,\n      onViewEnd: this.onViewChangeEnd,\n    });\n\n    this.updateViewExtents();\n    this.addGlobalEventListeners();\n    this.update();\n\n    if (this.props.tooltip) {\n      this.showTooltip(null, null, this.props.tooltip);\n    } else {\n      this.hideTooltip();\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeGlobalEventListeners();\n  }\n\n  componentDidUpdate(prevProps) {\n    this.update(prevProps);\n  }\n\n  /**\n   * Updates drawing and zoom if props have changed\n   */\n  update(prevProps = {}) {\n    const { chartZoom } = this.props;\n    const changed = (...names) => this.changed(names, prevProps, this.props);\n\n    if (changed('visibleSidebar', 'visibleCode', 'visibleMetaSidebar')) {\n      this.updateChartSize();\n    }\n\n    if (changed('layers', 'chartSize')) {\n      drawLayers.call(this);\n      drawLayerNames.call(this);\n    }\n\n    if (\n      changed(\n        'edges',\n        'clickedNode',\n        'linkedNodes',\n        'focusMode',\n        'inputOutputDataEdges'\n      )\n    ) {\n      drawEdges.call(this, changed);\n    }\n\n    if (\n      changed(\n        'nodes',\n        'clickedNode',\n        'linkedNodes',\n        'nodeTypeDisabled',\n        'nodeActive',\n        'nodeSelected',\n        'hoveredParameters',\n        'nodesWithInputParams',\n        'focusMode',\n        'inputOutputDataNodes'\n      )\n    ) {\n      drawNodes.call(this, changed);\n    }\n\n    if (changed('edges', 'nodes', 'layers', 'chartSize', 'clickedNode')) {\n      this.resetView();\n    } else {\n      this.onChartZoomChanged(chartZoom);\n    }\n  }\n\n  /**\n   * Returns true if any of the given props are different between given objects.\n   * Only shallow changes are detected.\n   */\n  changed(props, objectA, objectB) {\n    return (\n      objectA &&\n      objectB &&\n      props.some((prop) => objectA[prop] !== objectB[prop])\n    );\n  }\n\n  /**\n   * Create D3 element selectors\n   */\n  selectD3Elements() {\n    this.el = {\n      svg: select(this.svgRef.current),\n      wrapper: select(this.wrapperRef.current),\n      edgeGroup: select(this.edgesRef.current),\n      nodeGroup: select(this.nodesRef.current),\n      layerGroup: select(this.layersRef.current),\n      layerNameGroup: select(this.layerNamesRef.current),\n    };\n  }\n\n  /**\n   * Update the chart size in state from chart container bounds.\n   * This is emulated in tests with a constant fixed size.\n   */\n  updateChartSize() {\n    if (typeof jest !== 'undefined') {\n      // Emulate chart size for tests\n      this.props.onUpdateChartSize(chartSizeTestFallback);\n    } else {\n      // Use container bounds\n      this.props.onUpdateChartSize(\n        this.containerRef.current.getBoundingClientRect()\n      );\n    }\n  }\n\n  /**\n   * Add window event listeners on mount\n   */\n  addGlobalEventListeners() {\n    // Add ResizeObserver to listen for any changes in the container's width/height\n    // (with event listener fallback)\n    if (window.ResizeObserver) {\n      this.resizeObserver =\n        this.resizeObserver ||\n        new window.ResizeObserver(this.handleWindowResize);\n      this.resizeObserver.observe(this.containerRef.current);\n    } else {\n      window.addEventListener('resize', this.handleWindowResize);\n    }\n    // Print event listeners\n    window.addEventListener('beforeprint', this.handleBeforePrint);\n    window.addEventListener('afterprint', this.handleAfterPrint);\n  }\n\n  /**\n   * Remove window event listeners on unmount\n   */\n  removeGlobalEventListeners() {\n    // ResizeObserver\n    if (window.ResizeObserver) {\n      this.resizeObserver.unobserve(this.containerRef.current);\n    } else {\n      window.removeEventListener('resize', this.handleWindowResize);\n    }\n    // Print event listeners\n    window.removeEventListener('beforeprint', this.handleBeforePrint);\n    window.removeEventListener('afterprint', this.handleAfterPrint);\n  }\n\n  /**\n   * Handle window resize\n   */\n  handleWindowResize = () => {\n    this.updateChartSize();\n  };\n\n  /**\n   * Add viewBox on window print so that the SVG can be scaled to fit\n   */\n  handleBeforePrint = () => {\n    const graphSize = this.props.graphSize;\n    const width = graphSize.width + graphSize.marginx * 2;\n    const height = graphSize.height + graphSize.marginy * 2;\n    this.el.svg.attr('viewBox', `0 0 ${width} ${height}`);\n  };\n\n  /**\n   * Remove viewBox once printing is done\n   */\n  handleAfterPrint = () => {\n    this.el.svg.attr('viewBox', null);\n  };\n\n  /**\n   * On every frame of every view transform change (from reset, pan, zoom etc.)\n   * @param {Object} transform The current view transfrom\n   */\n  onViewChange(transform) {\n    const { k: scale, x, y } = transform;\n\n    // Apply animating class to zoom wrapper\n    this.el.wrapper.classed(\n      'pipeline-flowchart__zoom-wrapper--animating',\n      true\n    );\n\n    // Update layer label y positions\n    if (this.el.layerNames) {\n      this.el.layerNames.style('transform', (d) => {\n        const updateY = y + (d.y + d.height / 2) * scale;\n        return `translateY(${updateY}px)`;\n      });\n    }\n\n    // Hide the tooltip so it doesn't get misaligned to its node\n    this.hideTooltip();\n\n    // Update extents\n    this.updateViewExtents(transform);\n    const extents = getViewExtents(this.view);\n\n    // Share the applied zoom state with other components\n    this.props.onUpdateZoom({\n      scale,\n      x,\n      y,\n      applied: true,\n      transition: false,\n      relative: false,\n      minScale: extents.scale.minK,\n      maxScale: extents.scale.maxK,\n    });\n  }\n\n  /**\n   * Called when the view changes have ended (i.e. after transition ends)\n   */\n  onViewChangeEnd() {\n    this.el.wrapper.classed(\n      'pipeline-flowchart__zoom-wrapper--animating',\n      false\n    );\n  }\n\n  /**\n   * Updates view extents based on the current view transform.\n   * Offsets the extents considering any open sidebars.\n   * Allows additional margin for user panning within limits.\n   * Zoom scale is limited to a practical range for usability.\n   * @param {?Object} transform Current transform override\n   */\n  updateViewExtents(transform) {\n    const { k: scale } = transform || getViewTransform(this.view);\n\n    const {\n      sidebarWidth = 0,\n      metaSidebarWidth = 0,\n      codeSidebarWidth = 0,\n      width: chartWidth = 0,\n      height: chartHeight = 0,\n    } = this.props.chartSize;\n\n    const { width: graphWidth = 0, height: graphHeight = 0 } =\n      this.props.graphSize;\n\n    const leftSidebarOffset = sidebarWidth / scale;\n    const rightSidebarOffset = (metaSidebarWidth + codeSidebarWidth) / scale;\n    const margin = this.MARGIN;\n\n    // Find the relative minimum scale to fit whole graph\n    const minScale = Math.min(\n      chartWidth / (graphWidth || 1),\n      chartHeight / (graphHeight || 1)\n    );\n\n    setViewExtents(this.view, {\n      translate: {\n        minX: -leftSidebarOffset - margin,\n        maxX: graphWidth + margin + rightSidebarOffset,\n        minY: -margin,\n        maxY: graphHeight + margin,\n      },\n      scale: {\n        minK: this.MIN_SCALE * minScale,\n        maxK: this.MAX_SCALE,\n      },\n    });\n  }\n\n  /**\n   * Applies the given zoom state as necessary\n   * @param {Object} chartZoom The new zoom state\n   */\n  onChartZoomChanged(chartZoom) {\n    // No change if already applied (e.g. was an internal update)\n    if (chartZoom.applied) {\n      return;\n    }\n\n    // Apply reset if it was requested\n    if (chartZoom.reset === true) {\n      this.resetView();\n      return;\n    }\n\n    // Set the view while respecting extents\n    setViewTransform(\n      this.view,\n      { x: chartZoom.x, y: chartZoom.y, k: chartZoom.scale },\n      chartZoom.transition ? this.DURATION * 0.3 : 0,\n      chartZoom.relative\n    );\n  }\n\n  /**\n   * Zoom and scale to fit graph and any selected node in view\n   */\n  resetView() {\n    const { chartSize, graphSize, clickedNode, nodes } = this.props;\n    const { width: chartWidth, height: chartHeight } = chartSize;\n    const { width: graphWidth, height: graphHeight } = graphSize;\n\n    // Skip if chart or graph is not ready yet\n    if (!chartWidth || !graphWidth) {\n      return;\n    }\n\n    // Sidebar offset\n    const offset = { x: chartSize.sidebarWidth, y: 0 };\n\n    // Use the selected node as focus point\n    const focus = clickedNode\n      ? nodes.find((node) => node.id === clickedNode)\n      : null;\n\n    // Find a transform that fits everything in view\n    const transform = viewTransformToFit({\n      offset,\n      focus,\n      viewWidth: chartWidth,\n      viewHeight: chartHeight,\n      objectWidth: graphWidth,\n      objectHeight: graphHeight,\n      minScaleX: 0.2,\n      minScaleFocus: 0.3,\n      focusOffset: 0.8,\n    });\n\n    // Detect first transform\n    const isFirstTransform = isOrigin(getViewTransform(this.view));\n\n    // Apply transform ignoring extents\n    setViewTransformExact(\n      this.view,\n      transform,\n      isFirstTransform ? 0 : this.DURATION,\n      false\n    );\n  }\n\n  /**\n   * Returns parameter count when there are more\n   * than one parameters and parameter name if there's a single parameter\n   * @param {Array} parameterNames\n   * @returns {String}\n   */\n  getHoveredParameterLabel = (parameterNames) =>\n    parameterNames.length > 1\n      ? `Parameters:${parameterNames.length}`\n      : parameterNames[0];\n\n  /**\n   * Enable a node's focus state and highlight linked nodes\n   * @param {Object} event Event object\n   * @param {Object} node Datum for a single node\n   */\n  handleNodeClick = (event, node) => {\n    this.props.onLoadNodeData(node.id);\n    event.stopPropagation();\n  };\n\n  /**\n   * Remove a node's focus state and dim linked nodes\n   */\n  handleChartClick = () => {\n    this.props.onLoadNodeData(null);\n  };\n\n  /**\n   * Enable a node's active state, show tooltip, and highlight linked nodes\n   * @param {Object} event Event object\n   * @param {Object} node Datum for a single node\n   */\n  handleNodeMouseOver = (event, node) => {\n    this.props.onToggleNodeHovered(node.id);\n    node && this.showTooltip(event, node.fullName);\n  };\n\n  /**\n   * Shows tooltip when the parameter indicator is hovered on\n   * @param {Object} event Event object\n   * @param {Object} node Datum for a single node\n   */\n  handleParamsIndicatorMouseOver = (event, node) => {\n    const parameterNames = this.props.nodesWithInputParams[node.id];\n    if (parameterNames) {\n      const label = this.getHoveredParameterLabel(parameterNames);\n\n      this.showTooltip(event, label);\n    }\n    event.stopPropagation();\n  };\n\n  /**\n   * Remove a node's active state, hide tooltip, and dim linked nodes\n   * @param {Object} node Datum for a single node\n   */\n  handleNodeMouseOut = () => {\n    this.props.onToggleNodeHovered(null);\n    this.hideTooltip();\n  };\n\n  /**\n   * Handle keydown event when a node is focused\n   * @param {Object} event Event object\n   * @param {Object} node Datum for a single node\n   */\n  handleNodeKeyDown = (event, node) => {\n    const ENTER = 13;\n    const ESCAPE = 27;\n    if (event.keyCode === ENTER) {\n      this.handleNodeClick(event, node);\n    }\n    if (event.keyCode === ESCAPE) {\n      this.handleChartClick();\n      this.handleNodeMouseOut();\n    }\n  };\n\n  /**\n   * Show, fill and and position the tooltip\n   * @param {Object} event Event object\n   * @param {Object} text Text to show on the tooltip\n   * @param {?Object} options Options for the tooltip if required\n   */\n  showTooltip(event, text, options = {}) {\n    this.setState({\n      tooltip: {\n        targetRect: event && event.target.getBoundingClientRect(),\n        text: text,\n        visible: true,\n        ...options,\n      },\n    });\n  }\n\n  /**\n   * Hide the tooltip\n   */\n  hideTooltip() {\n    if (this.state.tooltip.visible) {\n      this.setState({\n        tooltip: {\n          ...this.state.tooltip,\n          visible: false,\n        },\n      });\n    }\n  }\n\n  /**\n   * Render React elements\n   */\n  render() {\n    const { chartSize, layers, visibleGraph } = this.props;\n    const { outerWidth = 0, outerHeight = 0 } = chartSize;\n\n    return (\n      <div\n        className=\"pipeline-flowchart kedro\"\n        ref={this.containerRef}\n        onClick={this.handleChartClick}>\n        <svg\n          id=\"pipeline-graph\"\n          className=\"pipeline-flowchart__graph\"\n          width={outerWidth}\n          height={outerHeight}\n          ref={this.svgRef}>\n          <g\n            id=\"zoom-wrapper\"\n            className={classnames('pipeline-zoom-wrapper', {\n              'pipeline-zoom-wrapper--hidden': !visibleGraph,\n            })}\n            ref={this.wrapperRef}>\n            <defs>\n              {[\n                'arrowhead',\n                'arrowhead--input',\n                'arrowhead--accent--input',\n                'arrowhead--accent',\n              ].map((id) => (\n                <marker\n                  id={`pipeline-${id}`}\n                  key={id}\n                  className={`pipeline-flowchart__${id}`}\n                  viewBox=\"0 0 10 10\"\n                  refX=\"7\"\n                  refY=\"5\"\n                  markerUnits=\"strokeWidth\"\n                  markerWidth=\"8\"\n                  markerHeight=\"6\"\n                  orient=\"auto\">\n                  <path d=\"M 0 0 L 10 5 L 0 10 L 4 5 z\" />\n                </marker>\n              ))}\n            </defs>\n            <g className=\"pipeline-flowchart__layers\" ref={this.layersRef} />\n            <g className=\"pipeline-flowchart__edges\" ref={this.edgesRef} />\n            <g\n              id=\"nodes\"\n              className=\"pipeline-flowchart__nodes\"\n              ref={this.nodesRef}\n            />\n          </g>\n        </svg>\n        <ul\n          className={classnames('pipeline-flowchart__layer-names', {\n            'pipeline-flowchart__layer-names--visible': layers.length,\n          })}\n          ref={this.layerNamesRef}\n        />\n        <Tooltip chartSize={chartSize} {...this.state.tooltip} />\n      </div>\n    );\n  }\n}\n\n// Fixed chart size used in tests\nexport const chartSizeTestFallback = {\n  left: 0,\n  top: 0,\n  right: 1280,\n  bottom: 1024,\n  width: 1280,\n  height: 1024,\n};\n\n// Maintain a single reference to support change detection\nconst emptyEdges = [];\nconst emptyNodes = [];\nconst emptyGraphSize = {};\n\nexport const mapStateToProps = (state, ownProps) => ({\n  clickedNode: state.node.clicked,\n  chartSize: getChartSize(state),\n  chartZoom: getChartZoom(state),\n  edges: state.graph.edges || emptyEdges,\n  graphSize: state.graph.size || emptyGraphSize,\n  hoveredParameters: state.hoveredParameters,\n  layers: getLayers(state),\n  linkedNodes: getLinkedNodes(state),\n  nodes: state.graph.nodes || emptyNodes,\n  nodeTypeDisabled: state.nodeType.disabled,\n  nodeActive: getNodeActive(state),\n  nodeSelected: getNodeSelected(state),\n  nodesWithInputParams: getNodesWithInputParams(state),\n  inputOutputDataNodes: getInputOutputNodesForFocusedModularPipeline(state),\n  inputOutputDataEdges: getInputOutputDataEdges(state),\n  visibleGraph: state.visible.graph,\n  visibleSidebar: state.visible.sidebar,\n  visibleCode: state.visible.code,\n  visibleMetaSidebar: getVisibleMetaSidebar(state),\n  focusMode: state.visible.modularPipelineFocusMode,\n  ...ownProps,\n});\n\nexport const mapDispatchToProps = (dispatch, ownProps) => ({\n  onLoadNodeData: (nodeClicked) => {\n    dispatch(loadNodeData(nodeClicked));\n  },\n  onToggleNodeHovered: (nodeHovered) => {\n    dispatch(toggleNodeHovered(nodeHovered));\n  },\n  onUpdateChartSize: (chartSize) => {\n    dispatch(updateChartSize(chartSize));\n  },\n  onUpdateZoom: (transform) => {\n    dispatch(updateZoom(transform));\n  },\n  ...ownProps,\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FlowChart);\n","import React from 'react';\nimport classnames from 'classnames';\nimport { connect } from 'react-redux';\nimport Dropdown from '@quantumblack/kedro-ui/lib/components/dropdown';\nimport MenuOption from '@quantumblack/kedro-ui/lib/components/menu-option';\nimport { loadPipelineData } from '../../actions/pipelines';\nimport { toggleFocusMode } from '../../actions';\nimport './pipeline-list.css';\n\n/**\n * A Dropdown displaying a list of selectable pipelines\n * @param {Object} pipeline Pipeline IDs, names, and active pipeline\n * @param {Function} onUpdateActivePipeline Handle updating the active pipeline\n * @param {Function} onToggleOpen Callback when opening/closing the dropdown\n * @param {string} theme Kedro UI light/dark theme\n */\nexport const PipelineList = ({\n  asyncDataSource,\n  onUpdateActivePipeline,\n  pipeline,\n  prettyName,\n  theme,\n  onToggleOpen,\n}) => {\n  if (!pipeline.ids.length && !asyncDataSource) {\n    return null;\n  }\n  return (\n    <div className=\"pipeline-list\">\n      <Dropdown\n        disabled={!pipeline.ids.length}\n        onOpened={() => onToggleOpen(true)}\n        onClosed={() => onToggleOpen(false)}\n        theme={theme}\n        width={null}\n        onChanged={onUpdateActivePipeline}\n        defaultText={\n          prettyName\n            ? pipeline.name[pipeline.active]\n            : pipeline.active || 'Default'\n        }>\n        {pipeline.ids.map((id) => (\n          <MenuOption\n            key={`pipeline-${id}`}\n            className={classnames({\n              'pipeline-list__option--active': pipeline.active === id,\n            })}\n            value={id}\n            primaryText={prettyName ? pipeline.name[id] : id}\n          />\n        ))}\n      </Dropdown>\n    </div>\n  );\n};\n\nexport const mapStateToProps = (state) => ({\n  asyncDataSource: state.dataSource === 'json',\n  pipeline: state.pipeline,\n  prettyName: state.prettyName,\n  theme: state.theme,\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onUpdateActivePipeline: (event) => {\n    dispatch(loadPipelineData(event.value));\n    dispatch(toggleFocusMode(null));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PipelineList);\n","import React, { useEffect, useRef } from 'react';\nimport SearchBar from '@quantumblack/kedro-ui/lib/components/search-bar';\nimport { connect } from 'react-redux';\n\n/**\n * Handle Node List Search\n * @param {function} onUpdateSearchValue Event handler\n * @param {string} searchValue Search text\n * @param {string} theme Light/dark theme for Kedro-UI component\n */\nexport const NodeListSearch = ({ onUpdateSearchValue, searchValue, theme }) => {\n  const container = useRef(null);\n\n  /**\n   * Focus search on CMD+F/CTRL+F, but only if not already focused, so that if\n   * you hit the shortcut again you will receive the default browser behaviour\n   * @param {object} event Keydown event\n   */\n  const handleWindowKeyDown = (event) => {\n    const isKeyF = event.key === 'f' || event.keyCode === 70;\n    const isKeyCtrlOrCmd = event.ctrlKey || event.metaKey;\n    if (isKeyF && isKeyCtrlOrCmd) {\n      const input = container.current.querySelector('input');\n      if (document.activeElement !== input) {\n        input.focus();\n        event.preventDefault();\n      } else {\n        input.blur();\n      }\n    }\n  };\n\n  /**\n   * Add window keydown event listener on mount, and remove on unmount\n   */\n  useEffect(() => {\n    window.addEventListener('keydown', handleWindowKeyDown);\n    return () => window.removeEventListener('keydown', handleWindowKeyDown);\n  });\n\n  /**\n   * Listen for keyboard events, and trigger relevant actions\n   * @param {number} keyCode The key event keycode\n   */\n  const handleKeyDown = (event) => {\n    const isKeyEscape = event.key === 'Escape' || event.keyCode === 27;\n    if (isKeyEscape) {\n      onUpdateSearchValue('');\n      container.current.querySelector('input').blur();\n    }\n  };\n\n  return (\n    <div\n      ref={container}\n      className=\"pipeline-nodelist-search\"\n      onKeyDown={handleKeyDown}>\n      <SearchBar\n        onChange={onUpdateSearchValue}\n        value={searchValue}\n        theme={theme}\n        placeholder={'Search'}\n      />\n    </div>\n  );\n};\n\nexport const mapStateToProps = (state) => ({\n  theme: state.theme,\n});\n\nexport default connect(mapStateToProps)(NodeListSearch);\n","import React from 'react';\n\nconst VisibleIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M11.5 5.706c4.142 0 7.5 4.662 7.5 5.625 0 .963-3.358 5.625-7.5 5.625-4.142 0-7.5-4.632-7.5-5.625 0-.993 3.358-5.625 7.5-5.625zm0 1.875a3.75 3.75 0 100 7.5 3.75 3.75 0 000-7.5zm0 1.875a1.875 1.875 0 110 3.75 1.875 1.875 0 010-3.75z\" />\n  </svg>\n);\n\nexport default VisibleIcon;\n","import React from 'react';\n\nconst InvisibleIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M17.97 5.3L19 6.33l-2 2.01c1.24 1.23 2 2.53 2 3 0 .95-3.36 5.62-7.5 5.62-.9 0-1.76-.22-2.55-.57L6.33 19 5.3 17.97 17.97 5.3zm-2.88 4.94l-1.9 1.9c-.18.39-.5.7-.88.88l-1.9 1.9a3.74 3.74 0 004.84-3.59c0-.38-.06-.74-.16-1.09zM11.5 5.71c1 0 1.95.27 2.83.7l-1.45 1.44a3.74 3.74 0 00-4.87 4.86l-1.8 1.81C4.83 13.24 4 11.82 4 11.33c0-1 3.36-5.63 7.5-5.63zm-.24 3.76L9.64 11.1c.11-.84.77-1.5 1.61-1.62z\" />\n  </svg>\n);\n\nexport default InvisibleIcon;\n","import React from 'react';\n\nconst FocusModeIcon = ({ className, checked }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\">\n    <g>\n      <path\n        d=\"M5 0L5 2 2 2 2 5 0 5 0 0z\"\n        transform=\"translate(-258 -194) translate(258 194) translate(6 6)\"\n      />\n      <path\n        d=\"M12 0L12 2 9 2 9 5 7 5 7 0z\"\n        transform=\"translate(-258 -194) translate(258 194) translate(6 6) rotate(90 9.5 2.5)\"\n      />\n      <path\n        d=\"M12 7L12 9 9 9 9 12 7 12 7 7z\"\n        transform=\"translate(-258 -194) translate(258 194) translate(6 6) rotate(-180 9.5 9.5)\"\n      />\n      <path\n        d=\"M5 7L5 9 2 9 2 12 0 12 0 7z\"\n        transform=\"translate(-258 -194) translate(258 194) translate(6 6) rotate(-90 2.5 9.5)\"\n      />\n    </g>\n  </svg>\n);\n\nexport default FocusModeIcon;\n","import React, { memo } from 'react';\nimport { connect } from 'react-redux';\nimport classnames from 'classnames';\nimport { changed } from '../../utils';\nimport NodeIcon from '../icons/node-icon';\nimport VisibleIcon from '../icons/visible';\nimport InvisibleIcon from '../icons/invisible';\nimport FocusModeIcon from '../icons/focus-mode';\nimport { getNodeActive } from '../../selectors/nodes';\n\n// The exact fixed height of a row as measured by getBoundingClientRect()\nexport const nodeListRowHeight = 37;\n\n/**\n * Returns `true` if there are no props changes, therefore the last render can be reused.\n * Performance: Checks only the minimal set of props known to change after first render.\n */\nconst shouldMemo = (prevProps, nextProps) =>\n  !changed(\n    [\n      'active',\n      'checked',\n      'allUnchecked',\n      'disabled',\n      'faded',\n      'focused',\n      'visible',\n      'selected',\n      'label',\n      'children',\n      'count',\n    ],\n    prevProps,\n    nextProps\n  );\n\nconst NodeListRow = memo(\n  ({\n    container: Container = 'div',\n    active,\n    checked,\n    allUnchecked,\n    children,\n    disabled,\n    faded,\n    focused,\n    visible,\n    id,\n    label,\n    count,\n    name,\n    kind,\n    onMouseEnter,\n    onMouseLeave,\n    onChange,\n    onClick,\n    selected,\n    type,\n    icon,\n    visibleIcon = VisibleIcon,\n    invisibleIcon = InvisibleIcon,\n    focusModeIcon = FocusModeIcon,\n    rowType,\n  }) => {\n    const VisibilityIcon =\n      type === 'modularPipeline'\n        ? focusModeIcon\n        : checked\n        ? visibleIcon\n        : invisibleIcon;\n    const isButton = onClick && kind !== 'filter';\n    const TextButton = isButton ? 'button' : 'div';\n\n    return (\n      <Container\n        className={classnames(\n          'pipeline-nodelist__row kedro',\n          `pipeline-nodelist__row--kind-${kind}`,\n          {\n            'pipeline-nodelist__row--visible': visible,\n            'pipeline-nodelist__row--active': active,\n            'pipeline-nodelist__row--selected': selected,\n            'pipeline-nodelist__row--disabled': disabled,\n            'pipeline-nodelist__row--unchecked': !checked,\n            'pipeline-nodelist__row--overwrite': !(active || selected),\n          }\n        )}\n        title={name}\n        onMouseEnter={visible ? onMouseEnter : null}\n        onMouseLeave={visible ? onMouseLeave : null}>\n        {icon && (\n          <NodeIcon\n            className={classnames(\n              'pipeline-nodelist__row__type-icon',\n              'pipeline-nodelist__row__icon',\n              {\n                'pipeline-nodelist__row__type-icon--faded': faded,\n                'pipeline-nodelist__row__type-icon--disabled': disabled,\n                'pipeline-nodelist__row__type-icon--nested': !children,\n                'pipeline-nodelist__row__type-icon--active': active,\n                'pipeline-nodelist__row__type-icon--selected': selected,\n              }\n            )}\n            icon={icon}\n          />\n        )}\n        <TextButton\n          className={classnames(\n            'pipeline-nodelist__row__text',\n            `pipeline-nodelist__row__text--kind-${kind}`,\n            `pipeline-nodelist__row__text--${rowType}`\n          )}\n          onClick={onClick}\n          onFocus={onMouseEnter}\n          onBlur={onMouseLeave}\n          title={children ? null : name}>\n          <span\n            className={classnames(\n              'pipeline-nodelist__row__label',\n              `pipeline-nodelist__row__label--kind-${kind}`,\n              {\n                'pipeline-nodelist__row__label--faded': faded,\n                'pipeline-nodelist__row__label--disabled': disabled,\n              }\n            )}\n            dangerouslySetInnerHTML={{ __html: label }}\n          />\n        </TextButton>\n        {typeof count === 'number' && (\n          <span onClick={onClick} className={'pipeline-nodelist__row__count'}>\n            {count}\n          </span>\n        )}\n        {VisibilityIcon && (\n          <label\n            htmlFor={id}\n            className={classnames(\n              'pipeline-row__toggle',\n              `pipeline-row__toggle--kind-${kind}`,\n              {\n                'pipeline-row__toggle--disabled': disabled,\n                'pipeline-row__toggle--selected': selected,\n              }\n            )}\n            onClick={(e) => e.stopPropagation()}>\n            <input\n              id={id}\n              className=\"pipeline-nodelist__row__checkbox\"\n              type=\"checkbox\"\n              checked={checked}\n              disabled={disabled}\n              name={name}\n              onChange={onChange}\n            />\n            <VisibilityIcon\n              aria-label={name}\n              checked={checked}\n              className={classnames(\n                'pipeline-nodelist__row__icon',\n                'pipeline-row__toggle-icon',\n                `pipeline-row__toggle-icon--kind-${kind}`,\n                {\n                  'pipeline-row__toggle-icon--parent': Boolean(children),\n                  'pipeline-row__toggle-icon--child': !children,\n                  'pipeline-row__toggle-icon--checked': checked,\n                  'pipeline-row__toggle-icon--unchecked': !checked,\n                  'pipeline-row__toggle-icon--all-unchecked': allUnchecked,\n                  'pipeline-row__toggle-icon--focus-checked': focused,\n                }\n              )}\n            />\n          </label>\n        )}\n        {children}\n      </Container>\n    );\n  },\n  shouldMemo\n);\n\nexport const mapStateToProps = (state, ownProps) => ({\n  ...ownProps,\n  active:\n    typeof ownProps.active !== 'undefined'\n      ? ownProps.active\n      : getNodeActive(state)[ownProps.id] || false,\n});\n\nexport default connect(mapStateToProps)(NodeListRow);\n","import { useState, useLayoutEffect, useRef, useMemo, useCallback } from 'react';\n\n/**\n * A component that renders only the children currently visible on screen.\n * Renders all children if not supported by browser or is disabled via the `lazy` prop.\n * @param {function} height A `function(start, end)` returning the pixel height for any given range of items\n * @param {number} total The total count of all items in the list\n * @param {function} children A `function(props)` rendering the list and items (see `childProps`)\n * @param {?number} [buffer=0.5] A number [0...1] as a % of the visible region to render additionally\n * @param {?boolean} [lazy=true] Toggles the lazy functionality\n * @param {?boolean} [dispose=false] Toggles disposing items when they lose visibility\n * @param {?function} onChange Optional change callback\n * @param {?function} container Optional, default scroll container is `element.offsetParent`\n * @return {object} The rendered children\n **/\nconst LazyList = ({\n  height,\n  total,\n  children,\n  lazy = true,\n  dispose = false,\n  buffer = 0.5,\n  onChange,\n  container = (element) => element?.offsetParent,\n}) => {\n  // Required browser feature checks\n  const supported = typeof window.IntersectionObserver !== 'undefined';\n\n  // Active only if supported and enabled else renders all children\n  const active = lazy && supported;\n\n  // The range of items currently rendered\n  const [range, setRange] = useState([0, 0]);\n  const rangeRef = useRef([0, 0]);\n\n  // List container element\n  const listRef = useRef();\n\n  // Upper placeholder element\n  const upperRef = useRef();\n\n  // Lower placeholder element\n  const lowerRef = useRef();\n\n  // Height of a single item\n  const itemHeight = useMemo(() => height(0, 1), [height]);\n\n  // Height of all items\n  const totalHeight = useMemo(() => height(0, total), [height, total]);\n\n  // Height of items above the rendered range\n  const upperHeight = useMemo(() => height(0, range[0]), [height, range]);\n\n  // Height of items below the rendered range\n  const lowerHeight = useMemo(\n    () => height(range[1], total),\n    [height, range, total]\n  );\n\n  // Allows an update only once per frame\n  const requestUpdate = useRequestFrameOnce(\n    // Memoise the frame callback\n    useCallback(() => {\n      // Get the range of items visible in this frame\n      const visibleRange = visibleRangeOf(\n        // The list container\n        listRef.current,\n        // The list's scrolling parent container\n        container(listRef.current),\n        buffer,\n        total,\n        itemHeight\n      );\n\n      // Merge ranges\n      const effectiveRange =\n        // If dispose, render visible range only\n        dispose\n          ? visibleRange\n          : // If not dispose, expand current range with visible range\n            rangeUnion(rangeRef.current, visibleRange);\n\n      // Avoid duplicate render calls as state is not set immediate\n      if (!rangeEqual(rangeRef.current, effectiveRange)) {\n        // Store the update in a ref immediately\n        rangeRef.current = effectiveRange;\n\n        // Apply the update in the next render\n        setRange(effectiveRange);\n      }\n    }, [buffer, total, itemHeight, dispose, container])\n  );\n\n  // Memoised observer options\n  const observerOptions = useMemo(\n    () => ({\n      // Create a threshold point for every item\n      threshold: thresholds(total),\n    }),\n    [total]\n  );\n\n  // Updates on changes in visibility at the given thresholds (intersection ratios)\n  useIntersection(listRef, observerOptions, requestUpdate);\n  useIntersection(upperRef, observerOptions, requestUpdate);\n  useIntersection(lowerRef, observerOptions, requestUpdate);\n\n  // Updates on changes in item dimensions\n  useLayoutEffect(\n    () => requestUpdate(),\n    [total, itemHeight, totalHeight, requestUpdate]\n  );\n\n  // Memoised child props for user to apply as needed\n  const childProps = useMemo(\n    () => ({\n      listRef,\n      upperRef,\n      lowerRef,\n      total,\n      start: active ? range[0] : 0,\n      end: active ? range[1] : total,\n      listStyle: {\n        // Relative for placeholder positioning\n        position: 'relative',\n        // List must always have the correct height\n        height: active ? totalHeight : undefined,\n        // List must always pad missing items (upper at least)\n        paddingTop: active ? upperHeight : undefined,\n      },\n      upperStyle: {\n        position: 'absolute',\n        display: !active ? 'none' : undefined,\n        height: upperHeight,\n        width: '100%',\n        // Upper placeholder must always snap to top edge\n        top: '0',\n      },\n      lowerStyle: {\n        position: 'absolute',\n        display: !active ? 'none' : undefined,\n        height: lowerHeight,\n        width: '100%',\n        // Lower placeholder must always snap to bottom edge\n        bottom: '0',\n      },\n    }),\n    [\n      active,\n      range,\n      total,\n      listRef,\n      upperRef,\n      lowerRef,\n      totalHeight,\n      upperHeight,\n      lowerHeight,\n    ]\n  );\n\n  // Optional change callback\n  onChange && onChange(childProps);\n\n  // Render the children\n  return children(childProps);\n};\n\n/**\n * Returns a range in the form `[start, end]` clamped inside `[min, max]`\n * @param {number} start The start of the range\n * @param {number} end The end of the range\n * @param {number} min The range minimum\n * @param {number} max The range maximum\n * @returns {array} The clamped range\n */\nexport const range = (start, end, min, max) => [\n  Math.max(Math.min(start, max), min),\n  Math.max(Math.min(end, max), min),\n];\n\n/**\n * Returns the union of both ranges\n * @param {array} rangeA The first range `[start, end]`\n * @param {array} rangeB The second range `[start, end]`\n * @returns {array} The range union\n */\nexport const rangeUnion = (rangeA, rangeB) => [\n  Math.min(rangeA[0], rangeB[0]),\n  Math.max(rangeA[1], rangeB[1]),\n];\n\n/**\n * Returns true if the ranges have the same `start` and `end` values\n * @param {array} rangeA The first range `[start, end]`\n * @param {array} rangeB The second range `[start, end]`\n * @returns {boolean} True if ranges are equal else false\n */\nexport const rangeEqual = (rangeA, rangeB) =>\n  rangeA[0] === rangeB[0] && rangeA[1] === rangeB[1];\n\n/**\n * Gets the range of items inside the container's screen bounds.\n * Assumes a single fixed height for all child items.\n * Only considers visibility along the vertical y-axis (i.e. only top, bottom bounds).\n * @param {HTMLElement} element The target element (e.g. list container)\n * @param {?HTMLElement} container The clipping container of the target (e.g. scroll container)\n * @param {number} buffer A number [0...1] as a % of the container to render additionally\n * @param {number} childTotal The total count of all children in the target (e.g. list row count)\n * @param {number} childHeight Height of a single child element (e.g. height of one list row)\n * @returns {array} The calculated range of visible items as `[start, end]`\n */\nconst visibleRangeOf = (\n  element,\n  container,\n  buffer,\n  childTotal,\n  childHeight\n) => {\n  // Check element exists\n  if (!element) {\n    return [0, 0];\n  }\n\n  // If no container use the element itself\n  if (!container) {\n    container = element;\n  }\n\n  // Find the clipping container bounds (e.g. scroll container)\n  const clip = container.getBoundingClientRect();\n\n  // Find element bounds (e.g. list container inside scroll container)\n  const list = element.getBoundingClientRect();\n\n  // Find the number of items to buffer\n  const bufferCount = Math.ceil((buffer * clip.height) / childHeight);\n\n  // When clip is fully above viewport or element is fully above clip\n  if (clip.bottom < 0 || list.bottom < clip.top) {\n    // Only bottom part of the buffer in range\n    return range(childTotal - bufferCount, childTotal, 0, childTotal);\n  }\n\n  // Get the viewport bounds\n  const viewport = {\n    top: 0,\n    bottom: window.innerHeight || document.documentElement.clientHeight,\n  };\n\n  // When clip is fully below viewport or element is fully below clip\n  if (clip.top > viewport.bottom || list.top > clip.bottom) {\n    // Only top part of the buffer in range\n    return range(0, bufferCount, 0, childTotal);\n  }\n\n  // Find intersection of clip and viewport now overlap guaranteed\n  const top = Math.max(clip.top, viewport.top);\n  const bottom = Math.min(clip.bottom, viewport.bottom);\n\n  // Find unbounded item range within the intersection\n  const start = Math.floor((top - list.top) / childHeight);\n  const end = Math.ceil((bottom - list.top) / childHeight);\n\n  // Apply buffer and clamp unbounded range to list bounds\n  return range(start - bufferCount, end + bufferCount, 0, childTotal);\n};\n\n/**\n * A hook to create a callback that runs once, at the end of the frame\n * @param {function} callback The callback\n * @returns {function} The wrapped callback\n */\nconst useRequestFrameOnce = (callback) => {\n  const request = useRef();\n\n  // Allow only a single callback per-frame\n  return useCallback(() => {\n    cancelAnimationFrame(request.current);\n    request.current = requestAnimationFrame(callback);\n  }, [request, callback]);\n};\n\n/**\n * Generates an array of the form [0, ...n / total]\n * except where total is `0` where it returns `[0]`.\n * @param {number} total The total number of thresholds to create\n * @returns {array} The threshold array\n */\nexport const thresholds = (total) =>\n  total === 0\n    ? [0]\n    : [...Array.from({ length: total }, (_, i) => i / total), 1];\n\n/**\n * A hook that creates and manages an IntersectionObserver for the given element\n * @param {object} element A React.Ref from the target element\n * @param {object} options An IntersectionObserver options object\n * @param {function} callback A function to call with IntersectionObserver changes\n */\nconst useIntersection = (element, options, callback) => {\n  const observer = useRef();\n\n  // After rendering and layout\n  return useLayoutEffect(() => {\n    // Check the element is ready\n    if (!element.current) {\n      return;\n    }\n\n    // Dispose any previous observer\n    if (observer.current) {\n      observer.current.disconnect();\n    }\n\n    // Create a new observer if supported\n    if (window.IntersectionObserver) {\n      observer.current = new window.IntersectionObserver(callback, options);\n      observer.current.observe(element.current);\n    }\n\n    // Manually callback as element may already be visible\n    callback();\n  }, [callback, element, options]);\n};\n\nexport default LazyList;\n","import React from 'react';\nimport modifiers from '../../utils/modifiers';\nimport NodeListRow, { nodeListRowHeight } from './node-list-row';\nimport LazyList from '../lazy-list';\n\nconst NodeRowList = ({\n  items = [],\n  group,\n  collapsed,\n  onItemClick,\n  onItemChange,\n  onItemMouseEnter,\n  onItemMouseLeave,\n}) => (\n  <LazyList\n    height={(start, end) => (end - start) * nodeListRowHeight}\n    total={items.length}>\n    {({\n      start,\n      end,\n      total,\n      listRef,\n      upperRef,\n      lowerRef,\n      listStyle,\n      upperStyle,\n      lowerStyle,\n    }) => (\n      <ul\n        ref={listRef}\n        style={listStyle}\n        className={modifiers(\n          'pipeline-nodelist__children',\n          { closed: collapsed },\n          'pipeline-nodelist__list pipeline-nodelist__list--nested'\n        )}>\n        <li\n          className={modifiers('pipeline-nodelist__placeholder-upper', {\n            fade: start !== end && start > 0,\n          })}\n          ref={upperRef}\n          style={upperStyle}\n        />\n        <li\n          className={modifiers('pipeline-nodelist__placeholder-lower', {\n            fade: start !== end && end < total,\n          })}\n          ref={lowerRef}\n          style={lowerStyle}\n        />\n        {items.slice(start, end).map((item) => (\n          <NodeListRow\n            container=\"li\"\n            key={item.id}\n            id={item.id}\n            kind={group.kind}\n            label={item.highlightedLabel}\n            count={item.count}\n            name={item.name}\n            type={item.type}\n            icon={item.icon}\n            active={item.active}\n            checked={item.checked}\n            disabled={item.disabled}\n            faded={item.faded}\n            visible={item.visible}\n            selected={item.selected}\n            allUnchecked={group.allUnchecked}\n            visibleIcon={item.visibleIcon}\n            invisibleIcon={item.invisibleIcon}\n            onClick={() => onItemClick(item)}\n            onMouseEnter={() => onItemMouseEnter(item)}\n            onMouseLeave={() => onItemMouseLeave(item)}\n            onChange={(e) => onItemChange(item, !e.target.checked)}\n            rowType=\"filter\"\n          />\n        ))}\n      </ul>\n    )}\n  </LazyList>\n);\n\nexport default NodeRowList;\n","import React from 'react';\nimport classnames from 'classnames';\nimport NodeListRow from './node-list-row';\nimport NodeRowList from './node-list-row-list';\n\nexport const NodeListGroup = ({\n  items,\n  group,\n  collapsed,\n  id,\n  name,\n  kind,\n  checked,\n  allUnchecked,\n  visibleIcon,\n  invisibleIcon,\n  onToggleChecked,\n  onToggleCollapsed,\n  onItemClick,\n  onItemChange,\n  onItemMouseEnter,\n  onItemMouseLeave,\n}) => (\n  <li\n    className={classnames(\n      'pipeline-nodelist__group',\n      `pipeline-nodelist__group--type-${id}`,\n      `pipeline-nodelist__group--kind-${kind}`,\n      {\n        'pipeline-nodelist__group--all-unchecked': allUnchecked,\n      }\n    )}>\n    <h3 className=\"pipeline-nodelist__heading\">\n      <NodeListRow\n        id={id}\n        kind={kind}\n        name={name}\n        label={name}\n        allUnchecked={allUnchecked}\n        checked={checked}\n        visibleIcon={visibleIcon}\n        invisibleIcon={invisibleIcon}\n        rowType=\"filter\"\n        onChange={(e) => {\n          onToggleChecked(id, !e.target.checked);\n        }}>\n        <button\n          aria-label={`${collapsed ? 'Show' : 'Hide'} ${name.toLowerCase()}`}\n          onClick={() => onToggleCollapsed(id)}\n          className={classnames('pipeline-type-group-toggle', {\n            'pipeline-type-group-toggle--alt': collapsed,\n          })}\n        />\n      </NodeListRow>\n    </h3>\n    <NodeRowList\n      items={items}\n      group={group}\n      collapsed={collapsed}\n      onItemClick={onItemClick}\n      onItemChange={onItemChange}\n      onItemMouseEnter={onItemMouseEnter}\n      onItemMouseLeave={onItemMouseLeave}\n    />\n  </li>\n);\n\nexport default NodeListGroup;\n","import React, { useState } from 'react';\nimport { loadState, saveState } from '../../store/helpers';\nimport NodeListGroup from './node-list-group';\n\nconst storedState = loadState();\n\nconst NodeListGroups = ({\n  items,\n  groups,\n  searchValue,\n  onGroupToggleChanged,\n  onItemClick,\n  onItemMouseEnter,\n  onItemMouseLeave,\n  onItemChange,\n}) => {\n  const [collapsed, setCollapsed] = useState(storedState.groupsCollapsed || {});\n\n  // Collapse/expand node group\n  const onToggleGroupCollapsed = (groupID) => {\n    const groupsCollapsed = {\n      ...collapsed,\n      [groupID]: !collapsed[groupID],\n    };\n\n    setCollapsed(groupsCollapsed);\n    saveState({ groupsCollapsed });\n  };\n\n  return (\n    <nav className=\"pipeline-nodelist-section kedro\">\n      <ul className=\"pipeline-nodelist__list\">\n        {Object.values(groups).map((group) => (\n          <NodeListGroup\n            group={group}\n            items={items[group.id] || []}\n            key={group.id}\n            id={group.id}\n            name={group.name}\n            kind={group.kind}\n            checked={group.checked}\n            allUnchecked={group.allUnchecked}\n            visibleIcon={group.visibleIcon}\n            invisibleIcon={group.invisibleIcon}\n            collapsed={Boolean(searchValue) ? false : collapsed[group.id]}\n            onToggleCollapsed={onToggleGroupCollapsed}\n            onToggleChecked={onGroupToggleChanged}\n            onItemClick={onItemClick}\n            onItemChange={onItemChange}\n            onItemMouseEnter={onItemMouseEnter}\n            onItemMouseLeave={onItemMouseLeave}\n          />\n        ))}\n      </ul>\n    </nav>\n  );\n};\n\nexport default NodeListGroups;\n","import { createSelector } from 'reselect';\nimport { getNodeDisabled } from './disabled';\nimport { arrayToObject } from '../utils';\n\nconst getNodeIDs = (state) => state.node.ids;\nconst getNodeType = (state) => state.node.type;\nexport const getNodeTypeIDs = (state) => state.nodeType.ids;\nconst getNodeTypeName = (state) => state.nodeType.name;\nconst getNodeTypeDisabled = (state) => state.nodeType.disabled;\nexport const isModularPipelineType = (type) => type === 'modularPipeline';\n\n/**\n * Calculate the total number of nodes (and the number of visible nodes)\n * for each node-type\n */\nexport const getTypeNodeCount = createSelector(\n  [getNodeTypeIDs, getNodeIDs, getNodeType, getNodeDisabled],\n  (types, nodeIDs, nodeType, nodeDisabled) =>\n    arrayToObject(types, (type) => {\n      const typeNodeIDs = nodeIDs.filter((nodeID) => nodeType[nodeID] === type);\n      const visibleTypeNodeIDs = typeNodeIDs.filter(\n        (nodeID) => !nodeDisabled[nodeID]\n      );\n      return {\n        total: typeNodeIDs.length,\n        visible: visibleTypeNodeIDs.length,\n      };\n    })\n);\n\n/**\n * Get formatted list of node type objects\n */\nexport const getNodeTypes = createSelector(\n  [getNodeTypeIDs, getNodeTypeName, getNodeTypeDisabled, getTypeNodeCount],\n  (types, typeName, typeDisabled, typeNodeCount) =>\n    types.map((id) => ({\n      id,\n      name: typeName[id],\n      disabled: typeDisabled[id],\n      nodeCount: typeNodeCount[id],\n    }))\n);\n","import React from 'react';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport TreeItem from '@material-ui/lab/TreeItem';\nimport NodeListRow from './node-list-row';\n\nconst arrowIconColor = '#8e8e90';\n\nconst NodeListTreeItem = ({\n  data,\n  onItemClick,\n  onItemMouseEnter,\n  onItemMouseLeave,\n  onItemChange,\n  children,\n}) => (\n  <TreeItem\n    key={data.id}\n    nodeId={data.id}\n    // this setup is to allow flexibility for adjusting the setting for individual arrow icons\n    collapseIcon={<ExpandMoreIcon style={{ color: arrowIconColor }} />}\n    expandIcon={<ChevronRightIcon style={{ color: arrowIconColor }} />}\n    label={\n      <NodeListRow\n        container=\"div\"\n        key={data.id}\n        id={data.id}\n        kind=\"element\"\n        label={data.highlightedLabel || data.name}\n        name={data.name}\n        icon={data.icon}\n        type={data.type}\n        active={data.active}\n        checked={data.checked}\n        disabled={data.disabled}\n        faded={data.faded}\n        visible={data.visible}\n        selected={data.selected}\n        allUnchecked={true}\n        visibleIcon={data.visibleIcon}\n        invisibleIcon={data.invisibleIcon}\n        focusModeIcon={data.focusModeIcon}\n        onClick={() => onItemClick(data)}\n        onMouseEnter={() => onItemMouseEnter(data)}\n        onMouseLeave={() => onItemMouseLeave(data)}\n        onChange={(e) => onItemChange(data, !e.target.checked)}\n        rowType=\"tree\"\n        focused={data.focused}\n      />\n    }>\n    {children}\n  </TreeItem>\n);\n\nexport default NodeListTreeItem;\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport TreeView from '@material-ui/lab/TreeView';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport noop from 'lodash.noop';\nimport sortBy from 'lodash.sortby';\n\nimport { getNodeSelected } from '../../selectors/nodes';\nimport { isModularPipelineType } from '../../selectors/node-types';\nimport NodeListTreeItem from './node-list-tree-item';\nimport VisibleIcon from '../icons/visible';\nimport InvisibleIcon from '../icons/invisible';\nimport FocusModeIcon from '../icons/focus-mode';\n\n// Display order of node groups\nconst GROUPED_NODES_DISPLAY_ORDER = {\n  modularPipeline: 0,\n  task: 1,\n  data: 2,\n  parameter: 3,\n};\n\n// please note that this setup is unique for initialization of the material-ui tree,\n// and setup is only used here and not anywhere else in the app.\nconst useStyles = makeStyles({\n  root: {\n    height: 110,\n    flexGrow: 1,\n    maxWidth: 400,\n  },\n});\n\nconst StyledTreeView = withStyles({\n  root: {\n    padding: '0 0 0 20px',\n  },\n})(TreeView);\n\n/**\n * Return whether the given modular pipeline ID is on focus mode path, i.e.\n * it's not the currently focused pipeline nor one of its children.\n * @param {String} focusModeID The currently focused modular pipeline ID.\n * @param {String} modularPipelineID The modular pipeline ID to check.\n * @return {Boolean} Whether the given modular pipeline ID is on focus mode path.\n */\nconst isOnFocusedModePath = (focusModeID, modularPipelineID) => {\n  return (\n    modularPipelineID === focusModeID ||\n    modularPipelineID.startsWith(`${focusModeID}.`)\n  );\n};\n\n/**\n * Return the data of a modular pipeline to display as a row in the node list.\n * @param {Object} params\n * @param {String} params.id The modular pipeline ID\n * @param {String} params.highlightedLabel The modular pipeline name with highlights when matched under search\n * @param {Object} params.data The modular pipeline data to display\n * @param {Boolean} params.disabled Whether the modular pipeline is disabled, e.g. when it's not the focused one\n * @param {Boolean} params.focused Whether the modular pipeline is the focused one in focus mode\n * @return {Object} The modular pipeline's data needed to render as a row in the node list tree.\n */\nconst getModularPipelineRowData = ({\n  id,\n  highlightedLabel,\n  data,\n  disabled,\n  focused,\n  focusModeIcon,\n}) => ({\n  id: id,\n  name: highlightedLabel || data.name,\n  type: 'modularPipeline',\n  icon: 'modularPipeline',\n  focusModeIcon: focusModeIcon,\n  active: false,\n  selected: false,\n  faded: false,\n  visible: true,\n  enabled: true,\n  disabled: disabled,\n  focused: focused,\n  checked: true,\n});\n\n/**\n * Return the data of a node to display as a row in the node list\n * @param {Object} node The node to display\n * @param {Boolean} selected Whether the node is currently disabled\n * @param {Boolean} selected Whether the node is currently selected\n */\nconst getNodeRowData = (node, disabled, selected) => {\n  const checked = !node.disabledNode;\n  return {\n    ...node,\n    visibleIcon: VisibleIcon,\n    invisibleIcon: InvisibleIcon,\n    active: node.active,\n    selected: selected,\n    faded: disabled || node.disabledNode,\n    visible: !disabled && checked,\n    checked,\n    disabled,\n  };\n};\n\nconst TreeListProvider = ({\n  nodeSelected,\n  modularPipelinesSearchResult,\n  modularPipelinesTree,\n  onItemChange,\n  onItemMouseEnter,\n  onItemMouseLeave,\n  onItemClick,\n  onNodeToggleExpanded,\n  focusMode,\n  expanded,\n}) => {\n  const classes = useStyles();\n\n  // render a leaf node in the modular pipelines tree\n  const renderLeafNode = (node) => {\n    const disabled =\n      node.disabledTag ||\n      node.disabledType ||\n      (focusMode &&\n        !node.modularPipelines\n          .map((modularPipelineID) =>\n            isOnFocusedModePath(focusMode.id, modularPipelineID)\n          )\n          .some(Boolean));\n    const selected = nodeSelected[node.id];\n    return (\n      <NodeListTreeItem\n        data={getNodeRowData(node, disabled, selected)}\n        onItemMouseEnter={onItemMouseEnter}\n        onItemMouseLeave={onItemMouseLeave}\n        onItemChange={onItemChange}\n        onItemClick={onItemClick}\n        key={node.id}\n      />\n    );\n  };\n\n  // recursively renders the modular pipeline tree\n  const renderTree = (tree, modularPipelineID) => {\n    // current tree node to render\n    const node = tree[modularPipelineID];\n    if (!node) {\n      return;\n    }\n\n    // render each child of the tree node first\n    const children = sortBy(\n      node.children,\n      (child) => GROUPED_NODES_DISPLAY_ORDER[child.type],\n      (child) => child.data.name\n    ).map((child) =>\n      isModularPipelineType(child.type)\n        ? renderTree(tree, child.id)\n        : renderLeafNode(child.data)\n    );\n\n    // then render the node itself wrapping around the children\n    // except when it's the root node,\n    // because we don't want to display the __root__ modular pipeline.\n    if (modularPipelineID === '__root__') {\n      return children;\n    }\n\n    const isFocusedModularPipeline = focusMode?.id === node.id;\n    let focusModeIcon;\n    if (!focusMode) {\n      focusModeIcon = FocusModeIcon;\n    } else {\n      focusModeIcon = isFocusedModularPipeline ? FocusModeIcon : null;\n    }\n\n    return (\n      <NodeListTreeItem\n        data={getModularPipelineRowData({\n          ...node,\n          focusModeIcon,\n          disabled: focusMode && !isOnFocusedModePath(focusMode.id, node.id),\n          focused: isFocusedModularPipeline,\n        })}\n        onItemMouseEnter={onItemMouseEnter}\n        onItemMouseLeave={onItemMouseLeave}\n        onItemChange={onItemChange}\n        onItemClick={noop}\n        key={node.id}>\n        {children}\n      </NodeListTreeItem>\n    );\n  };\n\n  const onItemExpandToggle = (event, expandedItemIds) => {\n    onNodeToggleExpanded(expandedItemIds);\n  };\n\n  return modularPipelinesSearchResult ? (\n    <StyledTreeView\n      className={classes.root}\n      expanded={Object.keys(modularPipelinesSearchResult)}\n      defaultCollapseIcon={<ExpandMoreIcon />}\n      defaultExpandIcon={<ChevronRightIcon />}\n      key=\"modularPipelinesSearchResult\">\n      {renderTree(modularPipelinesSearchResult, '__root__')}\n    </StyledTreeView>\n  ) : (\n    <StyledTreeView\n      expanded={expanded}\n      className={classes.root}\n      defaultCollapseIcon={<ExpandMoreIcon />}\n      defaultExpandIcon={<ChevronRightIcon />}\n      onNodeToggle={onItemExpandToggle}\n      key=\"modularPipelinesTree\">\n      {renderTree(modularPipelinesTree, '__root__')}\n    </StyledTreeView>\n  );\n};\n\nexport const mapStateToProps = (state) => ({\n  nodeSelected: getNodeSelected(state),\n  expanded: state.modularPipeline.expanded,\n});\n\nexport default connect(mapStateToProps)(TreeListProvider);\n","import { useState, useRef } from 'react';\n\n/**\n * Any React render function that returns elements, including those representing the container, panels and handle elements.\n * The state and props this function provides are expected to be applied these child elements to enable SplitPanel functionality.\n * See split-panel.test.js for a reference implementation.\n * @callback splitPanelRender\n * @param {object} state An object that contains a copy of the current split panel state and props intended for children\n * @param {boolean} state.isResizing Is `true` when the split is being actively moved, otherwise `false`\n * @param {number} state.split A number [0...1] as the current % split position\n * @param {object} state.props.container The props intended for the panel container element(s)\n * @param {object} state.props.panelA The props intended for the first panel descendent element(s)\n * @param {object} state.props.panelB The props intended for the second panel descendent element(s)\n * @param {object} state.props.handle The props intended for the handle descendent element(s)\n **/\n\n/**\n * A design agnostic user-resizable split panel controller.\n * Pass any React render function as this component's children and return your elements there.\n * See split-panel.test.js for a reference implementation.\n * @param {splitPanelRender} children Any React render function that returns elements including representing the container, panels, handle\n * @param {?number} [splitDefault=0.65] A number [0...1] as the default % split position\n * @param {?number} [splitMin=0] A number [0...1] as the minimum % split position\n * @param {?number} [splitMax=1] A number [0...1] as the maximum % split position\n * @param {?number} [keyboardStep=0.025] A number [0...1] as the % step to move split when using keyboard\n * @param {?string} [orientation='vertical'] Only 'vertical' currently supported\n **/\nexport const SplitPanel = ({\n  splitDefault = 0.65,\n  splitMin = 0,\n  splitMax = 1,\n  keyboardStep = 0.025,\n  orientation = 'vertical',\n  children,\n}) => {\n  const containerRef = useRef();\n  const handleRef = useRef();\n\n  const getRects = () => ({\n    container: containerRef.current?.getBoundingClientRect(),\n    handle: handleRef.current?.getBoundingClientRect(),\n  });\n\n  const clamp = (splitValue) => {\n    const rects = getRects();\n\n    const handleSize = rects.handle\n      ? rects.handle.height / rects.container.height\n      : 0;\n\n    if (splitValue < splitMin) {\n      return splitMin;\n    }\n\n    if (splitValue > splitMax - handleSize) {\n      return splitMax - handleSize;\n    }\n\n    return splitValue;\n  };\n\n  const [isResizing, setIsResizing] = useState(false);\n  const [split, setSplit] = useState(clamp(splitDefault));\n\n  const onMouse = (event) => {\n    if (event.type === 'mouseup') {\n      setIsResizing(false);\n      return;\n    }\n\n    if (isResizing || event.type === 'mousedown') {\n      const rects = getRects();\n\n      const mouseOffsetVertical =\n        (event.clientY - rects.container.top - rects.handle.height * 0.5) /\n        rects.container.height;\n\n      setIsResizing(true);\n      setSplit(clamp(mouseOffsetVertical));\n\n      event.preventDefault();\n    }\n  };\n\n  const onKey = (event) => {\n    const keyboardOffset =\n      {\n        ArrowUp: -keyboardStep,\n        ArrowLeft: -keyboardStep,\n        ArrowDown: keyboardStep,\n        ArrowRight: keyboardStep,\n      }[event.key] || 0;\n\n    if (keyboardOffset) {\n      setSplit(clamp(split + keyboardOffset));\n      event.preventDefault();\n    }\n  };\n\n  return children({\n    isResizing,\n    split,\n    props: {\n      container: {\n        ref: containerRef,\n        onMouseMove: onMouse,\n        onMouseUp: onMouse,\n      },\n      panelA: { style: { height: split * 100 + '%' } },\n      panelB: { style: { height: (1 - split) * 100 + '%' } },\n      handle: {\n        ref: handleRef,\n        role: 'separator',\n        'aria-orientation': orientation,\n        tabIndex: '0',\n        onMouseUp: onMouse,\n        onMouseDown: onMouse,\n        onKeyDown: onKey,\n      },\n    },\n  });\n};\n\nexport default SplitPanel;\n","import React from 'react';\nimport classnames from 'classnames';\nimport { Scrollbars } from 'react-custom-scrollbars';\nimport NodeListSearch from './node-list-search';\nimport NodeListGroups from './node-list-groups';\nimport NodeListTree from './node-list-tree';\nimport SplitPanel from '../split-panel';\nimport './styles/node-list.css';\n\n/**\n * Scrollable list of toggleable items, with search & filter functionality\n */\nconst NodeList = ({\n  faded,\n  items,\n  modularPipelinesTree,\n  modularPipelinesSearchResult,\n  groups,\n  searchValue,\n  getGroupState,\n  onUpdateSearchValue,\n  onGroupToggleChanged,\n  onItemClick,\n  onItemMouseEnter,\n  onItemMouseLeave,\n  onItemChange,\n  onModularPipelineToggleExpanded,\n  focusMode,\n}) => {\n  return (\n    <div\n      className={classnames('pipeline-nodelist', {\n        'pipeline-nodelist--fade': faded,\n      })}>\n      <NodeListSearch\n        onUpdateSearchValue={onUpdateSearchValue}\n        searchValue={searchValue}\n      />\n      <SplitPanel>\n        {({ isResizing, props: { container, panelA, panelB, handle } }) => (\n          <div\n            className={classnames('pipeline-nodelist__split', {\n              'pipeline-nodelist__split--resizing': isResizing,\n            })}\n            {...container}>\n            <div className=\"pipeline-nodelist__elements-panel\" {...panelA}>\n              <Scrollbars\n                className=\"pipeline-nodelist-scrollbars\"\n                style={{ width: 'auto' }}\n                autoHide\n                hideTracksWhenNotNeeded>\n                <div className=\"pipeline-nodelist-section\">\n                  <NodeListTree\n                    modularPipelinesSearchResult={modularPipelinesSearchResult}\n                    modularPipelinesTree={modularPipelinesTree}\n                    searchValue={searchValue}\n                    faded={faded}\n                    onItemClick={onItemClick}\n                    onItemMouseEnter={onItemMouseEnter}\n                    onItemMouseLeave={onItemMouseLeave}\n                    onItemChange={onItemChange}\n                    onNodeToggleExpanded={onModularPipelineToggleExpanded}\n                    focusMode={focusMode}\n                  />\n                </div>\n              </Scrollbars>\n            </div>\n            <div className=\"pipeline-nodelist__filter-panel\" {...panelB}>\n              <div className=\"pipeline-nodelist__split-handle\" {...handle} />\n              <Scrollbars\n                className=\"pipeline-nodelist-scrollbars\"\n                style={{ width: 'auto' }}\n                autoHide\n                hideTracksWhenNotNeeded>\n                <h2 className=\"pipeline-nodelist-section__title\">Filters</h2>\n                <NodeListGroups\n                  items={items}\n                  groups={groups}\n                  searchValue={searchValue}\n                  getGroupState={getGroupState}\n                  onItemClick={onItemClick}\n                  onItemMouseEnter={onItemMouseEnter}\n                  onItemMouseLeave={onItemMouseLeave}\n                  onItemChange={onItemChange}\n                  onGroupToggleChanged={onGroupToggleChanged}\n                />\n              </Scrollbars>\n            </div>\n          </div>\n        )}\n      </SplitPanel>\n    </div>\n  );\n};\n\nexport default NodeList;\n","import React from 'react';\n\nconst IndicatorIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <rect x=\"8.5\" y=\"9\" width=\"5\" height=\"5\" rx=\"1\" strokeWidth=\"1.5\" />\n  </svg>\n);\n\nexport default IndicatorIcon;\n","import React from 'react';\n\nconst OffIndicatorIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    {/* Note: some strokeWidth values fail when zoomed in Chrome e.g. 2 */}\n    <rect x=\"8.5\" y=\"9\" width=\"5\" height=\"5\" rx=\"1\" strokeWidth=\"1.9\" />\n  </svg>\n);\n\nexport default OffIndicatorIcon;\n","import React from 'react';\n\nconst PartialIndicatorIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <rect x=\"6.5\" y=\"10.5\" width=\"8\" height=\"1.5\" />\n  </svg>\n);\n\nexport default PartialIndicatorIcon;\n","import utils from '@quantumblack/kedro-ui/lib/utils';\nimport { createSelector } from 'reselect';\nimport { sidebarElementTypes, sidebarGroups } from '../../config';\nimport IndicatorIcon from '../icons/indicator';\nimport IndicatorOffIcon from '../icons/indicator-off';\nimport IndicatorPartialIcon from '../icons/indicator-partial';\nimport InvisibleIcon from '../icons/invisible';\nimport VisibleIcon from '../icons/visible';\nconst { escapeRegExp, getHighlightedText } = utils;\n\nexport const isTagType = (type) => type === 'tag';\nexport const isElementType = (type) => type === 'elementType';\nexport const isGroupType = (type) => isElementType(type) || isTagType(type);\n\n/**\n * Get a list of IDs of the visible nodes from all groups\n * @param {object} nodeGroups Grouped lists of nodes by type\n * @return {array} List of node IDs\n */\nexport const getNodeIDs = (nodeGroups) =>\n  Object.values(nodeGroups).flatMap((nodes) => nodes.map((node) => node.id));\n\n/**\n * Add a new highlightedLabel field to each of the node objects\n * @param {object} nodeGroups Grouped lists of nodes by type\n * @param {string} searchValue Search term\n * @return {object} The grouped nodes with highlightedLabel fields added\n */\nexport const highlightMatch = (nodeGroups, searchValue) => {\n  const highlightedGroups = {};\n\n  for (const type of Object.keys(nodeGroups)) {\n    highlightedGroups[type] = nodeGroups[type].map((node) => ({\n      ...node,\n      highlightedLabel: getHighlightedText(node.name, searchValue),\n    }));\n  }\n\n  return highlightedGroups;\n};\n\n/**\n * Check whether a node matches the search text or true if no search value given\n * @param {object} node\n * @param {string} searchValue\n * @return {boolean} True if node matches or no search value given\n */\nexport const nodeMatchesSearch = (node, searchValue) => {\n  if (searchValue) {\n    return new RegExp(escapeRegExp(searchValue), 'gi').test(node.name);\n  }\n\n  return true;\n};\n\n/**\n * Return only the results that match the search text\n * @param {object} nodeGroups Grouped lists of nodes by type\n * @param {string} searchValue Search term\n * @return {object} Grouped nodes\n */\nexport const filterNodeGroups = (nodeGroups, searchValue) => {\n  const filteredGroups = {};\n\n  for (const nodeGroupId of Object.keys(nodeGroups)) {\n    filteredGroups[nodeGroupId] = nodeGroups[nodeGroupId].filter((node) =>\n      nodeMatchesSearch(node, searchValue)\n    );\n  }\n\n  return filteredGroups;\n};\n\n/**\n * Return filtered/highlighted nodes, and filtered node IDs\n * @param {object} nodeGroups Grouped lists of nodes by type\n * @param {string} searchValue Search term\n * @return {object} Grouped nodes, and node IDs\n */\nexport const getFilteredNodes = createSelector(\n  [(state) => state.nodes, (state) => state.searchValue],\n  (nodeGroups, searchValue) => {\n    const filteredGroups = filterNodeGroups(nodeGroups, searchValue);\n    return {\n      filteredNodes: highlightMatch(filteredGroups, searchValue),\n      nodeIDs: getNodeIDs(filteredGroups),\n    };\n  }\n);\n\n/**\n * Return filtered/highlighted tags\n * @param {object} tags List of tags\n * @param {string} searchValue Search term\n * @return {object} Grouped tags\n */\nexport const getFilteredTags = createSelector(\n  [(state) => state.tags, (state) => state.searchValue],\n  (tags, searchValue) =>\n    highlightMatch(filterNodeGroups({ tag: tags }, searchValue), searchValue)\n);\n\n/**\n * Return filtered/highlighted tag list items\n * @param {object} filteredTags List of filtered tags\n * @return {array} Node list items\n */\nexport const getFilteredTagItems = createSelector(\n  [getFilteredTags, (state) => state.tagNodeCounts],\n  (filteredTags, tagNodeCounts = {}) => ({\n    tag: filteredTags.tag.map((tag) => ({\n      ...tag,\n      type: 'tag',\n      visibleIcon: IndicatorIcon,\n      invisibleIcon: IndicatorOffIcon,\n      active: false,\n      selected: false,\n      faded: false,\n      visible: true,\n      disabled: false,\n      checked: tag.enabled,\n      count: tagNodeCounts[tag.id] || 0,\n    })),\n  })\n);\n\n/**\n * Return filtered/highlighted element types\n * @param {string} searchValue Search term\n * @return {object} Grouped element types\n */\nexport const getFilteredElementTypes = createSelector(\n  [(state) => state.searchValue],\n  (searchValue) =>\n    highlightMatch(\n      filterNodeGroups(\n        {\n          elementType: Object.entries(sidebarElementTypes).map(\n            ([type, name]) => ({\n              id: type,\n              name,\n            })\n          ),\n        },\n        searchValue\n      ),\n      searchValue\n    )\n);\n\n/**\n * Return filtered/highlighted element type items\n * @param {object} filteredTags List of filtered element types\n * @param {array} nodeTypes List of node types\n * @return {object} Element type items\n */\nexport const getFilteredElementTypeItems = createSelector(\n  [getFilteredElementTypes, (state) => state.nodeTypes],\n  (filteredElementTypes, nodeTypes) => ({\n    elementType: filteredElementTypes.elementType.map((elementType) => {\n      const nodeType = nodeTypes.find((type) => type.id === elementType.id);\n\n      return {\n        ...elementType,\n        type: 'elementType',\n        visibleIcon: IndicatorIcon,\n        invisibleIcon: IndicatorOffIcon,\n        active: false,\n        selected: false,\n        faded: false,\n        visible: true,\n        disabled: false,\n        checked: nodeType.disabled === false,\n        count: nodeType.nodeCount.total,\n      };\n    }),\n  })\n);\n\n/**\n * Compares items for sorting in groups first\n * by enabled status (by tag) and then alphabeticaly (by name)\n * @param {object} itemA First item to compare\n * @param {object} itemB Second item to compare\n * @return {number} Comparison result\n */\nconst compareEnabledThenAlpha = (itemA, itemB) => {\n  const byEnabledTag = Number(itemA.disabledTag) - Number(itemB.disabledTag);\n  const byAlpha = itemA.name.localeCompare(itemB.name);\n  return byEnabledTag !== 0 ? byEnabledTag : byAlpha;\n};\n\n/**\n * Compares items for sorting in groups first\n * by enabled status (by tag) and then alphabeticaly (by name)\n * @param {object} itemA First item to compare\n * @param {object} itemB Second item to compare\n * @return {number} Comparison result\n */\nexport const getFilteredNodeItems = createSelector(\n  [\n    getFilteredNodes,\n    (state) => state.nodeSelected,\n    (state) => state.focusMode,\n    (state) => state.inputOutputDataNodes,\n  ],\n  ({ filteredNodes }, nodeSelected, focusMode, inputOutputDataNodes) => {\n    const filteredNodeItems = {};\n\n    for (const type of Object.keys(filteredNodes)) {\n      filteredNodeItems[type] = filteredNodes[type]\n        .map((node) => {\n          const checked = !node.disabledNode;\n          const disabled =\n            node.disabledTag ||\n            node.disabledType ||\n            (focusMode !== null && !!inputOutputDataNodes[node.id]);\n\n          return {\n            ...node,\n            visibleIcon: VisibleIcon,\n            invisibleIcon: InvisibleIcon,\n            active: undefined,\n            selected: nodeSelected[node.id],\n            faded: disabled || node.disabledNode,\n            visible: !disabled && checked,\n            checked,\n            disabled,\n          };\n        })\n        .sort(compareEnabledThenAlpha);\n    }\n\n    return filteredNodeItems;\n  }\n);\n\n/**\n * Returns group items for each sidebar filter group defined in the sidebar config.\n * @param {object} items List items by group type\n * @return {array} List of groups\n */\nexport const getGroups = createSelector([(state) => state.items], (items) => {\n  const groups = {};\n\n  for (const [type, name] of Object.entries(sidebarGroups)) {\n    const itemsOfType = items[type] || [];\n    const allUnchecked = itemsOfType.every((item) => !item.checked);\n    const allChecked = itemsOfType.every((item) => item.checked);\n\n    groups[type] = {\n      type,\n      name,\n      id: type,\n      kind: 'filter',\n      allUnchecked: itemsOfType.every((item) => !item.checked),\n      allChecked: itemsOfType.every((item) => item.checked),\n      checked: !allUnchecked,\n      visibleIcon: allChecked ? IndicatorIcon : IndicatorPartialIcon,\n      invisibleIcon: IndicatorOffIcon,\n    };\n  }\n\n  return groups;\n});\n\n/**\n * Returns filtered/highlighted items for nodes & tags\n * @param {object} filteredNodeItems List of filtered nodes\n * @param {object} filteredTagItems List of filtered tags\n * @param {object} getFilteredElementTypeItems List of filtered element type items\n * @return {array} final list of all filtered items from the three filtered item sets\n */\nexport const getFilteredItems = createSelector(\n  [getFilteredNodeItems, getFilteredTagItems, getFilteredElementTypeItems],\n  (filteredNodeItems, filteredTagItems, filteredElementTypeItems) => ({\n    ...filteredTagItems,\n    ...filteredNodeItems,\n    ...filteredElementTypeItems,\n  })\n);\n","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport utils from '@quantumblack/kedro-ui/lib/utils';\nimport debounce from 'lodash/debounce';\nimport NodeList from './node-list';\nimport {\n  getFilteredItems,\n  getGroups,\n  isTagType,\n  isElementType,\n  isGroupType,\n} from './node-list-items';\nimport {\n  getNodeTypes,\n  isModularPipelineType,\n} from '../../selectors/node-types';\nimport { getTagData, getTagNodeCounts } from '../../selectors/tags';\nimport {\n  getFocusedModularPipeline,\n  getModularPipelinesSearchResult,\n} from '../../selectors/modular-pipelines';\nimport {\n  getGroupedNodes,\n  getNodeSelected,\n  getInputOutputNodesForFocusedModularPipeline,\n  getModularPipelinesTree,\n} from '../../selectors/nodes';\nimport { toggleTagActive, toggleTagFilter } from '../../actions/tags';\nimport { toggleTypeDisabled } from '../../actions/node-type';\nimport { toggleParametersHovered, toggleFocusMode } from '../../actions';\nimport {\n  toggleModularPipelineActive,\n  toggleModularPipelineExpanded,\n} from '../../actions/modular-pipelines';\nimport {\n  loadNodeData,\n  toggleNodeHovered,\n  toggleNodesDisabled,\n} from '../../actions/nodes';\nimport './styles/node-list.css';\n\n/**\n * Provides data from the store to populate a NodeList component.\n * Also handles user interaction and dispatches updates back to the store.\n */\nconst NodeListProvider = ({\n  faded,\n  nodes,\n  nodeSelected,\n  tags,\n  tagNodeCounts,\n  nodeTypes,\n  onToggleNodesDisabled,\n  onToggleNodeSelected,\n  onToggleNodeActive,\n  onToggleParametersActive,\n  onToggleTagActive,\n  onToggleTagFilter,\n  onToggleModularPipelineActive,\n  onToggleModularPipelineExpanded,\n  onToggleTypeDisabled,\n  onToggleFocusMode,\n  modularPipelinesTree,\n  focusMode,\n  inputOutputDataNodes,\n}) => {\n  const [searchValue, updateSearchValue] = useState('');\n  const items = getFilteredItems({\n    nodes,\n    tags,\n    nodeTypes,\n    tagNodeCounts,\n    nodeSelected,\n    searchValue,\n    focusMode,\n    inputOutputDataNodes,\n  });\n\n  const modularPipelinesSearchResult = searchValue\n    ? getModularPipelinesSearchResult(modularPipelinesTree, searchValue)\n    : null;\n\n  const groups = getGroups({ items });\n\n  const onItemClick = (item) => {\n    if (isGroupType(item.type)) {\n      onGroupItemChange(item, item.checked);\n    } else if (!isModularPipelineType(item.tye)) {\n      if (item.faded || item.selected) {\n        onToggleNodeSelected(null);\n      } else {\n        onToggleNodeSelected(item.id);\n      }\n    }\n  };\n\n  const onItemChange = (item, checked) => {\n    if (isGroupType(item.type) || isModularPipelineType(item.type)) {\n      onGroupItemChange(item, checked);\n      if (isModularPipelineType(item.type)) {\n        if (focusMode === null) {\n          onToggleFocusMode(item);\n        } else {\n          onToggleFocusMode(null);\n        }\n      }\n    } else {\n      if (checked) {\n        onToggleNodeActive(null);\n      }\n      onToggleNodesDisabled([item.id], checked);\n    }\n  };\n\n  const onItemMouseEnter = (item) => {\n    if (isTagType(item.type)) {\n      onToggleTagActive(item.id, true);\n    } else if (isModularPipelineType(item.type)) {\n      onToggleModularPipelineActive(item.id, true);\n    } else if (isElementType(item.type) && item.id === 'parameters') {\n      // Show parameters highlight when mouse enter parameters filter item\n      onToggleParametersActive(true);\n    } else if (item.visible) {\n      onToggleNodeActive(item.id);\n    }\n  };\n\n  const onItemMouseLeave = (item) => {\n    if (isTagType(item.type)) {\n      onToggleTagActive(item.id, false);\n    } else if (isModularPipelineType(item.type)) {\n      onToggleModularPipelineActive(item.id, false);\n    } else if (isElementType(item.type) && item.id === 'parameters') {\n      // Hide parameters highlight when mouse leave parameters filter item\n      onToggleParametersActive(false);\n    } else if (item.visible) {\n      onToggleNodeActive(null);\n    }\n  };\n\n  const onGroupToggleChanged = (groupType) => {\n    // Enable all items in group if none enabled, otherwise disable all of them\n    const groupItems = items[groupType] || [];\n    const groupItemsDisabled = groupItems.every(\n      (groupItem) => !groupItem.checked\n    );\n\n    if (isTagType(groupType)) {\n      onToggleTagFilter(\n        groupItems.map((item) => item.id),\n        groupItemsDisabled\n      );\n    } else if (isElementType(groupType)) {\n      onToggleTypeDisabled(\n        groupItems.reduce(\n          (state, item) => ({ ...state, [item.id]: !groupItemsDisabled }),\n          {}\n        )\n      );\n    }\n  };\n\n  const onGroupItemChange = (item, wasChecked) => {\n    // Toggle the group\n    if (isTagType(item.type)) {\n      onToggleTagFilter(item.id, !wasChecked);\n    } else if (isElementType(item.type)) {\n      onToggleTypeDisabled({ [item.id]: wasChecked });\n    }\n\n    // Reset node selection\n    onToggleNodeSelected(null);\n    onToggleNodeActive(null);\n  };\n\n  // Deselect node on Escape key\n  const handleKeyDown = (event) => {\n    utils.handleKeyEvent(event.keyCode, {\n      escape: () => onToggleNodeSelected(null),\n    });\n  };\n  useEffect(() => {\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  });\n\n  return (\n    <NodeList\n      faded={faded}\n      items={items}\n      modularPipelinesTree={modularPipelinesTree}\n      modularPipelinesSearchResult={modularPipelinesSearchResult}\n      groups={groups}\n      searchValue={searchValue}\n      onUpdateSearchValue={debounce(updateSearchValue, 250)}\n      onModularPipelineToggleExpanded={onToggleModularPipelineExpanded}\n      onGroupToggleChanged={onGroupToggleChanged}\n      onItemClick={onItemClick}\n      onItemMouseEnter={onItemMouseEnter}\n      onItemMouseLeave={onItemMouseLeave}\n      onItemChange={onItemChange}\n      focusMode={focusMode}\n    />\n  );\n};\n\nexport const mapStateToProps = (state) => ({\n  tags: getTagData(state),\n  tagNodeCounts: getTagNodeCounts(state),\n  nodes: getGroupedNodes(state),\n  nodeSelected: getNodeSelected(state),\n  nodeTypes: getNodeTypes(state),\n  focusMode: getFocusedModularPipeline(state),\n  inputOutputDataNodes: getInputOutputNodesForFocusedModularPipeline(state),\n  modularPipelinesTree: getModularPipelinesTree(state),\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onToggleTagActive: (tagIDs, active) => {\n    dispatch(toggleTagActive(tagIDs, active));\n  },\n  onToggleTagFilter: (tagIDs, enabled) => {\n    dispatch(toggleTagFilter(tagIDs, enabled));\n  },\n  onToggleModularPipelineActive: (modularPipelineIDs, active) => {\n    dispatch(toggleModularPipelineActive(modularPipelineIDs, active));\n  },\n  onToggleTypeDisabled: (typeID, disabled) => {\n    dispatch(toggleTypeDisabled(typeID, disabled));\n  },\n  onToggleNodeSelected: (nodeID) => {\n    dispatch(loadNodeData(nodeID));\n  },\n  onToggleModularPipelineExpanded: (expanded) => {\n    dispatch(toggleModularPipelineExpanded(expanded));\n  },\n  onToggleNodeActive: (nodeID) => {\n    dispatch(toggleNodeHovered(nodeID));\n  },\n  onToggleParametersActive: (active) => {\n    dispatch(toggleParametersHovered(active));\n  },\n  onToggleNodesDisabled: (nodeIDs, disabled) => {\n    dispatch(toggleNodesDisabled(nodeIDs, disabled));\n  },\n  onToggleFocusMode: (modularPipeline) => {\n    dispatch(toggleFocusMode(modularPipeline));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NodeListProvider);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport './icon-button.css';\n\n/**\n * Icon button component\n */\nconst IconButton = ({\n  container: Container = 'li',\n  ariaLabel,\n  ariaLive,\n  className,\n  disabled,\n  icon,\n  labelText,\n  onClick,\n  visible,\n  active,\n}) => {\n  const Icon = icon;\n\n  return visible ? (\n    <Container>\n      <button\n        aria-label={ariaLabel}\n        aria-live={ariaLive}\n        className={classnames(className, {\n          'pipeline-icon-toolbar__button': true,\n          'pipeline-icon-toolbar__button--active': active,\n        })}\n        disabled={disabled}\n        onClick={onClick}>\n        {Icon && <Icon className=\"pipeline-icon\" />}\n        {labelText && (\n          <span className=\"pipeline-toolbar__label\">{labelText}</span>\n        )}\n      </button>\n    </Container>\n  ) : null;\n};\n\nIconButton.propTypes = {\n  ariaLabel: PropTypes.string,\n  ariaLive: PropTypes.string,\n  disabled: PropTypes.bool,\n  icon: PropTypes.func,\n  labelText: PropTypes.string,\n  onClick: PropTypes.func,\n  visible: PropTypes.bool,\n  active: PropTypes.bool,\n};\n\nIconButton.defaultProps = {\n  ariaLabel: null,\n  ariaLive: null,\n  disabled: false,\n  icon: null,\n  labelText: null,\n  onClick: null,\n  visible: true,\n  active: false,\n};\n\nexport default IconButton;\n","import React from 'react';\n\nconst MenuIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M15.3 3.3l1.4 1.4L9.4 12l7.3 7.3-1.4 1.4L6.6 12z\" />\n  </svg>\n);\n\nexport default MenuIcon;\n","import React from 'react';\n\nconst ThemeIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M12 3a9 9 0 110 18 9 9 0 010-18zm0 2v14a7 7 0 100-14z\" />\n  </svg>\n);\n\nexport default ThemeIcon;\n","import React from 'react';\n\nconst LabelIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M22 3v18H8.333L2 12l6.333-9H22zm-6.155 4h-3.69L10 17h1.944l.38-1.809h3.352l.38 1.809H18L15.845 7zm-1.507 1.676l.972 4.75h-2.62l.972-4.75h.676z\" />\n  </svg>\n);\n\nexport default LabelIcon;\n","import React from 'react';\n\nconst ExportIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M5 16v4h14v-4h2v4c0 1-.8 2-1.9 2H5a2 2 0 01-2-2v-4h2zm8-14v11l3.5-3.5L18 11l-6 6-6-6 1.5-1.5L11 13V2h2z\" />\n  </svg>\n);\n\nexport default ExportIcon;\n","import React from 'react';\n\nconst LayersIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M12 3l9 4.82-3.6 2.07 3.6 1.93-3.6 2.07 3.6 1.93L12 21l-9-5.18 3.6-1.93L3 11.82 6.6 9.9 3 7.82 12 3zM8.72 15.11l-1.45.78L12 18.6l4.73-2.72-1.45-.78L12 17l-3.28-1.89zm0-4l-1.45.78L12 14.6l4.73-2.72-1.45-.78L12 13l-3.28-1.89zM12 5.35L7.27 7.9 12 10.6l4.73-2.72L12 5.36z\" />\n  </svg>\n);\n\nexport default LayersIcon;\n","import React from 'react';\n\nconst SettingsIcon = ({ className }) => (\n  <svg className={className} viewBox=\"-4 -4 24 24\">\n    <g>\n      <path d=\"M14.75 7L16.25 7 16.5 10 14.5 10z\" />\n      <path d=\"M0.75 7L2.25 7 2.5 10 0.5 10z\" />\n      <path d=\"M7.75 0L9.25 0 9.5 3 7.5 3z\" />\n      <path d=\"M7.75 14L9.25 14 9.5 17 7.5 17z\" />\n      <path d=\"M12.7 2.05L14.2 2.05 14.45 5.05 12.45 5.05z\" />\n      <path d=\"M2.8 11.95L4.3 11.95 4.55 14.95 2.55 14.95z\" />\n      <path d=\"M2.8 2.05L4.3 2.05 4.55 5.05 2.55 5.05z\" />\n      <path d=\"M12.7 11.95L14.2 11.95 14.45 14.95 12.45 14.95z\" />\n      <path d=\"M15.5 8.389c0 3.866-3.134 7-7 7s-7-3.134-7-7 3.134-7 7-7 7 3.134 7 7zm-2 0c0-2.762-2.239-5-5-5s-5 2.238-5 5c0 2.761 2.239 5 5 5s5-2.239 5-5z\" />\n    </g>\n  </svg>\n);\n\nexport default SettingsIcon;\n","import React from 'react';\nimport classnames from 'classnames';\nimport { connect } from 'react-redux';\nimport {\n  toggleExportModal,\n  toggleSettingsModal,\n  toggleLayers,\n  toggleSidebar,\n  toggleTextLabels,\n  toggleTheme,\n} from '../../actions';\nimport IconButton from '../icon-button';\nimport MenuIcon from '../icons/menu';\nimport ThemeIcon from '../icons/theme';\nimport LabelIcon from '../icons/label';\nimport ExportIcon from '../icons/export';\nimport LayersIcon from '../icons/layers';\nimport SettingsIcon from '../icons/settings';\nimport { getVisibleLayerIDs } from '../../selectors/disabled';\nimport './primary-toolbar.css';\n\n/**\n * Main contols for filtering the chart data\n * @param {Function} onToggleTheme Handle toggling theme between light/dark\n * @param {Function} onToggleTextLabels Handle toggling text labels on/off\n * @param {Boolean} textLabels Whether text labels are displayed\n * @param {string} theme Kedro UI light/dark theme\n */\nexport const PrimaryToolbar = ({\n  disableLayerBtn,\n  onToggleExportModal,\n  onToggleSettingsModal,\n  onToggleLayers,\n  onToggleSidebar,\n  onToggleTextLabels,\n  onToggleTheme,\n  textLabels,\n  theme,\n  visible,\n  visibleLayers,\n}) => (\n  <>\n    <ul className=\"pipeline-primary-toolbar kedro\">\n      <IconButton\n        ariaLabel={`${visible.sidebar ? 'Hide' : 'Show'} menu`}\n        className={classnames(\n          'pipeline-menu-button',\n          'pipeline-menu-button--menu',\n          {\n            'pipeline-menu-button--inverse': !visible.sidebar,\n          }\n        )}\n        onClick={() => onToggleSidebar(!visible.sidebar)}\n        icon={MenuIcon}\n        labelText={`${visible.sidebar ? 'Hide' : 'Show'} menu`}\n      />\n      <IconButton\n        ariaLive=\"polite\"\n        ariaLabel={`Change to ${theme === 'light' ? 'dark' : 'light'} theme`}\n        className={'pipeline-menu-button--theme'}\n        onClick={() => onToggleTheme(theme === 'light' ? 'dark' : 'light')}\n        icon={ThemeIcon}\n        labelText=\"Toggle theme\"\n        visible={visible.themeBtn}\n      />\n      <IconButton\n        ariaLive=\"polite\"\n        className={'pipeline-menu-button--labels'}\n        onClick={() => onToggleTextLabels(!textLabels)}\n        icon={LabelIcon}\n        labelText={`${textLabels ? 'Hide' : 'Show'} text labels`}\n        visible={visible.labelBtn}\n      />\n      <IconButton\n        ariaLabel=\"Export graph as SVG or PNG\"\n        className={'pipeline-menu-button--export'}\n        onClick={() => onToggleExportModal(true)}\n        icon={ExportIcon}\n        labelText=\"Export visualisation\"\n        visible={visible.exportBtn}\n      />\n      <IconButton\n        ariaLabel={`Turn data layers ${visibleLayers ? 'off' : 'on'}`}\n        className={'pipeline-menu-button--layers'}\n        onClick={() => onToggleLayers(!visibleLayers)}\n        icon={LayersIcon}\n        labelText={`${visibleLayers ? 'Hide' : 'Show'} layers`}\n        disabled={disableLayerBtn}\n        visible={visible.layerBtn}\n      />\n      <IconButton\n        ariaLabel={'Change the settings flags'}\n        className={'pipeline-menu-button--settings'}\n        onClick={() => onToggleSettingsModal(true)}\n        icon={SettingsIcon}\n        disabled={false}\n        labelText={'Settings'}\n        visible={visible.settingsBtn}\n      />\n    </ul>\n  </>\n);\n\nexport const mapStateToProps = (state) => ({\n  disableLayerBtn: !state.layer.ids.length,\n  textLabels: state.textLabels,\n  theme: state.theme,\n  visible: state.visible,\n  visibleLayers: Boolean(getVisibleLayerIDs(state).length),\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onToggleExportModal: (value) => {\n    dispatch(toggleExportModal(value));\n  },\n  onToggleSettingsModal: (value) => {\n    dispatch(toggleSettingsModal(value));\n  },\n  onToggleLayers: (value) => {\n    dispatch(toggleLayers(Boolean(value)));\n  },\n  onToggleSidebar: (visible) => {\n    dispatch(toggleSidebar(visible));\n  },\n  onToggleTextLabels: (value) => {\n    dispatch(toggleTextLabels(Boolean(value)));\n  },\n  onToggleTheme: (value) => {\n    dispatch(toggleTheme(value));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PrimaryToolbar);\n","import React from 'react';\n\nconst MapIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M9.5 3l6 3.7 6-2.1v13.9l-6.2 3.3-6-3.8L3 20.4V5.3L9.5 3zm10 4.4l-3.1 1.2v10.3l3.2-1.6V7.4zm-9.1-1.5v10.4l4 2.5V8.4l-4-2.5zm-2-.4L5 6.7v10.8l3.4-1.3V5.5z\" />\n  </svg>\n);\n\nexport default MapIcon;\n","import React from 'react';\n\nconst PlusIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"m13 4v7h7v2h-7v7h-2v-7h-7v-2h7v-7z\" />\n  </svg>\n);\n\nexport default PlusIcon;\n","import React from 'react';\n\nconst MinusIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M19 13H5v-2h14z\" />\n  </svg>\n);\n\nexport default MinusIcon;\n","import React from 'react';\n\nconst ResetIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M8.5 4v5.5h-2V7.7A7 7 0 0012 19v2A9 9 0 015.3 6H3V4h5.5zM12 3a9 9 0 017.1 14.5h2.4v2H16V14h2v1.6A7 7 0 0012 5z\" />\n  </svg>\n);\n\nexport default ResetIcon;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { toggleMiniMap, updateZoom } from '../../actions';\nimport { getChartZoom } from '../../selectors/layout';\nimport IconButton from '../icon-button';\nimport MapIcon from '../icons/map';\nimport PlusIcon from '../icons/plus';\nimport MinusIcon from '../icons/minus';\nimport ResetIcon from '../icons/reset';\nimport './minimap-toolbar.css';\n\n/**\n * Controls for minimap\n */\nexport const MiniMapToolbar = ({\n  onToggleMiniMap,\n  visible,\n  chartZoom,\n  onUpdateChartZoom,\n}) => {\n  const { scale, minScale, maxScale } = chartZoom;\n\n  return (\n    <>\n      <ul className=\"pipeline-minimap-toolbar kedro\">\n        <IconButton\n          icon={MapIcon}\n          className={'pipeline-minimap-button pipeline-minimap-button--map'}\n          ariaLabel={`Turn minimap ${visible.miniMap ? 'off' : 'on'}`}\n          onClick={() => onToggleMiniMap(!visible.miniMap)}\n          labelText={`${visible.miniMap ? 'Hide' : 'Show'} minimap`}\n          visible={visible.miniMapBtn}\n          active={visible.miniMap}\n        />\n        <IconButton\n          icon={PlusIcon}\n          className={'pipeline-minimap-button pipeline-minimap-button--zoom-in'}\n          ariaLabel={'Zoom in'}\n          labelText={'Zoom in'}\n          visible={visible.miniMapBtn}\n          disabled={scale >= maxScale}\n          onClick={() => onUpdateChartZoom(scaleZoom(chartZoom, 1.3))}\n        />\n        <IconButton\n          icon={MinusIcon}\n          className={\n            'pipeline-minimap-button pipeline-minimap-button--zoom-out'\n          }\n          ariaLabel={'Zoom out'}\n          labelText={'Zoom out'}\n          visible={visible.miniMapBtn}\n          disabled={scale <= minScale}\n          onClick={() => onUpdateChartZoom(scaleZoom(chartZoom, 0.7))}\n        />\n        <IconButton\n          icon={ResetIcon}\n          className={'pipeline-minimap-button pipeline-minimap-button--reset'}\n          ariaLabel={'Reset zoom'}\n          labelText={'Reset zoom'}\n          visible={visible.miniMapBtn}\n          onClick={() => onUpdateChartZoom(scaleZoom(chartZoom, 0))}\n        />\n        <li>\n          <span className=\"pipeline-minimap-toolbar__scale\" title=\"Zoom level\">\n            {Math.round(100 * chartZoom.scale) || 100}%\n          </span>\n        </li>\n      </ul>\n    </>\n  );\n};\n\nconst scaleZoom = ({ scale }, factor) => ({\n  scale: scale * (factor || 1),\n  applied: false,\n  transition: true,\n  reset: factor === 0,\n});\n\nexport const mapStateToProps = (state) => ({\n  visible: state.visible,\n  chartZoom: getChartZoom(state),\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onToggleMiniMap: (value) => {\n    dispatch(toggleMiniMap(value));\n  },\n  onUpdateChartZoom: (transform) => {\n    dispatch(updateZoom(transform));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MiniMapToolbar);\n","import 'd3-transition';\n\nconst viewportMargin = 2;\n\n/**\n * Render viewport region\n */\nexport const drawViewport = function () {\n  const { mapSize } = this.props;\n  const { x, y, width, height } = this.getViewport();\n\n  const minX = Math.max(x, viewportMargin);\n  const minY = Math.max(y, viewportMargin);\n  const maxX = Math.min(x + width, mapSize.width - viewportMargin);\n  const maxY = Math.min(y + height, mapSize.height - viewportMargin);\n\n  this.el.viewport.enter().attr('x', 0).attr('y', 0);\n\n  this.el.viewport\n    .attr('transform', `translate(${minX}, ${minY})`)\n    .attr('width', Math.max(0, maxX - minX))\n    .attr('height', Math.max(0, maxY - minY));\n};\n\n/**\n * Render nodes\n */\nexport const drawNodes = function () {\n  const { clickedNode, linkedNodes, nodeActive, nodeSelected, nodes } =\n    this.props;\n\n  this.el.nodes = this.el.nodeGroup\n    .selectAll('.pipeline-minimap-node')\n    .data(nodes, (node) => node.id);\n\n  const enterNodes = this.el.nodes\n    .enter()\n    .append('g')\n    .attr('class', 'pipeline-minimap-node');\n\n  enterNodes\n    .attr('transform', (node) => `translate(${node.x}, ${node.y})`)\n    .attr('opacity', 0);\n\n  enterNodes.append('rect');\n\n  this.el.nodes\n    .exit()\n    .transition('exit-nodes')\n    .duration(this.DURATION)\n    .attr('opacity', 0)\n    .remove();\n\n  this.el.nodes = this.el.nodes\n    .merge(enterNodes)\n    .attr('data-id', (node) => node.id)\n    .classed('pipeline-minimap-node--active', (node) => nodeActive[node.id])\n    .classed('pipeline-minimap-node--selected', (node) => nodeSelected[node.id])\n    .classed(\n      'pipeline-minimap-node--faded',\n      (node) => clickedNode && !linkedNodes[node.id]\n    );\n\n  this.el.nodes\n    .transition('update-nodes')\n    .duration(this.DURATION)\n    .attr('opacity', 1)\n    .attr('transform', (node) => `translate(${node.x}, ${node.y})`)\n    .end()\n    .catch(() => {});\n\n  this.el.nodes\n    .select('rect')\n    .attr('width', (node) => node.width - sizeOffset(node))\n    .attr('height', (node) => node.height - sizeOffset(node))\n    .attr('x', (node) => (node.width - sizeOffset(node)) / -2)\n    .attr('y', (node) => (node.height - sizeOffset(node)) / -2);\n};\n\nconst sizeOffset = (node) => (node.type === 'task' ? 5 : 16);\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport 'd3-transition';\nimport { select } from 'd3-selection';\nimport { getNodeActive, getNodeSelected } from '../../selectors/nodes';\nimport { updateZoom } from '../../actions';\nimport { getChartSize, getChartZoom } from '../../selectors/layout';\nimport { getLinkedNodes } from '../../selectors/linked-nodes';\nimport {\n  viewing,\n  isOrigin,\n  viewTransformToFit,\n  getViewTransform,\n  setViewTransformExact,\n} from '../../utils/view';\nimport { drawNodes, drawViewport } from './draw';\nimport './styles/minimap.css';\n\n/**\n * Display a pipeline minimap, mostly rendered with D3\n */\nexport class MiniMap extends Component {\n  constructor(props) {\n    super(props);\n\n    this.DURATION = 700;\n    this.TRANSITION_WAIT = 200;\n    this.ZOOM_RATE = 0.0025;\n\n    this.isPointerDown = false;\n    this.isPointerInside = false;\n    this.lastTransitionTime = 0;\n\n    this.containerRef = React.createRef();\n    this.svgRef = React.createRef();\n    this.wrapperRef = React.createRef();\n    this.nodesRef = React.createRef();\n    this.viewportRef = React.createRef();\n\n    this.onPointerMove = this.onPointerMove.bind(this);\n    this.onPointerEnter = this.onPointerEnter.bind(this);\n    this.onPointerLeave = this.onPointerLeave.bind(this);\n    this.onPointerDown = this.onPointerDown.bind(this);\n    this.onPointerWheel = this.onPointerWheel.bind(this);\n    this.onPointerWheelGlobal = this.onPointerWheelGlobal.bind(this);\n    this.onPointerUpGlobal = this.onPointerUpGlobal.bind(this);\n  }\n\n  componentDidMount() {\n    this.selectD3Elements();\n\n    this.view = viewing({\n      container: this.svgRef,\n      wrapper: this.wrapperRef,\n      allowUserInput: false,\n    });\n\n    this.addGlobalEventListeners();\n    this.update();\n  }\n\n  componentWillUnmount() {\n    this.removeGlobalEventListeners();\n  }\n\n  /**\n   * Add window event listeners\n   */\n  addGlobalEventListeners() {\n    window.addEventListener('wheel', this.onPointerWheelGlobal, {\n      passive: false,\n    });\n    window.addEventListener(\n      pointerEventName('pointerup'),\n      this.onPointerUpGlobal\n    );\n  }\n\n  /**\n   * Remove window event listeners\n   */\n  removeGlobalEventListeners() {\n    window.removeEventListener('wheel', this.onPointerWheelGlobal);\n    window.removeEventListener(\n      pointerEventName('pointerup'),\n      this.onPointerUpGlobal\n    );\n  }\n\n  componentDidUpdate(prevProps) {\n    this.update(prevProps);\n  }\n\n  /**\n   * Updates drawing and zoom if props have changed\n   */\n  update(prevProps = {}) {\n    const { visible, chartZoom } = this.props;\n\n    if (visible) {\n      const changed = (...names) => this.changed(names, prevProps, this.props);\n\n      if (\n        changed(\n          'visible',\n          'nodes',\n          'clickedNodes',\n          'linkedNodes',\n          'nodesActive',\n          'nodeSelected'\n        )\n      ) {\n        drawNodes.call(this);\n      }\n\n      if (changed('visible', 'chartZoom') && chartZoom.applied) {\n        drawViewport.call(this);\n      }\n\n      if (changed('visible', 'nodes', 'textLabels', 'chartSize')) {\n        this.resetView();\n      }\n    }\n  }\n\n  /**\n   * Returns true if any of the given props are different between given objects.\n   * Only shallow changes are detected.\n   */\n  changed(props, objectA, objectB) {\n    return (\n      objectA &&\n      objectB &&\n      props.some((prop) => objectA[prop] !== objectB[prop])\n    );\n  }\n\n  /**\n   * Create D3 element selectors\n   */\n  selectD3Elements() {\n    this.el = {\n      svg: select(this.svgRef.current),\n      wrapper: select(this.wrapperRef.current),\n      nodeGroup: select(this.nodesRef.current),\n      viewport: select(this.viewportRef.current),\n    };\n  }\n\n  /**\n   * Handle pointer enter\n   */\n  onPointerEnter = () => {\n    this.isPointerInside = true;\n  };\n\n  /**\n   * Handle pointer leave\n   */\n  onPointerLeave = () => {\n    this.isPointerInside = false;\n  };\n\n  /**\n   * Handle global pointer up\n   */\n  onPointerUpGlobal = () => {\n    this.isPointerDown = false;\n    this.isPointerInside = false;\n  };\n\n  /**\n   * Handle pointer down\n   * @param {Object} event Event object\n   */\n  onPointerDown = (event) => {\n    this.isPointerDown = true;\n    this.isPointerInside = true;\n\n    this.onPointerMove(event, true);\n  };\n\n  /**\n   * Handle pointer wheel\n   * @param {Object} event Event object\n   */\n  onPointerWheel = (event) => {\n    // Change zoom based on wheel velocity\n    this.props.onUpdateChartZoom({\n      relative: true,\n      scale: -(event.deltaY || 0) * this.ZOOM_RATE,\n      applied: false,\n      transition: false,\n    });\n  };\n\n  /**\n   * Handle global pointer wheel\n   * @param {Object} event Event object\n   */\n  onPointerWheelGlobal = (event) => {\n    // Prevent window scroll when wheeling on this minimap\n    const wasTarget = this.containerRef.current.contains(event.target);\n    if (wasTarget) {\n      event.preventDefault();\n    }\n  };\n\n  /**\n   * Handle pointer move\n   * @param {Object} event Event object\n   * @param {?Boolean} useTransition Apply with transition\n   */\n  onPointerMove = (event, useTransition = false) => {\n    if (this.isPointerDown && this.isPointerInside) {\n      // Wait for transition\n      const time = Number(new Date());\n      if (time - this.lastTransitionTime < this.TRANSITION_WAIT) {\n        return;\n      }\n\n      // Get current state\n      const { scale: chartScale = 1 } = this.props.chartZoom;\n      const { width, height } = this.props.mapSize;\n      const { width: graphWidth, height: graphHeight } = this.props.graphSize;\n      const { k: scale = 1 } = getViewTransform(this.view);\n      const containerRect = this.svgRef.current.getBoundingClientRect();\n\n      // Transform minimap pointer position to a graph position\n      const pointerX = (event.clientX - containerRect.x) / scale;\n      const pointerY = (event.clientY - containerRect.y) / scale;\n      const centerX = (width / scale - graphWidth) * 0.5;\n      const centerY = (height / scale - graphHeight) * 0.5;\n      const x = (pointerX - centerX) * chartScale;\n      const y = (pointerY - centerY) * chartScale;\n\n      // Dispatch an update to be applied\n      this.props.onUpdateChartZoom({\n        x,\n        y,\n        scale: chartScale,\n        relative: false,\n        applied: false,\n        transition: useTransition,\n      });\n\n      if (useTransition) {\n        this.lastTransitionTime = time;\n      }\n    }\n  };\n\n  /**\n   * Zoom and scale to fit\n   */\n  resetView() {\n    const { graphSize, mapSize } = this.props;\n    const { width: mapWidth, height: mapHeight } = mapSize;\n    const { width: graphWidth, height: graphHeight } = graphSize;\n\n    // Skip if chart or graph is not ready yet\n    if (!mapWidth || !graphWidth) {\n      return;\n    }\n\n    // Padding offset\n    const offset = { x: padding * 0.5, y: padding * 0.5 };\n\n    // Find a transform that fits everything in view\n    const transform = viewTransformToFit({\n      offset,\n      viewWidth: mapWidth - padding,\n      viewHeight: mapHeight - padding,\n      objectWidth: graphWidth,\n      objectHeight: graphHeight,\n    });\n\n    // Detect first transform\n    const isFirstTransform = isOrigin(getViewTransform(this.view));\n\n    // Apply transform ignoring extents\n    setViewTransformExact(\n      this.view,\n      transform,\n      isFirstTransform ? 0 : this.DURATION,\n      false\n    );\n  }\n\n  /**\n   * Get the position of the viewport relative to the minimap\n   */\n  getViewport() {\n    const { chartZoom, chartSize } = this.props;\n    const {\n      k: mapScale,\n      x: translateX,\n      y: translateY,\n    } = getViewTransform(this.view);\n\n    const scale = mapScale / chartZoom.scale;\n    const width = chartSize.width * scale;\n    const height = chartSize.height * scale;\n    const x = -translateX - (chartZoom.x - chartSize.sidebarWidth) * scale;\n    const y = -translateY - chartZoom.y * scale;\n\n    return { x, y, width, height };\n  }\n\n  /**\n   * Render React elements\n   */\n  render() {\n    const { width, height } = this.props.mapSize;\n    const transformStyle = {\n      transform: `translate(calc(-100% + ${width}px), -100%)`,\n    };\n\n    // Add pointer events with back compatibility\n    const _ = pointerEventName;\n    const inputEvents = {\n      onWheel: this.onPointerWheel,\n      [_('onPointerEnter')]: this.onPointerEnter,\n      [_('onPointerLeave')]: this.onPointerLeave,\n      [_('onPointerDown')]: this.onPointerDown,\n      [_('onPointerMove')]: this.onPointerMove,\n    };\n\n    return (\n      <div\n        className=\"pipeline-minimap-container\"\n        style={this.props.visible ? transformStyle : {}}>\n        <div\n          className=\"pipeline-minimap kedro\"\n          ref={this.containerRef}\n          {...inputEvents}>\n          <svg\n            id=\"pipeline-minimap-graph\"\n            className=\"pipeline-minimap__graph\"\n            width={width}\n            height={height}\n            viewBox={`0 0 ${width} ${height}`}\n            ref={this.svgRef}>\n            <g id=\"zoom-wrapper\" ref={this.wrapperRef}>\n              <g\n                id=\"minimap-nodes\"\n                className=\"pipeline-minimap__nodes\"\n                ref={this.nodesRef}\n              />\n            </g>\n            <rect\n              className=\"pipeline-minimap__viewport\"\n              ref={this.viewportRef}\n            />\n          </svg>\n        </div>\n      </div>\n    );\n  }\n}\n\n// Map sizing constants\nconst padding = 32;\nconst height = 220;\nconst minWidth = 218;\nconst maxWidth = 1.5 * minWidth;\n\n/**\n * Convert pointer event name to a mouse event name if not supported\n */\nconst pointerEventName = (event) =>\n  window.PointerEvent\n    ? event\n    : event.replace('pointer', 'mouse').replace('Pointer', 'Mouse');\n\n/**\n * Gets the map sizing that fits the graph in state\n */\nconst getMapSize = (state) => {\n  const size = state.graph.size || {};\n  const graphWidth = size.width || 0;\n  const graphHeight = size.height || 0;\n\n  if (graphWidth > 0 && graphHeight > 0) {\n    // Constrain width\n    const scaledWidth = graphWidth * (height / graphHeight);\n    const width = Math.min(Math.max(scaledWidth, minWidth), maxWidth);\n\n    return { width, height };\n  }\n\n  // Use minimum size if no graph\n  return { width: minWidth, height: height };\n};\n\n// Maintain a single reference to support change detection\nconst emptyNodes = [];\nconst emptyGraphSize = {};\n\nexport const mapStateToProps = (state, ownProps) => ({\n  visible: state.visible.miniMap,\n  mapSize: getMapSize(state),\n  clickedNode: state.node.clicked,\n  chartSize: getChartSize(state),\n  chartZoom: getChartZoom(state),\n  graphSize: state.graph.size || emptyGraphSize,\n  nodes: state.graph.nodes || emptyNodes,\n  linkedNodes: getLinkedNodes(state),\n  nodeActive: getNodeActive(state),\n  nodeSelected: getNodeSelected(state),\n  textLabels: state.textLabels,\n  ...ownProps,\n});\n\nexport const mapDispatchToProps = (dispatch, ownProps) => ({\n  onUpdateChartZoom: (transform) => {\n    dispatch(updateZoom(transform));\n  },\n  ...ownProps,\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MiniMap);\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport classnames from 'classnames';\nimport PipelineList from '../pipeline-list';\nimport NodeList from '../node-list';\nimport PrimaryToolbar from '../primary-toolbar';\nimport MiniMapToolbar from '../minimap-toolbar';\nimport MiniMap from '../minimap';\nimport './sidebar.css';\n\n/**\n * Main app container. Handles showing/hiding the sidebar nav, and theme classes.\n * @param {boolean} props.visible Whether the sidebar is open/closed\n */\nexport const Sidebar = ({ visible }) => {\n  const [pipelineIsOpen, togglePipeline] = useState(false);\n\n  return (\n    <>\n      <div\n        className={classnames('pipeline-sidebar', {\n          'pipeline-sidebar--visible': visible,\n        })}>\n        <div className=\"pipeline-ui\">\n          <PipelineList onToggleOpen={togglePipeline} />\n          <NodeList faded={pipelineIsOpen} />\n        </div>\n        <nav className=\"pipeline-toolbar\">\n          <PrimaryToolbar />\n          <MiniMapToolbar />\n        </nav>\n        <MiniMap />\n      </div>\n    </>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  visible: state.visible.sidebar,\n});\n\nexport default connect(mapStateToProps)(Sidebar);\n","/* \nPlotly templates are defined to override user-specified styles with Kedro-viz styles\nMore details can be found here - https://plotly.com/python/templates/\n*/\n\n/* eslint-disable id-length,camelcase */\n\nconst darkTemplate = {\n  autosize: true,\n  annotationdefaults: {\n    arrowcolor: '#2a3f5f',\n    arrowhead: 0,\n    arrowwidth: 1,\n  },\n  autotypenumbers: 'strict',\n  coloraxis: {\n    autocolorscale: true,\n    colorbar: {\n      thickness: 20,\n      showticklabels: true,\n      ticks: 'outside',\n      tickwidth: 1,\n      tickcolor: 'rgba(255,255,255,0.30)',\n      ticklen: 12,\n      tickfont: {\n        color: 'rgba(255,255,255,0.55)',\n        size: 12,\n      },\n      ticklabelposition: 'outside',\n      title: {\n        font: {\n          color: 'rgba(255,255,255,0.55)',\n          size: 12,\n        },\n      },\n    },\n  },\n  colorscale: {\n    diverging: [\n      'rgb(230,59,90)',\n      'rgb(240,185,186)',\n      'rgb(237,212,213)',\n      'rgb(232,232,232)',\n      'rgb(190,213,236)',\n      'rgb(136,192,240)',\n      'rgb(0,169,244)',\n    ],\n    sequential: [\n      'rgb(0,169,244)',\n      'rgb(60,175,245)',\n      'rgb(148,203,250)',\n      'rgb(195,225,254)',\n      'rgb(214,235,255)',\n    ],\n    sequentialminus: [\n      'rgb(0,169,244)',\n      'rgb(60,175,245)',\n      'rgb(148,203,250)',\n      'rgb(195,225,254)',\n      'rgb(214,235,255)',\n    ],\n  },\n  colorway: [\n    '#00a9f4',\n    '#42459F',\n    '#F4973B',\n    '#E63B5A',\n    '#948DCA',\n    '#769D00',\n    '#1A2E91',\n    '#4F9596',\n    '#F7D02A',\n    '#F07179',\n    '#3C7A34',\n    '#B2DFE1',\n    '#C1BCE5',\n    '#AD544A',\n    '#F4973B',\n    '#B6CD70',\n    '#65A6A8',\n    '#F8E979',\n  ],\n  font: {\n    color: 'rgba(255,255,255,0.55)',\n  },\n  height: null,\n  hoverlabel: {\n    align: 'left',\n  },\n  hovermode: 'closest',\n  legend: {\n    title: {\n      font: {\n        color: 'rgba(255,255,255,0.55)',\n      },\n    },\n    font: {\n      color: 'rgba(255,255,255,0.55)',\n    },\n  },\n  mapbox: {\n    style: 'DARK',\n  },\n  paper_bgcolor: '#111111',\n  plot_bgcolor: '#111111',\n  title: {\n    font: {\n      color: 'rgba(255,255,255,0.85)',\n      size: 16,\n    },\n    xref: 'paper',\n    yref: 'paper',\n    x: 0,\n    xanchor: 'left',\n    yanchor: 'middle',\n  },\n  width: null,\n  xaxis: {\n    automargin: true,\n    gridcolor: 'rgba(255,255,255,0.12)',\n    layer: 'below traces',\n    linewidth: 1,\n    linecolor: 'rgba(255,255,255,0.30)',\n    rangemode: 'normal',\n    showline: true,\n    showticklabels: true,\n    ticks: 'outside',\n    tickwidth: 1,\n    tickcolor: 'rgba(255,255,255,0.30)',\n    ticklen: 12,\n    tickfont: {\n      color: 'rgba(255,255,255,0.55)',\n      size: 12,\n    },\n    ticklabelposition: 'outside',\n    title: {\n      font: {\n        color: 'rgba(255,255,255,0.55)',\n        size: 16,\n      },\n    },\n    zerolinecolor: 'rgba(255,255,255,0.30)',\n    zerolinewidth: 1,\n  },\n  yaxis: {\n    automargin: true,\n    gridcolor: 'rgba(255,255,255,0.12)',\n    layer: 'below traces',\n    linewidth: 1,\n    linecolor: 'rgba(255,255,255,0.30)',\n    rangemode: 'normal',\n    showline: true,\n    showticklabels: true,\n    ticks: 'outside',\n    tickwidth: 1,\n    tickcolor: 'rgba(255,255,255,0.30)',\n    ticklen: 12,\n    tickfont: {\n      color: 'rgba(255,255,255,0.55)',\n      size: 12,\n    },\n    ticklabelposition: 'outside',\n    title: {\n      font: {\n        color: 'rgba(255,255,255,0.55)',\n        size: 16,\n      },\n    },\n    zerolinecolor: 'rgba(255,255,255,0.30)',\n    zerolinewidth: 1,\n  },\n  margin: {\n    l: 72,\n    r: 40,\n    t: 64,\n    b: 72,\n  },\n};\n\nexport const darkPreviewTemplate = {\n  ...darkTemplate,\n  height: 300,\n  margin: {\n    l: 70,\n    r: 40,\n    t: 60,\n    b: 70,\n  },\n  title: {\n    font: {\n      size: 12,\n    },\n    x: 0.09,\n  },\n  showlegend: false,\n  width: 400,\n  xaxis: {\n    ...darkTemplate.xaxis,\n    title: {\n      ...darkTemplate.xaxis.title,\n      font: {\n        ...darkTemplate.xaxis.font,\n        size: 8,\n      },\n    },\n    tickfont: {\n      ...darkTemplate.xaxis.tickfont,\n      size: 8,\n    },\n    nticks: 5,\n  },\n  yaxis: {\n    ...darkTemplate.yaxis,\n    title: {\n      ...darkTemplate.yaxis.title,\n      font: {\n        ...darkTemplate.yaxis.font,\n        size: 8,\n      },\n    },\n    tickfont: {\n      ...darkTemplate.yaxis.tickfont,\n      size: 8,\n    },\n    nticks: 5,\n  },\n};\n\nexport const darkModalTemplate = {\n  ...darkTemplate,\n};\n","/*\nPlotly templates are defined to override user-specified styles with Kedro-viz styles\nMore details can be found here - https://plotly.com/python/templates/\n*/\n\n/* eslint-disable id-length,camelcase */\n\nconst lightTemplate = {\n  autosize: true,\n  annotationdefaults: {\n    arrowcolor: '#2a3f5f',\n    arrowhead: 0,\n    arrowwidth: 1,\n  },\n  autotypenumbers: 'strict',\n  coloraxis: {\n    autocolorscale: true,\n    colorbar: {\n      thickness: 20,\n      showticklabels: true,\n      ticks: 'outside',\n      tickwidth: 1,\n      tickcolor: 'rgba(0,0,0,0.30)',\n      ticklen: 12,\n      tickfont: {\n        color: 'rgba(0,0,0,0.55)',\n        size: 12,\n      },\n      ticklabelposition: 'outside',\n      title: {\n        font: {\n          color: 'rgba(0,0,0,0.55)',\n          size: 12,\n        },\n      },\n    },\n  },\n  colorscale: {\n    diverging: [\n      'rgb(230,59,90)',\n      'rgb(240,185,186)',\n      'rgb(237,212,213)',\n      'rgb(232,232,232)',\n      'rgb(190,213,236)',\n      'rgb(136,192,240)',\n      'rgb(0,169,244)',\n    ],\n    sequential: [\n      'rgb(0,169,244)',\n      'rgb(60,175,245)',\n      'rgb(148,203,250)',\n      'rgb(195,225,254)',\n      'rgb(214,235,255)',\n    ],\n    sequentialminus: [\n      'rgb(0,169,244)',\n      'rgb(60,175,245)',\n      'rgb(148,203,250)',\n      'rgb(195,225,254)',\n      'rgb(214,235,255)',\n    ],\n  },\n  colorway: [\n    '#00a9f4',\n    '#42459F',\n    '#F4973B',\n    '#E63B5A',\n    '#948DCA',\n    '#769D00',\n    '#1A2E91',\n    '#4F9596',\n    '#F7D02A',\n    '#F07179',\n    '#3C7A34',\n    '#B2DFE1',\n    '#C1BCE5',\n    '#AD544A',\n    '#F4973B',\n    '#B6CD70',\n    '#65A6A8',\n    '#F8E979',\n  ],\n  font: {\n    color: 'rgba(0,0,0,0.55)',\n  },\n  height: null,\n  hoverlabel: {\n    align: 'left',\n  },\n  hovermode: 'closest',\n  legend: {\n    title: {\n      font: {\n        color: 'rgba(0,0,0,0.55)',\n      },\n    },\n    font: {\n      color: 'rgba(0,0,0,0.55)',\n    },\n  },\n  mapbox: {\n    style: 'light',\n  },\n  paper_bgcolor: '#EEEEEE',\n  plot_bgcolor: '#EEEEEE',\n  title: {\n    font: {\n      color: 'rgba(0,0,0,0.85)',\n      size: 16,\n    },\n    xref: 'paper',\n    yref: 'paper',\n    x: 0,\n    xanchor: 'left',\n    yanchor: 'middle',\n  },\n  width: null,\n  xaxis: {\n    automargin: true,\n    gridcolor: 'rgba(0,0,0,0.12)',\n    layer: 'below traces',\n    linewidth: 1,\n    linecolor: 'rgba(0,0,0,0.30)',\n    rangemode: 'normal',\n    showline: true,\n    showticklabels: true,\n    ticks: 'outside',\n    tickwidth: 1,\n    tickcolor: 'rgba(0,0,0,0.30)',\n    ticklen: 12,\n    tickfont: {\n      color: 'rgba(0,0,0,0.55)',\n      size: 12,\n    },\n    ticklabelposition: 'outside',\n    title: {\n      font: {\n        color: 'rgba(0,0,0,0.55)',\n        size: 16,\n      },\n    },\n    zerolinecolor: 'rgba(0,0,0,0.30)',\n    zerolinewidth: 1,\n  },\n  yaxis: {\n    automargin: true,\n    gridcolor: 'rgba(0,0,0,0.12)',\n    layer: 'below traces',\n    linewidth: 1,\n    linecolor: 'rgba(0,0,0,0.30)',\n    rangemode: 'normal',\n    showline: true,\n    showticklabels: true,\n    ticks: 'outside',\n    tickwidth: 1,\n    tickcolor: 'rgba(0,0,0,0.30)',\n    ticklen: 12,\n    tickfont: {\n      color: 'rgba(0,0,0,0.55)',\n      size: 12,\n    },\n    ticklabelposition: 'outside',\n    title: {\n      font: {\n        color: 'rgba(0,0,0,0.55)',\n        size: 16,\n      },\n    },\n    zerolinecolor: 'rgba(0,0,0,0.30)',\n    zerolinewidth: 1,\n  },\n  margin: {\n    l: 72,\n    r: 40,\n    t: 64,\n    b: 72,\n  },\n};\n\nexport const lightPreviewTemplate = {\n  ...lightTemplate,\n  height: 300,\n  margin: {\n    l: 70,\n    r: 40,\n    t: 60,\n    b: 70,\n  },\n  showlegend: false,\n  width: 400,\n  title: {\n    font: {\n      size: 12,\n    },\n    x: 0.09,\n  },\n  xaxis: {\n    ...lightTemplate.xaxis,\n    title: {\n      ...lightTemplate.xaxis.title,\n      font: {\n        ...lightTemplate.xaxis.font,\n        size: 8,\n      },\n    },\n    tickfont: {\n      ...lightTemplate.xaxis.tickfont,\n      size: 8,\n    },\n    nticks: 5,\n  },\n  yaxis: {\n    ...lightTemplate.yaxis,\n    title: {\n      ...lightTemplate.yaxis.title,\n      font: {\n        ...lightTemplate.yaxis.font,\n        size: 8,\n      },\n    },\n    tickfont: {\n      ...lightTemplate.yaxis.tickfont,\n      size: 8,\n    },\n    nticks: 5,\n  },\n};\n\nexport const lightModalTemplate = {\n  ...lightTemplate,\n};\n","import React from 'react';\nimport createPlotlyComponent from 'react-plotly.js/factory';\nimport Plotly from 'plotly.js-cartesian-dist';\nimport deepmerge from 'deepmerge';\nimport { connect } from 'react-redux';\nimport './plotly-chart.css';\nimport {\n  darkPreviewTemplate,\n  darkModalTemplate,\n} from '../../utils/plot-templates/dark';\nimport {\n  lightPreviewTemplate,\n  lightModalTemplate,\n} from '../../utils/plot-templates/light';\n\n/**\n * Display plotly chart\n * @param {object} chartSize Chart dimensions in pixels\n * @param {object} targetRect event.target.getBoundingClientRect()\n * @param {boolean} visible Whether to show the tooltip\n * @param {string} text Tooltip display label\n */\n\nconst Plot = createPlotlyComponent(Plotly);\n\nconst PlotlyChart = ({ theme, view, data = [], layout = {} }) => {\n  const plotConfig = view === 'preview' ? { staticPlot: true } : undefined;\n\n  return (\n    <div className=\"pipeline-plotly-chart\">\n      <Plot\n        data={data}\n        layout={updateLayout(theme, view, layout)}\n        config={plotConfig}\n        style={{ width: '100%', height: '100%' }}\n        useResizeHandler={true}\n      />\n    </div>\n  );\n};\n\nconst updateLayout = (theme, view, layout) => {\n  if (theme === 'dark') {\n    if (view === 'modal') {\n      return deepmerge(layout, darkModalTemplate);\n    } else {\n      return deepmerge(layout, darkPreviewTemplate);\n    }\n  } else {\n    if (view === 'modal') {\n      return deepmerge(layout, lightModalTemplate);\n    } else {\n      return deepmerge(layout, lightPreviewTemplate);\n    }\n  }\n};\n\nconst mapStateToProps = (state) => ({\n  theme: state.theme,\n});\n\nexport default connect(mapStateToProps)(PlotlyChart);\n","import React from 'react';\n\nconst CopyIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M17 1v1h4v16h-4v4H3V6h4V2h4V1h6zM7 8H5v12h10v-2H7V8zm4-4H9v12h10V4h-2v1h-6V4z\" />\n  </svg>\n);\n\nexport default CopyIcon;\n","import React from 'react';\n\nconst CloseIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" />\n  </svg>\n);\n\nexport default CloseIcon;\n","import React from 'react';\n\nconst ExpandIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M21 5v16H5v-8h2v6h12V7h-6.116V5H21zM8 3v2H6.415l6.292 6.293-1.414 1.414L5 6.415V8H3V3h5z\" />\n  </svg>\n);\n\nexport default ExpandIcon;\n","import React from 'react';\nimport modifiers from '../../utils/modifiers';\nimport './styles/metadata.css';\n\n/**\n * Shows a metadata value\n */\nconst MetaDataValue = ({\n  container: Container = 'span',\n  className,\n  value,\n  kind,\n  empty,\n}) => (\n  <>\n    <Container\n      title={value}\n      className={modifiers('pipeline-metadata__value', { kind }, className)}>\n      {!value && value !== 0 ? empty : value}\n    </Container>\n  </>\n);\n\nexport default MetaDataValue;\n","import React, { useState, useEffect } from 'react';\nimport modifiers from '../../utils/modifiers';\nimport MetaDataValue from './metadata-value';\nimport './styles/metadata.css';\n\n/**\n * Shows a list of MetaDataValue\n */\nconst MetaDataList = ({\n  property,\n  values = [],\n  kind = 'text',\n  empty = '-',\n  inline = true,\n  commas = true,\n  limit = false,\n}) => {\n  const [expanded, setExpanded] = useState(false);\n  const showValues = !expanded && limit ? values.slice(0, limit) : values;\n  const remainder = values.length - showValues.length;\n\n  // Default to not expanded when values change\n  useEffect(() => setExpanded(false), [values]);\n\n  return values.length > 0 ? (\n    <>\n      <ul\n        className={modifiers('pipeline-metadata__value-list', {\n          inline,\n          commas,\n        })}>\n        {showValues.map((item, index) => (\n          <li key={index}>\n            <MetaDataValue\n              value={property ? item[property] : item}\n              kind={kind}\n              empty={empty}\n            />\n          </li>\n        ))}\n      </ul>\n      {remainder > 0 ? (\n        <button\n          className=\"pipeline-metadata__value-list-expand\"\n          aria-expanded={expanded}\n          onClick={() => setExpanded(true)}>\n          + {remainder} more\n        </button>\n      ) : null}\n    </>\n  ) : (\n    <MetaDataValue empty={empty} />\n  );\n};\n\nexport default MetaDataList;\n","/*\n * To apply custom theme to react-json-view objects, we need to follow thier base 16 theme styling guidelines\n * indicated here - https://github.com/chriskempson/base16/blob/master/styling.md and implemented below.\n */\n\nexport const darkjsonViewerTheme = {\n  base00: '#122531',\n  base01: '#122531',\n  base02: '#122531',\n  base03: '#122531',\n  base04: 'rgba(255,255,255,0.35)',\n  base05: '#122531',\n  base06: '#122531',\n  base07: 'rgba(255,255,255,0.85)',\n  base08: '#122531',\n  base09: '#ffbc00',\n  base0A: '#122531',\n  base0B: 'rgba(255,255,255,0.85)',\n  base0C: 'rgba(255,255,255,0.85)',\n  base0D: '#00b0f5',\n  base0E: '#dcc6e0',\n  base0F: 'rgba(255,255,255,0.85)',\n};\n\nexport const lightjsonViewerTheme = {\n  base00: '#f0f1f3',\n  base01: '#f0f1f3',\n  base02: '#f0f1f3',\n  base03: '#f0f1f3',\n  base04: 'rgba(0,0,0,0.55)',\n  base05: '#f0f1f3',\n  base06: '#f0f1f3',\n  base07: 'rgba(0,0,0,0.85)',\n  base08: '#f0f1f3',\n  base09: '#a000bc',\n  base0A: '#f0f1f3',\n  base0B: 'rgba(0,0,0,0.85)',\n  base0C: 'rgba(0,0,0,0.85)',\n  base0D: '#00b0f5',\n  base0E: '#7928a1',\n  base0F: 'rgba(0,0,0,0.85)',\n};\n","import React from 'react';\nimport modifiers from '../../utils/modifiers';\nimport './styles/metadata.css';\nimport ReactJson from 'react-json-view';\nimport {\n  darkjsonViewerTheme,\n  lightjsonViewerTheme,\n} from './metadata-parameters-theme';\n\n/**\n * Shows a metadata object\n */\nconst MetaDataObject = ({ className, value, kind, theme, empty }) => (\n  <div className={modifiers('pipeline-metadata__object', { kind }, className)}>\n    {Object.keys(value).length === 0 ? (\n      empty\n    ) : (\n      <ReactJson\n        theme={theme === 'dark' ? darkjsonViewerTheme : lightjsonViewerTheme}\n        name={false}\n        indentWidth={1}\n        collapsed={1}\n        collapseStringsAfterLength={true}\n        enableClipboard={true}\n        displayDataTypes={false}\n        src={value}\n      />\n    )}\n  </div>\n);\n\nexport default MetaDataObject;\n","import React from 'react';\nimport MetaDataList from './metadata-list';\nimport MetaDataObject from './metadata-object';\nimport MetaDataValue from './metadata-value';\nimport './styles/metadata.css';\n\n/**\n * Shows metadata label and a given single value, or a list of values, or child elements\n */\nconst MetaDataRow = ({\n  label,\n  theme,\n  property,\n  value,\n  kind = 'text',\n  empty = '-',\n  visible = true,\n  inline = true,\n  commas = true,\n  limit = false,\n  children,\n}) => {\n  const showList = Array.isArray(value);\n  const showObject = typeof value === 'object' && value !== null && !showList;\n  return (\n    visible && (\n      <>\n        <dt className=\"pipeline-metadata__label\">{label}</dt>\n        <dd className=\"pipeline-metadata__row\" data-label={label}>\n          {showList && (\n            <MetaDataList\n              property={property}\n              inline={inline}\n              commas={commas}\n              kind={kind}\n              empty={empty}\n              values={value}\n              limit={limit}\n            />\n          )}\n          {!showList && !showObject && !children && (\n            <MetaDataValue\n              value={value}\n              kind={kind}\n              empty={empty}\n              theme={theme}\n            />\n          )}\n          {showObject && (\n            <MetaDataObject\n              value={value}\n              kind={kind}\n              theme={theme}\n              empty={empty}\n            />\n          )}\n          {children}\n        </dd>\n      </>\n    )\n  );\n};\n\nexport default MetaDataRow;\n","import React, { useRef, useMemo } from 'react';\nimport { connect } from 'react-redux';\nimport hljs from 'highlight.js/lib/core';\nimport python from 'highlight.js/lib/languages/python';\nimport yaml from 'highlight.js/lib/languages/yaml';\nimport javascript from 'highlight.js/lib/languages/javascript';\nimport modifiers from '../../utils/modifiers';\nimport './styles/metadata-code.css';\n\nhljs.registerLanguage('python', python);\nhljs.registerLanguage('yaml', yaml);\nhljs.registerLanguage('javascript', javascript);\n\n/**\n * A highlighted code panel\n */\nexport const MetaDataCode = ({\n  sidebarVisible,\n  visible = true,\n  value = '',\n}) => {\n  const codeRef = useRef();\n\n  const highlighted = useMemo(() => {\n    const detected = hljs.highlightAuto(value);\n    const language = detected.language || detected.second_best.language;\n    return language ? hljs.highlight(value, { language }).value : value;\n  }, [value]);\n\n  return (\n    <div\n      className={modifiers(\n        'pipeline-metadata-code',\n        { visible, sidebarVisible },\n        'kedro'\n      )}>\n      <h2 className=\"pipeline-metadata-code__title\">Code block</h2>\n      <code className=\"pipeline-metadata-code__code\">\n        <pre ref={codeRef} dangerouslySetInnerHTML={{ __html: highlighted }} />\n      </code>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  sidebarVisible: state.visible.sidebar,\n});\n\nexport default connect(mapStateToProps)(MetaDataCode);\n","import React from 'react';\nimport classnames from 'classnames';\nimport modifiers from '../../utils/modifiers';\nimport './toggle.css';\n\n/**\n * Shows a toggle button for code panel\n */\nconst Toggle = ({\n  id = '',\n  checked,\n  enabled = true,\n  title,\n  onChange,\n  className = '',\n}) => (\n  <div\n    className={modifiers(classnames('pipeline-toggle', className), {\n      enabled,\n    })}>\n    <input\n      id={`pipeline-toggle-input-${id}`}\n      className=\"pipeline-toggle-input\"\n      type=\"checkbox\"\n      checked={checked}\n      disabled={!enabled}\n      onChange={onChange}\n    />\n    <label\n      className={modifiers('pipeline-toggle-label', {\n        checked: enabled && checked,\n      })}\n      htmlFor={`pipeline-toggle-input-${id}`}>\n      {title}\n    </label>\n  </div>\n);\n\nexport default Toggle;\n","import React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport modifiers from '../../utils/modifiers';\nimport NodeIcon from '../../components/icons/node-icon';\nimport IconButton from '../../components/icon-button';\nimport PlotlyChart from '../plotly-chart';\nimport CopyIcon from '../icons/copy';\nimport CloseIcon from '../icons/close';\nimport ExpandIcon from '../icons/expand';\nimport MetaDataRow from './metadata-row';\nimport MetaDataValue from './metadata-value';\nimport MetaDataCode from './metadata-code';\nimport Toggle from '../toggle';\nimport {\n  getVisibleMetaSidebar,\n  getClickedNodeMetaData,\n} from '../../selectors/metadata';\nimport { toggleNodeClicked } from '../../actions/nodes';\nimport { toggleCode, togglePlotModal } from '../../actions';\nimport getShortType from '../../utils/short-type';\nimport './styles/metadata.css';\n\n/**\n * Shows node meta data\n */\nconst MetaData = ({\n  visible = true,\n  metadata,\n  theme,\n  visibleCode,\n  onToggleCode,\n  onToggleNodeSelected,\n  onTogglePlotModal,\n}) => {\n  const [showCopied, setShowCopied] = useState(false);\n  // Hide code panel when selected metadata changes\n  useEffect(() => onToggleCode(false), [metadata, onToggleCode]);\n  const isTaskNode = metadata?.node.type === 'task';\n  const isDataNode = metadata?.node.type === 'data';\n  const isParametersNode = metadata?.node.type === 'parameters';\n  const nodeTypeIcon = getShortType(metadata?.datasetType, metadata?.node.type);\n  const hasPlot = Boolean(metadata?.plot);\n  const hasMetrics = Boolean(metadata?.metrics);\n  const hasCode = Boolean(metadata?.code);\n  const isTranscoded = Boolean(metadata?.originalType);\n  const showCodePanel = visible && visibleCode && hasCode;\n  const showCodeSwitch = hasCode;\n  let runCommand = metadata?.runCommand;\n  if (!runCommand) {\n    // provide a help text for user to know why the run command is not available for the task node\n    runCommand = isTaskNode\n      ? 'Please provide a name argument for this node in order to see a run command.'\n      : null;\n  }\n\n  const onCopyClick = () => {\n    window.navigator.clipboard.writeText(runCommand);\n    setShowCopied(true);\n    setTimeout(() => setShowCopied(false), 1500);\n  };\n\n  const onCloseClick = () => {\n    // Deselecting a node automatically hides MetaData panel\n    onToggleNodeSelected(null);\n  };\n\n  const onExpandPlotClick = () => {\n    onTogglePlotModal(true);\n  };\n\n  return (\n    <>\n      <MetaDataCode visible={showCodePanel} value={metadata?.code} />\n      <div className={modifiers('pipeline-metadata', { visible }, 'kedro')}>\n        {metadata && (\n          <>\n            <div className=\"pipeline-metadata__header-toolbox\">\n              <div className=\"pipeline-metadata__header\">\n                <NodeIcon\n                  className=\"pipeline-metadata__icon\"\n                  icon={nodeTypeIcon}\n                />\n                <h2 className=\"pipeline-metadata__title\">\n                  {metadata.node.name}\n                </h2>\n              </div>\n              <IconButton\n                container={React.Fragment}\n                ariaLabel=\"Close Metadata Panel\"\n                className={modifiers('pipeline-metadata__close-button', {\n                  hasCode,\n                })}\n                icon={CloseIcon}\n                onClick={onCloseClick}\n              />\n              {showCodeSwitch && (\n                <Toggle\n                  id=\"code\"\n                  checked={visibleCode}\n                  enabled={hasCode}\n                  title=\"Show Code\"\n                  onChange={(event) => {\n                    onToggleCode(event.target.checked);\n                  }}\n                />\n              )}\n            </div>\n            <div className=\"pipeline-metadata__list\">\n              <dl className=\"pipeline-metadata__properties\">\n                <MetaDataRow label=\"Type:\" value={metadata.node.type} />\n                {!isTranscoded && (\n                  <MetaDataRow\n                    label=\"Dataset Type:\"\n                    visible={isDataNode}\n                    kind=\"type\"\n                    value={metadata.datasetType}\n                  />\n                )}\n                {isTranscoded && (\n                  <>\n                    <MetaDataRow\n                      label=\"Original Type:\"\n                      visible={isDataNode}\n                      kind=\"type\"\n                      value={metadata.originalType}\n                    />\n                    <MetaDataRow\n                      label=\"Transcoded Types:\"\n                      visible={isDataNode}\n                      kind=\"type\"\n                      value={metadata.transcodedTypes}\n                    />\n                  </>\n                )}\n                <MetaDataRow\n                  label=\"File Path:\"\n                  kind=\"path\"\n                  value={metadata.filepath}\n                />\n                {hasMetrics && (\n                  <MetaDataRow\n                    label=\"Metrics from last run:\"\n                    theme={theme}\n                    visible={isDataNode}\n                    kind=\"metrics\"\n                    commas={false}\n                    inline={false}\n                    value={metadata.metrics}\n                  />\n                )}\n                <MetaDataRow\n                  label=\"Parameters:\"\n                  theme={theme}\n                  visible={isParametersNode || isTaskNode}\n                  kind=\"parameters\"\n                  commas={false}\n                  inline={false}\n                  value={metadata.parameters}\n                  limit={10}\n                />\n                <MetaDataRow\n                  label=\"Inputs:\"\n                  visible={isTaskNode}\n                  value={metadata.inputs}\n                />\n                <MetaDataRow\n                  label=\"Outputs:\"\n                  visible={isTaskNode}\n                  value={metadata.outputs}\n                />\n                <MetaDataRow\n                  label=\"Tags:\"\n                  kind=\"token\"\n                  commas={false}\n                  value={metadata.tags}\n                />\n                <MetaDataRow\n                  label=\"Pipeline:\"\n                  visible={Boolean(metadata.pipeline)}\n                  value={metadata.pipeline}\n                />\n                <MetaDataRow label=\"Run Command:\" visible={Boolean(runCommand)}>\n                  <div className=\"pipeline-metadata__toolbox-container\">\n                    <MetaDataValue\n                      container={'code'}\n                      className={modifiers(\n                        'pipeline-metadata__run-command-value',\n                        {\n                          visible: !showCopied,\n                        }\n                      )}\n                      value={runCommand}\n                    />\n                    {window.navigator.clipboard && metadata.runCommand && (\n                      <>\n                        <span\n                          className={modifiers(\n                            'pipeline-metadata__copy-message',\n                            {\n                              visible: showCopied,\n                            }\n                          )}>\n                          Copied to clipboard.\n                        </span>\n                        <ul className=\"pipeline-metadata__toolbox\">\n                          <IconButton\n                            ariaLabel=\"Copy run command to clipboard.\"\n                            className=\"pipeline-metadata__copy-button\"\n                            icon={CopyIcon}\n                            onClick={onCopyClick}\n                          />\n                        </ul>\n                      </>\n                    )}\n                  </div>\n                </MetaDataRow>\n              </dl>\n              {hasPlot && (\n                <>\n                  <div\n                    className=\"pipeline-metadata__plot\"\n                    onClick={onExpandPlotClick}>\n                    <PlotlyChart\n                      data={metadata.plot.data}\n                      layout={metadata.plot.layout}\n                      view=\"preview\"\n                    />\n                  </div>\n                  <button\n                    className=\"pipeline-metadata__expand-plot\"\n                    onClick={onExpandPlotClick}>\n                    <ExpandIcon className=\"pipeline-metadata__expand-plot-icon\"></ExpandIcon>\n                    <span className=\"pipeline-metadata__expand-plot-text\">\n                      Expand Plotly Visualization\n                    </span>\n                  </button>\n                </>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport const mapStateToProps = (state, ownProps) => ({\n  visible: getVisibleMetaSidebar(state),\n  metadata: getClickedNodeMetaData(state),\n  theme: state.theme,\n  visibleCode: state.visible.code,\n  ...ownProps,\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onToggleNodeSelected: (nodeID) => {\n    dispatch(toggleNodeClicked(nodeID));\n  },\n  onToggleCode: (visible) => {\n    dispatch(toggleCode(visible));\n  },\n  onTogglePlotModal: (visible) => {\n    dispatch(togglePlotModal(visible));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MetaData);\n","import downloadSvg, { downloadPng } from 'svg-crowbar';\n\n/**\n * Handle onClick for the SVG/PNG download button\n * @param {string} format Must be 'svg' or 'png'\n * @param {string} theme light/dark theme\n * @param {Object} graphSize Graph width/height/margin\n * @param {function} mockFn Mock testing function stand-in for svg-crowbar\n * @return {Function} onClick handler\n */\nconst exportGraph = ({ format, theme, graphSize, mockFn }) => {\n  const downloadFormats = {\n    png: downloadPng,\n    svg: downloadSvg,\n  };\n  const download = mockFn || downloadFormats[format];\n\n  // Create clone of graph SVG to avoid breaking the original\n  const svg = document.querySelector('#pipeline-graph');\n  const clone = svg.parentNode.appendChild(svg.cloneNode(true));\n  clone.classList.add('kedro', `kui-theme--${theme}`, 'pipeline-graph--export');\n\n  // Reset zoom/translate\n  let width, height;\n  const hasGraph = isFinite(graphSize.width) && isFinite(graphSize.height);\n  if (hasGraph) {\n    width = graphSize.width + graphSize.marginx * 2;\n    height = graphSize.height + graphSize.marginy * 2;\n    clone.setAttribute('viewBox', `0 0 ${width} ${height}`);\n  }\n  clone.querySelector('#zoom-wrapper').removeAttribute('transform');\n\n  // Impose a maximum size on PNGs because otherwise they break when downloading\n  if (format === 'png') {\n    const maxWidth = 5000;\n    width = Math.min(width, maxWidth);\n    height = Math.min(height, maxWidth * (height / width));\n  }\n  if (hasGraph) {\n    clone.setAttribute('width', width);\n    clone.setAttribute('height', height);\n  }\n\n  const style = document.createElement('style');\n  if (format === 'svg') {\n    // Add webfont\n    style.innerHTML =\n      '@import url(https://fonts.googleapis.com/css?family=Titillium+Web:400);';\n  } else {\n    // Add websafe fallback font\n    style.innerHTML = `.kedro {\n      font-family: \"Trebuchet MS\", \"Lucida Grande\", \"Lucida Sans Unicode\", \"Lucida Sans\", Tahoma, sans-serif;\n      letter-spacing: -0.4px;\n    }`;\n  }\n  clone.prepend(style);\n\n  // Download SVG/PNG\n  const options = format === 'svg' ? { css: 'internal' } : undefined;\n  download(clone, 'kedro-pipeline', options);\n\n  // Delete cloned SVG\n  svg.parentNode.removeChild(clone);\n};\n\nexport default exportGraph;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport Modal from '@quantumblack/kedro-ui/lib/components/modal';\nimport Button from '@quantumblack/kedro-ui/lib/components/button';\nimport { toggleExportModal } from '../../actions';\nimport exportGraph from './export-graph';\nimport './export-modal.css';\n\n/**\n * Kedro-UI modal to allow users to choose between SVG/PNG export formats\n */\nconst ExportModal = ({ graphSize, theme, onToggle, visible }) => {\n  if (!visible.exportBtn) {\n    return null;\n  }\n  return (\n    <Modal\n      title=\"Export pipeline visualisation\"\n      onClose={() => onToggle(false)}\n      theme={theme}\n      visible={visible.exportModal}>\n      <div className=\"pipeline-export-modal\">\n        <Button\n          theme={theme}\n          onClick={() => {\n            exportGraph({ format: 'png', theme, graphSize });\n            onToggle(false);\n          }}>\n          Download PNG\n        </Button>\n        <Button\n          theme={theme}\n          onClick={() => {\n            exportGraph({ format: 'svg', theme, graphSize });\n            onToggle(false);\n          }}>\n          Download SVG\n        </Button>\n      </div>\n    </Modal>\n  );\n};\n\nexport const mapStateToProps = (state) => ({\n  graphSize: state.graph.size || {},\n  visible: state.visible,\n  theme: state.theme,\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onToggle: (value) => {\n    dispatch(toggleExportModal(value));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ExportModal);\n","import React from 'react';\nimport Toggle from '../toggle';\n\n/**\n * Shows a list of MetaDataValue\n */\nconst SettingsModalRow = ({\n  id,\n  name,\n  toggleValue,\n  description,\n  onToggleChange,\n}) => (\n  <div className=\"pipeline-settings-modal__column\" key={id}>\n    <div className=\"pipeline-settings-modal__name\">{name}</div>\n    <Toggle\n      id={id}\n      className=\"pipeline-settings-modal__state\"\n      title={toggleValue ? 'On' : 'Off'}\n      checked={toggleValue}\n      onChange={onToggleChange}></Toggle>\n    <div className=\"pipeline-settings-modal__description\">{description}</div>\n  </div>\n);\n\nexport default SettingsModalRow;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport Modal from '@quantumblack/kedro-ui/lib/components/modal';\nimport {\n  changeFlag,\n  toggleSettingsModal,\n  togglePrettyName,\n} from '../../actions';\nimport { getFlagsState } from '../../utils/flags';\nimport SettingsModalRow from './settings-modal-row';\nimport { settings as settingsConfig } from '../../config';\nimport './settings-modal.css';\n\n/**\n * Kedro-UI modal to allow users to change the flag settings\n */\n\nconst SettingsModal = ({\n  theme,\n  prettyName,\n  onClose,\n  onToggleFlag,\n  onTogglePrettyName,\n  visible,\n  flags,\n}) => {\n  if (!visible.settingsBtn) {\n    return null;\n  }\n  const flagData = getFlagsState();\n  return (\n    <div className=\"pipeline-settings-modal\">\n      <Modal\n        title=\"Settings\"\n        theme={theme}\n        onClose={() => onClose(false)}\n        visible={visible.settingsModal}>\n        <div className=\"pipeline-settings-modal__content\">\n          <div className=\"pipeline-settings-modal__subtitle\">General</div>\n          <div className=\"pipeline-settings-modal__header\">\n            <div className=\"pipeline-settings-modal__name\">Name</div>\n            <div className=\"pipeline-settings-modal__state\">State</div>\n            <div className=\"pipeline-settings-modal__description\">\n              Description\n            </div>\n          </div>\n          <SettingsModalRow\n            id=\"prettyName\"\n            name={settingsConfig['prettyName'].name}\n            toggleValue={prettyName}\n            description={settingsConfig['prettyName'].description}\n            onToggleChange={(event) => onTogglePrettyName(event.target.checked)}\n          />\n          <div className=\"pipeline-settings-modal__subtitle\">Experiments</div>\n          {flagData.map(({ name, value, description }, index) => (\n            <SettingsModalRow\n              key={value}\n              id={value}\n              name={name}\n              toggleValue={flags[value]}\n              description={description}\n              onToggleChange={(event) =>\n                onToggleFlag(value, event.target.checked)\n              }\n            />\n          ))}\n        </div>\n      </Modal>\n    </div>\n  );\n};\n\nexport const mapStateToProps = (state) => ({\n  visible: state.visible,\n  theme: state.theme,\n  prettyName: state.prettyName,\n  flags: state.flags,\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onClose: (value) => {\n    dispatch(toggleSettingsModal(value));\n  },\n  onToggleFlag: (name, value) => {\n    dispatch(changeFlag(name, value));\n  },\n  onTogglePrettyName: (value) => {\n    dispatch(togglePrettyName(value));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SettingsModal);\n","import React from 'react';\n\nconst CollapseIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M21 3v18H3v-9.133h2V19h14V5h-7V3h9zm-16.293.293L11 9.586V8h2v5H8v-2h1.586L3.293 4.707l1.414-1.414z\" />\n  </svg>\n);\n\nexport default CollapseIcon;\n","import React from 'react';\n\nconst BackIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\">\n    <path d=\"M14.312 5.244c.387.336.454.905.172 1.318l-.071.093-3.574 4.122 31.684-.058c.552-.001 1 .446 1.002.998 0 .513-.385.936-.882.995l-.117.007-31.323.058 3.225 3.9c.326.395.298.967-.048 1.328l-.086.08c-.395.326-.967.298-1.328-.048l-.08-.086-5.326-6.443L12.9 5.345c.362-.417.994-.462 1.41-.1z\" />\n  </svg>\n);\n\nexport default BackIcon;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport PlotlyChart from '../plotly-chart';\nimport CollapseIcon from '../icons/collapse';\nimport BackIcon from '../icons/back';\nimport NodeIcon from '../../components/icons/node-icon';\nimport { togglePlotModal } from '../../actions';\nimport getShortType from '../../utils/short-type';\nimport { getClickedNodeMetaData } from '../../selectors/metadata';\nimport './plotly-modal.css';\n\nconst PlotlyModal = ({ metadata, onToggle, visible }) => {\n  const nodeTypeIcon = getShortType(metadata?.datasetType, metadata?.node.type);\n\n  const onCollapsePlotClick = () => {\n    onToggle(false);\n  };\n  if (!visible.plotModal) {\n    return null;\n  }\n  return (\n    <div className=\"pipeline-plotly-modal\">\n      <div className=\"pipeline-plot-modal__top\">\n        <button\n          className=\"pipeline-plot-modal__back\"\n          onClick={onCollapsePlotClick}>\n          <BackIcon className=\"pipeline-plot-modal__back-icon\"></BackIcon>\n          <span className=\"pipeline-plot-modal__back-text\">Back</span>\n        </button>\n        <div className=\"pipeline-plot-modal__header\">\n          <NodeIcon className=\"pipeline-plot-modal__icon\" icon={nodeTypeIcon} />\n          <span className=\"pipeline-plot-modal__title\">\n            {metadata.node.name}\n          </span>\n        </div>\n      </div>\n      <PlotlyChart\n        data={metadata.plot.data}\n        layout={metadata.plot.layout}\n        view=\"modal\"\n      />\n      <div className=\"pipeline-plot-modal__bottom\">\n        <button\n          className=\"pipeline-plot-modal__collapse-plot\"\n          onClick={onCollapsePlotClick}>\n          <CollapseIcon className=\"pipeline-plot-modal__collapse-plot-icon\"></CollapseIcon>\n          <span className=\"pipeline-plot-modal__collapse-plot-text\">\n            Collapse Plotly Visualization\n          </span>\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport const mapStateToProps = (state) => ({\n  visible: state.visible,\n  metadata: getClickedNodeMetaData(state),\n  theme: state.theme,\n});\n\nexport const mapDispatchToProps = (dispatch) => ({\n  onToggle: (value) => {\n    dispatch(togglePlotModal(value));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PlotlyModal);\n","import React from 'react';\nimport classnames from 'classnames';\nimport './loading.css';\n\nconst d =\n  'M11.4 90.3q-1.4-2.4 0-4.7l42.3-73.3q1.3-2.3 4-2.3h84.6q2.7 0 4 2.3l42.4 73.3q1.3 2.3 0 4.7l-42.3 73.2q-1.4 2.4-4.1 2.4H57.7q-2.7 0-4-2.4z';\n\nconst LoadingIcon = ({ className, visible }) => (\n  <svg\n    className={classnames(className, 'pipeline-loading-icon', {\n      'pipeline-loading-icon--visible': visible,\n    })}\n    viewBox=\"0 0 200 180\">\n    <path d={d} />\n    <path d={d} />\n  </svg>\n);\n\nexport default LoadingIcon;\n","import { createSelector } from 'reselect';\n\nconst getGraphLoading = (state) => state.loading.graph;\nconst getPipelineLoading = (state) => state.loading.pipeline;\nconst getFontLoading = (state) => !state.fontLoaded;\nconst getNodeLoading = (state) => state.loading.node;\n\nexport const getDisplayLargeGraph = (state) => state.ignoreLargeWarning;\n\n/**\n * Determine whether to show the loading spinner\n */\nexport const isLoading = createSelector(\n  [getGraphLoading, getPipelineLoading, getFontLoading, getNodeLoading],\n  (graphLoading, pipelineLoading, fontLoading, nodeLoading) => {\n    return graphLoading || pipelineLoading || fontLoading || nodeLoading;\n  }\n);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport classnames from 'classnames';\nimport LargePipelineWarning from '../large-pipeline-warning';\nimport FlowChart from '../flowchart';\nimport Sidebar from '../sidebar';\nimport MetaData from '../metadata';\nimport ExportModal from '../export-modal';\nimport SettingsModal from '../settings-modal';\nimport PlotlyModal from '../plotly-modal';\nimport LoadingIcon from '../icons/loading';\nimport { isLoading } from '../../selectors/loading';\nimport './wrapper.css';\n\n/**\n * Main app container. Handles showing/hiding the sidebar nav, and theme classes.\n */\nexport const Wrapper = ({ loading, theme }) => (\n  <div\n    className={classnames('kedro-pipeline kedro', {\n      'kui-theme--dark': theme === 'dark',\n      'kui-theme--light': theme === 'light',\n    })}>\n    <h1 className=\"pipeline-title\">Kedro-Viz</h1>\n    <Sidebar />\n    <MetaData />\n    <div className=\"pipeline-wrapper\">\n      <LargePipelineWarning />\n      <FlowChart />\n      <LoadingIcon className=\"pipeline-wrapper__loading\" visible={loading} />\n    </div>\n    <ExportModal />\n    <SettingsModal />\n    <PlotlyModal />\n  </div>\n);\n\nexport const mapStateToProps = (state) => ({\n  loading: isLoading(state),\n  theme: state.theme,\n});\n\nexport default connect(mapStateToProps)(Wrapper);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Provider } from 'react-redux';\nimport 'what-input';\nimport '@quantumblack/kedro-ui/lib/styles/app-no-webfont.css';\nimport LoadWebFont from '@quantumblack/kedro-ui/lib/utils/webfont.js';\nimport configureStore from '../../store';\nimport { resetData, updateFontLoaded } from '../../actions';\nimport { loadInitialPipelineData } from '../../actions/pipelines';\nimport Wrapper from '../wrapper';\nimport getInitialState, {\n  preparePipelineState,\n} from '../../store/initial-state';\nimport { getFlagsMessage } from '../../utils/flags';\nimport './app.css';\n\n/**\n * Entry-point component for the use-case where Kedro-Viz is imported as a\n * library/package into a larger application, rather than run as a standalone\n * app. If run as a standalone then 'Container' is the top-level component.\n *\n * This component intialises anything that might be needed in both use-cases,\n * e.g. the Redux store, webfont loading, announcing flags, etc.\n */\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    const initialState = getInitialState(props);\n    this.store = configureStore(initialState);\n  }\n\n  componentDidMount() {\n    if (this.props.data === 'json') {\n      this.store.dispatch(loadInitialPipelineData());\n    }\n    this.loadWebFonts();\n    this.announceFlags(this.store.getState().flags);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.data !== this.props.data) {\n      this.updatePipelineData();\n    }\n  }\n\n  /**\n   * Shows a console message regarding the given flags\n   */\n  announceFlags(flags) {\n    const message = getFlagsMessage(flags);\n\n    if (message && typeof jest === 'undefined') {\n      console.info(message);\n    }\n  }\n\n  /**\n   * Dispatch an action once the webfont has loaded.\n   * Uses https://github.com/typekit/webfontloader\n   */\n  loadWebFonts() {\n    const setFontLoaded = () => {\n      this.store.dispatch(updateFontLoaded(true));\n    };\n    LoadWebFont({\n      active: setFontLoaded,\n      inactive: setFontLoaded,\n    });\n  }\n\n  /**\n   * Dispatch an action to update the store with new pipeline data\n   */\n  updatePipelineData() {\n    const newState = preparePipelineState(this.props.data, true);\n    this.store.dispatch(resetData(newState));\n  }\n\n  render() {\n    return this.props.data ? (\n      <Provider store={this.store}>\n        <Wrapper />\n      </Provider>\n    ) : null;\n  }\n}\n\nApp.propTypes = {\n  /**\n   * Determines what pipeline data will be displayed on the chart.\n   * You can supply an object containing lists of edges, nodes, tags -\n   * See /src/utils/data for examples of the expected data format.\n   * Alternatively, the string 'json' indicates that data is being\n   * loaded asynchronously from /public/api/nodes.json\n   */\n  data: PropTypes.oneOfType([\n    PropTypes.oneOf(['json']),\n    PropTypes.shape({\n      edges: PropTypes.array.isRequired,\n      layers: PropTypes.array,\n      nodes: PropTypes.array.isRequired,\n      tags: PropTypes.array,\n    }),\n  ]),\n  /**\n   * Specify the theme: Either 'light' or 'dark'.\n   * If set, this will override the localStorage value.\n   */\n  theme: PropTypes.oneOf(['dark', 'light']),\n  /**\n   * Override visibility of various features, e.g. icon buttons\n   */\n  visible: PropTypes.shape({\n    labelBtn: PropTypes.bool,\n    layerBtn: PropTypes.bool,\n    exportBtn: PropTypes.bool,\n    settingsBtn: PropTypes.bool,\n    sidebar: PropTypes.bool,\n    themeBtn: PropTypes.bool,\n  }),\n};\n\nexport default App;\n","import seedrandom from 'seedrandom';\n\n/**\n * Generate a pseudo-random UUID\n * via https://stackoverflow.com/a/1349426/1651713\n * @param {number} length Hash/ID length\n * @return string\n */\nexport const generateHash = (length) => {\n  const result = [];\n  const characters =\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  for (let i = 0; i < length; i++) {\n    result.push(\n      characters.charAt(Math.floor(Math.random() * characters.length))\n    );\n  }\n  return result.join('');\n};\n\n/**\n * Seed data with a random hash, allowing it to be reproduced.\n * If the URL searchParams contain a 'seed' key then use its value,\n * else create a new one, and make it available via the console.\n */\nexport const getSeedFromURL = () => {\n  let url;\n  let seed;\n  try {\n    url = new URL(document.location.href);\n    seed = url.searchParams.get('seed');\n  } catch (e) {\n    console.warn('Random data seeding is not supported in this browser');\n    return;\n  }\n  if (!seed) {\n    seed = generateHash(30);\n    url.searchParams.set('seed', seed);\n  }\n  if (typeof jest === 'undefined') {\n    console.info(\n      `%cRandom data seed: ${seed}\\nTo reuse this layout, visit ${url.toString()}`,\n      'font-weight: bold'\n    );\n  }\n  return seed;\n};\n\n/**\n * Get an array of numbers\n * @param {number} length Length of the array\n */\nexport const getNumberArray = (length) => Array.from(Array(length).keys());\n\nexport const LOREM_IPSUM =\n  'lorem ipsum dolor sit amet consectetur adipiscing elit vestibulum id turpis nunc nulla vitae diam dignissim fermentum elit sit amet viverra libero quisque condimentum pellentesque convallis sed consequat neque ac rhoncus finibus'.split(\n    ' '\n  );\n\n/**\n * Utils that depend on a seeded RNG\n */\nconst randomUtils = () => {\n  // Set up seeded random number generator:\n  const seed = getSeedFromURL();\n  const random = seedrandom(seed);\n\n  /**\n   * Get a random number between 0 to n-1, inclusive\n   * @param {number} max Max number\n   */\n  const randomIndex = (max) => Math.floor(random() * max);\n\n  /**\n   * Get a random number between 1 to n, inclusive\n   * @param {number} max Max number\n   */\n  const randomNumber = (max) => Math.ceil(random() * max);\n\n  /**\n   * Get a random number between min and max, inclusive\n   * @param {number} (min) Min number\n   * @param {number} (max) Max number\n   */\n  const randomNumberBetween = (min, max) => randomNumber(max - min) + min;\n\n  /**\n   * Get a random datum from an array\n   * @param {Array} range The array to select a random item from\n   */\n  const getRandom = (range) => range[randomIndex(range.length)];\n\n  /**\n   * Generate a random latin name\n   * @param {number} numWords Number of words in the name\n   * @param {string} join The character(s) used to join each word\n   */\n  const getRandomName = (numWords, join = '_') =>\n    getNumberArray(numWords)\n      .map(() => getRandom(LOREM_IPSUM))\n      .join(join);\n\n  /**\n   * Randomly select a certain number (n) of items from an array (arr).\n   * via https://stackoverflow.com/a/19270021/1651713\n   * @param {array} arr List from which to choose\n   * @param {number} numItems Number of items to select\n   */\n  const getRandomSelection = (arr, numItems) => {\n    const result = new Array(numItems);\n    let len = arr.length;\n    const taken = new Array(len);\n    if (numItems > len) {\n      return arr;\n    }\n    while (numItems--) {\n      const x = Math.floor(random() * len);\n      result[numItems] = arr[x in taken ? taken[x] : x];\n      taken[x] = --len in taken ? taken[len] : len;\n    }\n    return result;\n  };\n\n  return {\n    random,\n    randomIndex,\n    randomNumber,\n    randomNumberBetween,\n    getRandom,\n    getRandomName,\n    getRandomSelection,\n  };\n};\n\nexport default randomUtils;\n","import batchingToposort from 'batching-toposort';\n\nimport { arrayToObject, unique } from './index';\nimport randomUtils, { getNumberArray } from './random-utils';\n\n//--- Config variables ---//\n\nconst MAX_EDGE_COUNT = 200;\nconst MIN_EDGE_COUNT = 100;\nconst MAX_RANK_COUNT = 50;\nconst MIN_RANK_COUNT = 10;\nconst MAX_RANK_NODE_COUNT = 10;\nconst MIN_RANK_NODE_COUNT = 1;\nconst MIN_NODE_DEGREE = 2;\nconst MAX_NODE_TAG_COUNT = 5;\nconst MAX_TAG_COUNT = 20;\nconst PARAMETERS_FREQUENCY = 0.2;\nconst MIN_PIPELINES_COUNT = 2;\nconst MAX_PIPELINES_COUNT = 15;\nconst LAYERS = [\n  'Raw',\n  'Intermediate',\n  'Primary',\n  'Feature',\n  'Model Input',\n  'Model Output',\n];\n\n/**\n * Generate a random pipeline dataset\n */\nclass Pipeline {\n  constructor() {\n    this.utils = randomUtils();\n    this.pipelines = this.generatePipelines();\n    this.rankCount = this.getRankCount();\n    this.rankLayers = this.getRankLayers();\n    this.tags = this.generateTags();\n    this.nodes = this.generateNodes();\n    this.edges = this.generateEdges();\n    this.modularPipelines = this.generateModularPipelines(this.nodes);\n\n    this.update();\n    this.finalise();\n  }\n\n  /**\n   * Create the pipelines array\n   * @returns {number} Rank count total\n   */\n  generatePipelines() {\n    const pipelines = ['Default'];\n    const pipelineCount = this.utils.randomNumberBetween(\n      MIN_PIPELINES_COUNT,\n      MAX_PIPELINES_COUNT\n    );\n    for (let i = 1; i < pipelineCount; i++) {\n      pipelines.push(this.utils.getRandomName(this.utils.randomNumber(4), ' '));\n    }\n    return pipelines.filter(unique);\n  }\n\n  /**\n   * Create the modular pipelines tree from nodes in the graph\n   * @returns {Object} A modular pipelines tree\n   */\n  generateModularPipelines(nodes) {\n    return {\n      __root__: {\n        id: '__root__',\n        name: 'Root',\n        children: nodes.map((node) => ({ id: node.id, type: node.type })),\n      },\n    };\n  }\n\n  /**\n   * Get the number of ranks (i.e. horizontal bands)\n   * Odd ranks are data, even are task\n   * @returns {number} Rank count total\n   */\n  getRankCount() {\n    let rankCount = this.utils.randomNumberBetween(\n      MIN_RANK_COUNT,\n      MAX_RANK_COUNT\n    );\n    // Ensure odd numbers only, so that we start and end with a data node\n    if (!rankCount % 2) {\n      rankCount += 1;\n    }\n    return rankCount;\n  }\n\n  /**\n   * Randomly determine the layer for each rank\n   * @returns {object} Layers by rank\n   */\n  getRankLayers() {\n    const layerSize = arrayToObject(LAYERS, () => 0);\n    // Randomly decide the number of ranks in each layer\n    for (let i = 0; i < this.rankCount; i++) {\n      layerSize[this.utils.getRandom(LAYERS)]++;\n    }\n    // Assign layers to ranks based on layerSize\n    const rankLayers = {};\n    for (let rank = 0, layer = 0; rank < this.rankCount; rank++) {\n      while (layerSize[LAYERS[layer]] < 1) {\n        layer++;\n      }\n      rankLayers[rank] = LAYERS[layer];\n      layerSize[LAYERS[layer]]--;\n    }\n    return rankLayers;\n  }\n\n  /**\n   * Generate a random list of tags\n   * @returns {array} Tag name strings\n   */\n  generateTags() {\n    const tagCount = this.utils.randomNumber(MAX_TAG_COUNT);\n    return getNumberArray(tagCount)\n      .map(() =>\n        this.utils.getRandomName(this.utils.randomNumber(MAX_NODE_TAG_COUNT))\n      )\n      .filter(unique);\n  }\n\n  /**\n   * Create list of nodes\n   * @returns {array} List of node objects\n   */\n  generateNodes() {\n    const nodes = [];\n    for (let rank = 0; rank < this.rankCount; rank++) {\n      const rankNodeCount = this.getRankNodeCount(rank);\n      for (let i = 0; i < rankNodeCount; i++) {\n        const node = this.createNode(i, rank);\n        nodes.push(node);\n      }\n    }\n    return nodes;\n  }\n\n  /**\n   * Return a random count of nodes for a rank\n   * @returns {number} rank node count\n   */\n  getRankNodeCount() {\n    return Math.min(\n      MIN_RANK_NODE_COUNT / this.utils.random(),\n      MAX_RANK_NODE_COUNT\n    );\n  }\n\n  /**\n   * Determine a node's type based on its rank\n   * @param {number} rank Rank number\n   * @returns {string} Node type (task/data/parameters)\n   */\n  getType(node) {\n    if (node.rank % 2) {\n      return 'task';\n    }\n\n    if (!node._sources.length && this.utils.random() < PARAMETERS_FREQUENCY) {\n      return 'parameters';\n    }\n\n    return 'data';\n  }\n\n  /**\n   * Create a node datum object.\n   * @param {number} i Node index within its rank\n   * @param {number} initialRank Rank index\n   * @returns {object} Node object\n   */\n\n  createNode(i, initialRank) {\n    const layer = this.rankLayers[initialRank];\n    const node = {\n      id: `${layer}_${initialRank}_${i}`,\n      name: null,\n      full_name: null, //eslint-disable-line camelcase\n      type: null,\n      rank: initialRank,\n      layer: layer,\n      pipelines: this.getNodePipelines(),\n      modular_pipelines: null, //eslint-disable-line camelcase\n      tags: this.getRandomTags(),\n      _sources: [],\n      _targets: [],\n    };\n    return node;\n  }\n\n  /**\n   * Create a new node name of up to 10 words\n   * @param {string} Node type (task/data/parameters)\n   * @returns {string} Node name\n   */\n  getNodeName(type) {\n    const name = this.utils.getRandomName(this.utils.randomNumber(10), ' ');\n    return type === 'parameters' ? `Parameters ${name}` : name;\n  }\n\n  /**\n   * Generate node metadata panel info\n   * @param {object} node A single node object\n   */\n  getNodeMetaData(node) {\n    const { getRandomName, randomNumber } = this.utils;\n\n    if (node.type === 'task') {\n      node.code = this.generateCodeSnippet();\n    } else if (node.type === 'data') {\n      node.datasetType = getRandomName(randomNumber(2));\n    }\n    node.filepath = getRandomName(randomNumber(10), '/');\n    node.parameters = arrayToObject(\n      getNumberArray(randomNumber(10)).map(() =>\n        getRandomName(randomNumber(2), '_')\n      ),\n      () => this.utils.randomNumber(50) / 10\n    );\n  }\n\n  /**\n   * Use one of the methods of this class as a code example\n   */\n  generateCodeSnippet() {\n    const methods = Object.getOwnPropertyNames(Pipeline.prototype);\n    const index = this.utils.randomIndex(methods.length);\n    let code = Pipeline.prototype[methods[index]].toString();\n    if (index > 0) {\n      code = 'function ' + code.replace(/\\n\\s\\s/g, '\\n');\n    }\n    return code;\n  }\n\n  /**\n   * Create a list of the pipelines that the node will be included in\n   * @returns {array} Node piplines\n   */\n  getNodePipelines() {\n    return this.pipelines.reduce((pipelines, id, i) => {\n      if (i === 0 || this.utils.randomIndex(2)) {\n        return pipelines.concat(id);\n      }\n      return pipelines;\n    }, []);\n  }\n\n  /**\n   * Select a random number of tags from the list of tags\n   * @returns {array} List of tags\n   */\n  getRandomTags() {\n    return this.utils.getRandomSelection(\n      this.tags,\n      this.utils.randomNumber(this.tags.length)\n    );\n  }\n\n  /**\n   * Gets a map of ranks to lists of nodes at that rank\n   * @returns {array} List of nodes\n   */\n  getNodesByRank() {\n    const nodesByRank = {};\n\n    for (const node of this.nodes) {\n      nodesByRank[node.rank] = nodesByRank[node.rank] || [];\n      nodesByRank[node.rank].push(node);\n    }\n\n    return nodesByRank;\n  }\n\n  /**\n   * Create list of edges\n   * @returns {array} Edge objects\n   */\n  generateEdges() {\n    const edges = [];\n    const edgeCount = this.utils.randomNumberBetween(\n      MIN_EDGE_COUNT,\n      MAX_EDGE_COUNT\n    );\n    const nodesByRank = this.getNodesByRank();\n\n    // Find the sorted list of node ranks\n    const ranks = Object.keys(nodesByRank)\n      .map((rank) => parseFloat(rank))\n      .sort((a, b) => a - b);\n\n    // Gets a random node with the given rank index\n    const getRandomNodeAtRank = (rankIndex) => {\n      const rankValue = ranks[rankIndex];\n      const rankNodes = nodesByRank[rankValue];\n      const rankNodeIndex = this.utils.randomIndex(rankNodes.length);\n      return rankNodes[rankNodeIndex];\n    };\n\n    // For the desired amount of edges\n    for (let i = 0; i < edgeCount; i += 1) {\n      // Choose a random source node excluding the last rank\n      const sourceRankIndex = this.utils.randomIndex(ranks.length - 1);\n      const source = getRandomNodeAtRank(sourceRankIndex);\n\n      // Choose a random target node after the source rank prefering nearby\n      const remainingRankCount = ranks.length - 1 - sourceRankIndex;\n      const biasedRandom = Math.round(0.5 / this.utils.random());\n      const targetRankIndex =\n        sourceRankIndex + Math.min(biasedRandom, remainingRankCount);\n      const target = getRandomNodeAtRank(targetRankIndex);\n\n      // Build the edge\n      const edge = {\n        source: source.id,\n        target: target.id,\n        _sourceNode: source,\n        _targetNode: target,\n      };\n\n      edges.push(edge);\n\n      // Keep track of edges on nodes for later convenience\n      source._targets.push(edge);\n      target._sources.push(edge);\n    }\n\n    return edges;\n  }\n\n  /**\n   * Select only nodes with at least the minimum required connected nodes\n   * @returns {object} Filtered nodes\n   */\n  activeNodes() {\n    const nodes = {};\n\n    // Gets the total number of edges for the given node\n    const degree = (node) => node._sources.length + node._targets.length;\n\n    for (const edge of this.edges) {\n      // Keep both nodes if they have enough combined connections\n      if (\n        degree(edge._sourceNode) + degree(edge._targetNode) >\n        MIN_NODE_DEGREE\n      ) {\n        nodes[edge._sourceNode.id] = edge._sourceNode;\n        nodes[edge._targetNode.id] = edge._targetNode;\n      }\n    }\n\n    return Object.values(nodes);\n  }\n\n  /**\n   * Select only used tags\n   * @returns {object} Filtered tags\n   */\n  activeTags() {\n    return this.nodes\n      .reduce((tags, node) => (node.tags ? tags.concat(node.tags) : tags), [])\n      .filter(unique)\n      .map((tag) => ({ name: tag, id: tag }));\n  }\n\n  /**\n   * Select only used edges\n   * @returns {object} Filtered edges\n   */\n  activeEdges() {\n    const visibleNodes = arrayToObject(\n      this.nodes.map((node) => node.id),\n      () => true\n    );\n\n    return this.edges.filter(\n      (edge) => visibleNodes[edge.target] && visibleNodes[edge.source]\n    );\n  }\n\n  /**\n   * Updates node properties including rank, type and name based on the current graph\n   */\n  update() {\n    const graph = {};\n\n    for (const node of this.nodes) {\n      graph[node.id] = [];\n    }\n\n    for (const edge of this.edges) {\n      graph[edge.source].push(edge.target);\n    }\n\n    // Use toposort to find actual ranks\n    const sortedNodes = batchingToposort(graph);\n\n    for (let rank = 0; rank < sortedNodes.length; rank++) {\n      for (const id of sortedNodes[rank]) {\n        const node = this.nodes.find((node) => node.id === id);\n        node.rank = rank;\n        node.type = this.getType(node);\n        node.name = this.getNodeName(node.type);\n        node.full_name =  //eslint-disable-line camelcase\n        `${node.layer}_${node.type}_${node.rank}_${node.name}`.replace(\n          /\\s/g,\n          '_'\n        );\n        this.getNodeMetaData(node);\n      }\n    }\n  }\n\n  /**\n   * Removes unused elements and cleans up temporary properties\n   */\n  finalise() {\n    this.nodes = this.activeNodes();\n    this.tags = this.activeTags();\n    this.edges = this.activeEdges();\n\n    for (const node of this.nodes) {\n      delete node._sources;\n      delete node._targets;\n    }\n\n    for (const edge of this.edges) {\n      delete edge._targetNode;\n      delete edge._sourceNode;\n    }\n  }\n\n  /**\n   * Gets the complete pipeline data\n   * @returns {object} The pipeline data\n   */\n  all() {\n    return {\n      edges: this.edges,\n      layers: LAYERS,\n      nodes: this.nodes,\n      pipelines: this.pipelines.map((name) => ({ id: name, name })),\n      //eslint-disable-next-line camelcase\n      modular_pipelines: this.modularPipelines,\n      tags: this.tags,\n    };\n  }\n}\n\nconst generateRandomPipeline = () => new Pipeline().all();\n\nexport default generateRandomPipeline;\n","import getRandomPipeline from './random-data';\nimport spaceflights from './data/spaceflights.mock.json';\nimport demo from './data/demo.mock.json';\nimport selectors from './data/selectors.mock.json';\n\n/**\n * Determine the data source ID from the URL query string, or an environment\n * variable from the CLI, or from the URL host, else return undefined.\n * You can supply one of the following strings:\n   - 'random': Use randomly-generated data\n   - 'spaceflights': Use data from the 'spaceflights' test dataset ( this is the same dataset as used by the Core team for their tests )\n   - 'demo': Use data from the 'demo' test dataset\n   - 'json': Load data from a local json file (in /public/api/main)\n * @return {string} Data source identifier\n */\nexport const getSourceID = () => {\n  const urlParams = new URL(document.location.href).searchParams;\n  const dataSource = urlParams.get('data');\n  const { REACT_APP_DATA_SOURCE } = process.env;\n  const isDemo = document.location.host === 'quantumblacklabs.github.io';\n\n  if (dataSource) {\n    return encodeURIComponent(dataSource);\n  }\n  if (REACT_APP_DATA_SOURCE) {\n    return REACT_APP_DATA_SOURCE;\n  }\n  if (isDemo) {\n    return 'demo';\n  }\n  return 'json';\n};\n\n/**\n * Either load synchronous pipeline data, or else indicate with a string\n * that json data should be loaded asynchronously later on.\n * @param {string} source Data source identifier\n * @return {object|string} Either raw data itself, or 'json'\n */\nexport const getDataValue = (source) => {\n  // Add data source string to data object\n  const nameSource = (data) => Object.assign(data, { source });\n\n  switch (source) {\n    case 'spaceflights':\n      // Use data from the 'spaceflights' test dataset\n      return nameSource(spaceflights);\n    case 'demo':\n      // Use data from the 'demo' test dataset\n      return nameSource(demo);\n    case 'selectors':\n      // Use data from the 'selectors' test dataset\n      return nameSource(selectors);\n    case 'random':\n      // Use procedurally-generated data\n      return nameSource(getRandomPipeline());\n    case 'json':\n      // Load data asynchronously later\n      return source;\n    default:\n      throw new Error(\n        `Unexpected data source value '${source}'. Your input should be one of the following values: 'spaceflights', 'demo', 'json', 'selectors', or 'random'`\n      );\n  }\n};\n\n/**\n * Determine which data source to use, and return it\n * @return {object|string} Pipeline data, or 'json'\n */\nconst getPipelineData = () => getDataValue(getSourceID());\n\nexport default getPipelineData;\n","import React from 'react';\nimport App from '../app';\nimport getPipelineData from '../../utils/data-source';\nimport './container.css';\n\n/**\n * Top-level component for the use-case where Kedro-Viz is run as a standalone\n * app rather than imported as a library/package into a larger application.\n */\nconst Container = () => (\n  <>\n    <App data={getPipelineData()} />\n  </>\n);\n\nexport default Container;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport KedroViz from './components/container';\n\nReactDOM.render(<KedroViz />, document.getElementById('root'));\n","/* eslint-disable id-length */\n\n/**\n * PI / 2 constant\n */\n\nexport const HALF_PI = Math.PI * 0.5;\n\n/**\n * Clamps the value between min and max\n * @param {number} value The number to clamp\n * @param {number} min The minimum value\n * @param {number} max The maximum value\n * @returns {number} The value clamped\n */\nexport const clamp = (value, min, max) =>\n  value < min ? min : value > max ? max : value;\n\n/**\n * Rounds the value to the nearest unit value\n * @param {number} value The value to snap\n * @param {number} unit The unit\n * @returns {number} The value snapped\n */\nexport const snap = (value, unit) => Math.round(value / unit) * unit;\n\n/**\n * Returns the distance between two values\n * @param {number} a The first value\n * @param {number} b The second value\n * @returns {number} The distance\n */\nexport const distance1d = (a, b) => Math.abs(a - b);\n\n/**\n * Returns the angle in radians between the points a and b relative to the X-axis about the origin\n * @param {object} a The first point\n * @param {object} b The second point\n * @returns {number} The angle\n */\nexport const angle = (a, b) => Math.atan2(a.y - b.y, a.x - b.x);\n\n/**\n * Returns the left edge x-position of the node\n * @param {object} node The node\n * @returns {number} The left edge position\n */\nexport const nodeLeft = (node) => node.x - node.width * 0.5;\n\n/**\n * Returns the right edge x-position of the node\n * @param {object} node The node\n * @returns {number} The right edge position\n */\nexport const nodeRight = (node) => node.x + node.width * 0.5;\n\n/**\n * Returns the top edge y-position of the node\n * @param {object} node The node\n * @returns {number} The top edge position\n */\nexport const nodeTop = (node) => node.y - node.height * 0.5;\n\n/**\n * Returns the bottom edge y-position of the node\n * @param {object} node The node\n * @returns {number} The bottom edge position\n */\nexport const nodeBottom = (node) => node.y + node.height * 0.5;\n\n/**\n * Finds the rows formed by nodes given the their positions in Y.\n * The result is sorted in X and Y.\n * Adds a `row` property to each node in-place\n * @param {array} nodes The input nodes\n * @returns {array} The sorted rows of nodes\n */\nexport const groupByRow = (nodes) => {\n  const rows = {};\n\n  // Create rows using node Y values\n  for (const node of nodes) {\n    rows[node.y] = rows[node.y] || [];\n    rows[node.y].push(node);\n  }\n\n  // Sort the set of rows accounting for keys being strings\n  const rowNumbers = Object.keys(rows).map((row) => parseFloat(row));\n  rowNumbers.sort((a, b) => a - b);\n\n  // Sort rows in order of X position if set. Break ties with ids for stability\n  const sortedRows = rowNumbers.map((row) => rows[row]);\n  for (let i = 0; i < sortedRows.length; i += 1) {\n    sortedRows[i].sort((a, b) => compare(a.x, b.x, a.id, b.id));\n\n    for (const node of sortedRows[i]) {\n      node.row = i;\n    }\n  }\n\n  return sortedRows;\n};\n\n/**\n * Generalised comparator function for sorting\n * If values are strings then `localeCompare` is used, otherwise values are subtracted\n * Compares the first pair of values and returns the difference if non equal,\n * otherwise ties are broken by comparing the subsequent pairs of values\n * @param {number|string} a Value to compare with `b`\n * @param {number|string} b Value to compare with `a`\n * @param {...number|string} values Any number of further pairs of values to compare as tie-breakers\n * @returns {number} A standard signed comparator result\n */\nexport const compare = (a, b, ...values) => {\n  const delta = typeof a === 'string' ? a.localeCompare(b) : a - b;\n  return delta !== 0 || values.length === 0 ? delta : compare(...values);\n};\n\n/**\n * Returns the node with the position translated in-place\n * @param {object} node The node\n * @param {object} offset The translation vector\n * @returns {object} The node\n */\nexport const offsetNode = (node, offset) => {\n  node.x = node.x - offset.x;\n  node.y = node.y - offset.y;\n  // Node sort order for tabindex:\n  node.order = node.x + node.y * 9999;\n  return node;\n};\n\n/**\n * Returns the edge with each point translated in-place\n * @param {object} edge The edge\n * @param {object} offset The translation vector\n * @returns {object} The edge\n */\nexport const offsetEdge = (edge, offset) => {\n  edge.points.forEach((point) => {\n    point.x = point.x - offset.x;\n    point.y = point.y - offset.y;\n  });\n  return edge;\n};\n\n/**\n * Returns the point on the line segment `ax, ay, bx, by` closest to point `x, y`\n * @param {number} x The test point x\n * @param {number} y The test point y\n * @param {number} ax The start of the line segement x point\n * @param {number} ay The start of the line segement y point\n * @param {number} bx The end of the line segement x point\n * @param {number} by The end of the line segement y point\n * @returns {object} An object with the closest point and both line segment points\n */\nexport const nearestOnLine = (x, y, ax, ay, bx, by) => {\n  const dx = bx - ax;\n  const dy = by - ay;\n  const position = ((x - ax) * dx + (y - ay) * dy) / (dx * dx + dy * dy || 1);\n  const positionClamped = clamp(position, 0, 1);\n\n  return {\n    x: ax + dx * positionClamped,\n    y: ay + dy * positionClamped,\n    ax,\n    ay,\n    bx,\n    by,\n  };\n};\n","/** @license kiwi.js v1.1.2\n * #------------------------------------------------------------------------------\n * # Copyright (c) 2013, Nucleic Development Team & H. Rutjes.\n * #\n * # Distributed under the terms of the Modified BSD License.\n * #\n * # The full license is in the file COPYING.txt, distributed with this software.\n * #------------------------------------------------------------------------------\n **/\nimport { Solver, Variable } from 'kiwi.js';\n\n/**\n * Applies the given constraints to the objects in-place.\n * A solution is approximated iteratively.\n * Refer to LAYOUT_ENGINE.md for further details.\n * @param {array} constraints The constraints\n * @param {function} constraint.base.solve A function that solves the constraint in-place\n * @param {number} iterations The number of iterations\n * @param {?object} constants The constants used by constraints\n */\nexport const solveLoose = (constraints, iterations, constants) => {\n  for (let i = 0; i < iterations; i += 1) {\n    for (const constraint of constraints) {\n      constraint.base.solve(constraint, constants);\n    }\n  }\n};\n\n/**\n * Applies the given constraints to the objects in-place.\n * A solution is found exactly for the constraints that are solvable.\n * Any unsolvable constraints will be skipped and a warning logged in the console.\n * Refer to LAYOUT_ENGINE.md for further details.\n * @param {array} constraints The constraints\n * @param {string} constraint.base.property The property name on `a` and `b` to constrain\n * @param {function} constraint.base.strict A function returns the constraint in strict form\n * @param {object} constraint.a The first object to constrain\n * @param {object} constraint.b The second object to constrain\n * @param {object} constraint.a.id A unique id for the first object\n * @param {object} constraint.b.id A unique id for the second object\n * @param {?object} constants The constants used by constraints\n */\nexport const solveStrict = (constraints, constants) => {\n  const solver = new Solver();\n  const variables = {};\n\n  const variableId = (obj, property) => `${obj.id}_${property}`;\n\n  const addVariable = (obj, property) => {\n    const id = variableId(obj, property);\n\n    if (!variables[id]) {\n      const variable = (variables[id] = new Variable());\n      variable.property = property;\n      variable.obj = obj;\n    }\n  };\n\n  for (const constraint of constraints) {\n    addVariable(constraint.a, constraint.base.property);\n    addVariable(constraint.b, constraint.base.property);\n  }\n\n  let unsolvableCount = 0;\n\n  for (const constraint of constraints) {\n    try {\n      solver.addConstraint(\n        constraint.base.strict(\n          constraint,\n          constants,\n          variables[variableId(constraint.a, constraint.base.property)],\n          variables[variableId(constraint.b, constraint.base.property)]\n        )\n      );\n    } catch (err) {\n      unsolvableCount += 1;\n    }\n  }\n\n  if (unsolvableCount > 0) {\n    console.warn(`Skipped ${unsolvableCount} unsolvable constraints`);\n  }\n\n  solver.updateVariables();\n\n  const variablesList = Object.values(variables);\n\n  for (const variable of variablesList) {\n    variable.obj[variable.property] = variable.value();\n  }\n};\n","/**\n * Constraint base definitions.\n *\n * Refer to LAYOUT_ENGINE.md for descriptions of each constraint.\n *\n * See `solve` function of `solver.js` for constraint specification.\n */\n\nimport { Constraint, Operator, Strength } from 'kiwi.js';\n\n/**\n * Layout constraint in Y for separating rows\n */\nexport const rowConstraint = {\n  property: 'y',\n\n  strict: (constraint, constants, variableA, variableB) =>\n    new Constraint(\n      variableA.minus(variableB),\n      Operator.Ge,\n      constants.spaceY,\n      Strength.required\n    ),\n};\n\n/**\n * Layout constraint in Y for separating layers\n */\nexport const layerConstraint = {\n  property: 'y',\n\n  strict: (constraint, constants, variableA, variableB) =>\n    new Constraint(\n      variableA.minus(variableB),\n      Operator.Ge,\n      constants.layerSpace,\n      Strength.required\n    ),\n};\n\n/**\n * Layout constraint in X for minimising distance from source to target for straight edges\n */\nexport const parallelConstraint = {\n  property: 'x',\n\n  solve: (constraint) => {\n    const { a, b, strength } = constraint;\n    const resolve = strength * (a.x - b.x);\n    a.x -= resolve;\n    b.x += resolve;\n  },\n\n  strict: (constraint, constants, variableA, variableB) =>\n    new Constraint(\n      variableA.minus(variableB),\n      Operator.Eq,\n      0,\n      Strength.create(1, 0, 0, constraint.strength)\n    ),\n};\n\n/**\n * Crossing constraint in X for minimising edge crossings\n */\nexport const crossingConstraint = {\n  property: 'x',\n\n  solve: (constraint) => {\n    const { edgeA, edgeB, separationA, separationB, strength } = constraint;\n\n    // Amount to move each node towards required separation\n    const resolveSource =\n      strength *\n      ((edgeA.sourceNode.x - edgeB.sourceNode.x - separationA) / separationA);\n\n    const resolveTarget =\n      strength *\n      ((edgeA.targetNode.x - edgeB.targetNode.x - separationB) / separationB);\n\n    // Apply the resolve each node\n    edgeA.sourceNode.x -= resolveSource;\n    edgeB.sourceNode.x += resolveSource;\n    edgeA.targetNode.x -= resolveTarget;\n    edgeB.targetNode.x += resolveTarget;\n  },\n};\n\n/**\n * Layout constraint in X for minimum node separation\n */\nexport const separationConstraint = {\n  property: 'x',\n\n  strict: (constraint, constants, variableA, variableB) =>\n    new Constraint(\n      variableB.minus(variableA),\n      Operator.Ge,\n      constraint.separation,\n      Strength.required\n    ),\n};\n","import { HALF_PI, snap, angle, compare, groupByRow } from './common';\nimport { solveLoose, solveStrict } from './solver';\nimport {\n  rowConstraint,\n  layerConstraint,\n  parallelConstraint,\n  crossingConstraint,\n  separationConstraint,\n} from './constraints';\n\n/**\n * Finds positions for the given nodes relative to their edges.\n * Input nodes and edges are updated in-place.\n * Results are stored in the `x, y` properties on nodes.\n * @param {object} params The layout parameters\n * @param {array} params.nodes The input nodes\n * @param {array} params.edges The input edges\n * @param {object=} params.layers The node layers if specified\n * @param {number} params.spaceX The minimum gap between nodes in X\n * @param {number} params.spaceY The minimum gap between nodes in Y\n * @param {number} params.spreadX Adjusts the gap for each node in X based on the number of connected edges it has\n * @param {number} params.layerSpaceY The additional gap between nodes in Y between layers\n * @param {number} params.iterations The number of solver iterations to perform\n * @returns {void}\n */\nexport const layout = ({\n  nodes,\n  edges,\n  layers,\n  spaceX,\n  spaceY,\n  spreadX,\n  layerSpaceY,\n  iterations,\n}) => {\n  // Set initial positions for nodes\n  for (const node of nodes) {\n    node.x = 0;\n    node.y = 0;\n  }\n\n  // Constants used by constraints\n  const constants = {\n    spaceX,\n    spaceY,\n    spreadX,\n    layerSpace: (spaceY + layerSpaceY) * 0.5,\n  };\n\n  // Constraints to separate nodes into rows and layers\n  const rowConstraints = createRowConstraints(edges);\n  const layerConstraints = createLayerConstraints(nodes, layers);\n\n  // Find the node positions given these constraints\n  solveStrict([...rowConstraints, ...layerConstraints], constants, 1);\n\n  // Find the solved rows using the node positions after solving\n  const rows = groupByRow(nodes);\n\n  // Constraints to avoid edges crossing and maintain parallel vertical edges\n  const crossingConstraints = createCrossingConstraints(edges, constants);\n  const parallelConstraints = createParallelConstraints(edges, constants);\n\n  // Solve these constraints iteratively\n  for (let i = 0; i < iterations; i += 1) {\n    solveLoose(crossingConstraints, 1, constants);\n    solveLoose(parallelConstraints, 50, constants);\n  }\n\n  // Constraints to maintain a minimum horizontal node spacing\n  const separationConstraints = createSeparationConstraints(rows, constants);\n\n  // Find the final node positions given these strict constraints\n  solveStrict([...separationConstraints, ...parallelConstraints], constants, 1);\n\n  // Adjust vertical spacing between rows for legibility\n  expandDenseRows(edges, rows, spaceY);\n};\n\n/**\n * Creates row constraints for the given edges.\n * @param {array} edges The input edges\n * @returns {array} The constraints\n */\nconst createRowConstraints = (edges) =>\n  edges.map((edge) => ({\n    base: rowConstraint,\n    a: edge.targetNode,\n    b: edge.sourceNode,\n  }));\n\n/**\n * Creates layer constraints for the given nodes and layers.\n * @param {array} nodes The input nodes\n * @param {array=} layers The input layers if any\n * @returns {array} The constraints\n */\nconst createLayerConstraints = (nodes, layers) => {\n  const layerConstraints = [];\n\n  // Early out if no layers defined\n  if (!layers) {\n    return layerConstraints;\n  }\n\n  // Group the nodes for each layer\n  const layerGroups = layers.map((name) =>\n    nodes.filter((node) => node.nearestLayer === name)\n  );\n\n  // For each layer of nodes\n  for (let i = 0; i < layerGroups.length - 1; i += 1) {\n    const layerNodes = layerGroups[i];\n    const nextLayerNodes = layerGroups[i + 1];\n\n    // Create a temporary intermediary node for the layer\n    const intermediary = { id: `layer-${i}`, x: 0, y: 0 };\n\n    // Constrain each node in the layer to above the intermediary\n    for (const node of layerNodes) {\n      layerConstraints.push({\n        base: layerConstraint,\n        a: intermediary,\n        b: node,\n      });\n    }\n\n    // Constrain each node in the next layer to below the intermediary\n    for (const node of nextLayerNodes) {\n      layerConstraints.push({\n        base: layerConstraint,\n        a: node,\n        b: intermediary,\n      });\n    }\n  }\n\n  return layerConstraints;\n};\n\n/**\n * Creates crossing constraints for the given edges.\n * @param {array} edges The input edges\n * @param {object} constants The constraint constants\n * @param {number} constants.spaceX The minimum gap between nodes in X\n * @returns {array} The constraints\n */\nconst createCrossingConstraints = (edges, constants) => {\n  const { spaceX } = constants;\n  const crossingConstraints = [];\n\n  // For every pair of edges\n  for (let i = 0; i < edges.length; i += 1) {\n    const edgeA = edges[i];\n    const { sourceNode: sourceA, targetNode: targetA } = edgeA;\n\n    // Count the connected edges\n    const edgeADegree =\n      sourceA.sources.length +\n      sourceA.targets.length +\n      targetA.sources.length +\n      targetA.targets.length;\n\n    for (let j = i + 1; j < edges.length; j += 1) {\n      const edgeB = edges[j];\n      const { sourceNode: sourceB, targetNode: targetB } = edgeB;\n\n      // Skip if edges are not intersecting by row so can't cross\n      if (sourceA.row >= targetB.row || targetA.row <= sourceB.row) {\n        continue;\n      }\n\n      // Count the connected edges\n      const edgeBDegree =\n        sourceB.sources.length +\n        sourceB.targets.length +\n        targetB.sources.length +\n        targetB.targets.length;\n\n      crossingConstraints.push({\n        base: crossingConstraint,\n        edgeA: edgeA,\n        edgeB: edgeB,\n        // The required horizontal spacing between connected nodes\n        separationA: sourceA.width * 0.5 + spaceX + sourceB.width * 0.5,\n        separationB: targetA.width * 0.5 + spaceX + targetB.width * 0.5,\n        // Evenly distribute the constraint\n        strength: 1 / Math.max(1, (edgeADegree + edgeBDegree) / 4),\n      });\n    }\n  }\n\n  return crossingConstraints;\n};\n\n/**\n * Creates parallel constraints for the given edges.\n * Returns object with additional arrays that identify these special cases:\n * - edges connected to single-degree nodes at either end\n * - edges connected to single-degree nodes at both ends\n * @param {array} edges The input edges\n * @returns {object} An object containing the constraints\n */\nconst createParallelConstraints = (edges) =>\n  edges.map(({ sourceNode, targetNode }) => ({\n    base: parallelConstraint,\n    a: sourceNode,\n    b: targetNode,\n    // Evenly distribute the constraint\n    strength:\n      0.6 /\n      Math.max(1, sourceNode.targets.length + targetNode.sources.length - 2),\n  }));\n\n/**\n * Creates horizontal separation constraints for the given rows of nodes.\n * @param {array} rows The rows containing nodes\n * @returns {array} The constraints\n */\nconst createSeparationConstraints = (rows, constants) => {\n  const { spaceX } = constants;\n  const separationConstraints = [];\n\n  // For each row of nodes\n  for (let i = 0; i < rows.length; i += 1) {\n    const rowNodes = rows[i];\n\n    // Stable sort row nodes horizontally, breaks ties with ids\n    rowNodes.sort((a, b) => compare(a.x, b.x, a.id, b.id));\n\n    // Update constraints given updated row node order\n    for (let j = 0; j < rowNodes.length - 1; j += 1) {\n      const nodeA = rowNodes[j];\n      const nodeB = rowNodes[j + 1];\n\n      // Count the connected edges\n      const degreeA = Math.max(\n        1,\n        nodeA.targets.length + nodeA.sources.length - 2\n      );\n      const degreeB = Math.max(\n        1,\n        nodeB.targets.length + nodeB.sources.length - 2\n      );\n\n      // Allow more spacing for nodes with more edges\n      const spread = Math.min(10, degreeA * degreeB * constants.spreadX);\n      const space = snap(spread * spaceX, spaceX);\n\n      separationConstraints.push({\n        base: separationConstraint,\n        a: nodeA,\n        b: nodeB,\n        separation: nodeA.width * 0.5 + space + nodeB.width * 0.5,\n      });\n    }\n  }\n\n  return separationConstraints;\n};\n\n/**\n * Adds additional spacing in Y relative to row density, see function `rowDensity` for definition.\n * Node positions are updated in-place\n * @param {array} edges The input edges\n * @param {array} rows The input rows of nodes\n * @param {number} spaceY The spacing between nodes in Y\n * @param {number} [scale=1.25] The amount of expansion to apply relative to row density\n * @param {number} [unit=0.25] The unit size for rounding expansion relative to spaceY\n */\nconst expandDenseRows = (edges, rows, spaceY, scale = 1.25, unit = 0.25) => {\n  const densities = rowDensity(edges);\n  const spaceYUnit = Math.round(spaceY * unit);\n  let currentOffsetY = 0;\n\n  // Add spacing based relative to row density\n  for (let i = 0; i < rows.length - 1; i += 1) {\n    const density = densities[i] || 0;\n\n    // Round offset to a common unit amount to improve vertical rhythm\n    const offsetY = snap(density * scale * spaceY, spaceYUnit);\n    currentOffsetY += offsetY;\n\n    // Apply offset to all nodes following the current node\n    for (const node of rows[i + 1]) {\n      node.y += currentOffsetY;\n    }\n  }\n};\n\n/**\n * Estimates an average 'density' for each row based on average edge angle at that row.\n * Rows with edges close to horizontal are more 'dense' than rows with straight vertical edges.\n * Rows are determined by each edge's source and target node Y positions.\n * Intermediate row edges are assumed always vertical as a simplification, only the start end rows are measured.\n * Returns a list of values in `(0, 1)` where `0` means all edges on that row are vertical and `1` means all horizontal\n * @param {array} edges The input edges\n * @returns {array} The density of each row\n */\nconst rowDensity = (edges) => {\n  const rows = {};\n\n  for (const edge of edges) {\n    // Find the normalized angle of the edge source and target nodes, relative to the X axis\n    const edgeAngle =\n      Math.abs(angle(edge.targetNode, edge.sourceNode) - HALF_PI) / HALF_PI;\n\n    const sourceRow = edge.sourceNode.row;\n    const targetRow = edge.targetNode.row - 1;\n\n    // Add angle to the source row total\n    rows[sourceRow] = rows[sourceRow] || [0, 0];\n    rows[sourceRow][0] += edgeAngle;\n    rows[sourceRow][1] += 1;\n\n    if (targetRow !== sourceRow) {\n      // Add angle to the target row total\n      rows[targetRow] = rows[targetRow] || [0, 0];\n      rows[targetRow][0] += edgeAngle;\n      rows[targetRow][1] += 1;\n    }\n  }\n\n  // Find the average angle for each row\n  for (const row in rows) {\n    rows[row] = rows[row][0] / (rows[row][1] || 1);\n  }\n\n  return Object.values(rows);\n};\n","import {\n  compare,\n  distance1d,\n  angle,\n  nearestOnLine,\n  groupByRow,\n  nodeLeft,\n  nodeRight,\n  nodeTop,\n  nodeBottom,\n} from './common';\n\n/**\n * Finds positions for the given edges relative to their nodes.\n * Input nodes and edges are updated in-place.\n * Results are stored in the `points` property on edges.\n * @param {object} params The layout parameters\n * @param {array} params.nodes The input nodes\n * @param {array} params.edges The input edges\n * @param {number} params.spaceX The minimum gap between a node and passing edges in X\n * @param {number} params.spaceY The minimum gap between a node and passing edges in Y\n * @param {number} params.minPassageGap The minimum gap between two nodes in which an edge can pass in X\n * @param {number} params.stemUnit The unit length for edge stems at anchors\n * @param {number} params.stemMax The maximum length of edge stems at anchors\n * @param {number} params.stemMinSource The minimum length for edge stems at source anchors\n * @param {number} params.stemMinTarget The minimum length for edge stems at target anchors\n * @param {number} params.stemSpaceSource The ideal spacing between edge stems at source anchors\n * @param {number} params.stemSpaceTarget The ideal spacing between edge stems at target anchors\n * @returns {void}\n */\nexport const routing = ({\n  nodes,\n  edges,\n  spaceX,\n  spaceY,\n  minPassageGap,\n  stemUnit,\n  stemMinSource,\n  stemMinTarget,\n  stemMax,\n  stemSpaceSource,\n  stemSpaceTarget,\n}) => {\n  // Find the rows formed by nodes\n  const rows = groupByRow(nodes);\n\n  // For each node\n  for (const node of nodes) {\n    // Sort the node's target edges by the angle between source and target nodes\n    node.targets.sort((a, b) =>\n      compare(\n        angle(b.sourceNode, b.targetNode),\n        angle(a.sourceNode, a.targetNode)\n      )\n    );\n  }\n\n  // For each edge\n  for (const edge of edges) {\n    const source = edge.sourceNode;\n    const target = edge.targetNode;\n\n    // Initialise result container\n    edge.points = [];\n\n    // Find the ideal gap between edge source anchors\n    const sourceSeparation = Math.min(\n      (source.width - stemSpaceSource) / source.targets.length,\n      stemSpaceSource\n    );\n\n    const sourceEdgeDistance =\n      source.targets.indexOf(edge) - (source.targets.length - 1) * 0.5;\n\n    const sourceOffsetX = sourceSeparation * sourceEdgeDistance;\n\n    // Start at source node offset\n    const startPoint = { x: source.x + sourceOffsetX, y: source.y };\n    let currentPoint = startPoint;\n\n    // For each row between the source and target rows exclusive\n    for (let i = source.row + 1; i < target.row; i += 1) {\n      const firstNode = rows[i][0];\n\n      // Initialise search for next point\n      let nearestPoint = { x: nodeLeft(firstNode) - spaceX, y: firstNode.y };\n      let nearestDistance = Infinity;\n\n      // Extend the row 'to infinity' on each side in X\n      const rowExtended = [\n        { ...firstNode, x: Number.MIN_SAFE_INTEGER },\n        ...rows[i],\n        { ...firstNode, x: Number.MAX_SAFE_INTEGER },\n      ];\n\n      // For each gap between each nodes on the row\n      for (let i = 0; i < rowExtended.length - 1; i += 1) {\n        const node = rowExtended[i];\n        const nextNode = rowExtended[i + 1];\n        const nodeGap = nodeLeft(nextNode) - nodeRight(node);\n\n        // Avoid routing through small gaps, increase bundling\n        if (nodeGap < minPassageGap) {\n          continue;\n        }\n\n        const offsetX = Math.min(spaceX, nodeGap * 0.5);\n\n        // Find the next potential point. Include offset to reduce overlapping edges\n        const candidatePoint = nearestOnLine(\n          currentPoint.x,\n          currentPoint.y,\n          nodeRight(node) + offsetX,\n          nodeTop(node) - spaceY,\n          nodeLeft(nextNode) - offsetX,\n          nodeTop(nextNode) - spaceY\n        );\n\n        const distance = distance1d(currentPoint.x, candidatePoint.x);\n\n        // Early out if diverging\n        if (distance > nearestDistance) {\n          break;\n        }\n\n        // Keep the nearest point\n        if (distance < nearestDistance) {\n          nearestDistance = distance;\n          nearestPoint = candidatePoint;\n        }\n      }\n\n      // Pass the node at nearest point\n      const offsetY = firstNode.height + spaceY;\n      edge.points.push({\n        x: nearestPoint.x + sourceOffsetX,\n        y: nearestPoint.y,\n      });\n      edge.points.push({\n        x: nearestPoint.x + sourceOffsetX,\n        y: nearestPoint.y + offsetY,\n      });\n\n      currentPoint = {\n        x: nearestPoint.x,\n        y: nearestPoint.y + offsetY,\n      };\n    }\n  }\n\n  // For each node\n  for (const node of nodes) {\n    // Sort the node's outgoing edges by the starting angle of the edge path\n    node.targets.sort((a, b) =>\n      compare(\n        angle(b.sourceNode, b.points[0] || b.targetNode),\n        angle(a.sourceNode, a.points[0] || a.targetNode)\n      )\n    );\n    // Sort the node's incoming edges by the ending angle of the edge path\n    node.sources.sort((a, b) =>\n      compare(\n        angle(a.points[a.points.length - 1] || a.sourceNode, a.targetNode),\n        angle(b.points[b.points.length - 1] || b.sourceNode, b.targetNode)\n      )\n    );\n  }\n\n  // For each edge\n  for (const edge of edges) {\n    const source = edge.sourceNode;\n    const target = edge.targetNode;\n\n    // Find the ideal gap between edge source and target anchors\n    const sourceSeparation = Math.min(\n      (source.width - stemSpaceSource) / source.targets.length,\n      stemSpaceSource\n    );\n\n    const targetSeparation = Math.min(\n      (target.width - stemSpaceTarget) / target.sources.length,\n      stemSpaceTarget\n    );\n\n    const sourceEdgeDistance =\n      source.targets.indexOf(edge) - (source.targets.length - 1) * 0.5;\n    const targetEdgeDistance =\n      target.sources.indexOf(edge) - (target.sources.length - 1) * 0.5;\n\n    const sourceOffsetX = sourceSeparation * sourceEdgeDistance;\n    const targetOffsetX = targetSeparation * targetEdgeDistance;\n\n    // Decrease stem length outwards from the middle stem\n    const sourceOffsetY =\n      stemUnit *\n      source.targets.length *\n      (1 - Math.abs(sourceEdgeDistance) / source.targets.length);\n\n    const targetOffsetY =\n      stemUnit *\n      target.sources.length *\n      (1 - Math.abs(targetEdgeDistance) / target.sources.length);\n\n    // Build the source stem for the edge\n    const sourceStem = [\n      {\n        x: source.x + sourceOffsetX,\n        y: nodeBottom(source),\n      },\n      {\n        x: source.x + sourceOffsetX,\n        y: nodeBottom(source) + stemMinSource,\n      },\n      {\n        x: source.x + sourceOffsetX,\n        y:\n          nodeBottom(source) + stemMinSource + Math.min(sourceOffsetY, stemMax),\n      },\n    ];\n\n    // Build the target stem for the edge\n    const targetStem = [\n      {\n        x: target.x + targetOffsetX,\n        y: nodeTop(target) - stemMinTarget - Math.min(targetOffsetY, stemMax),\n      },\n      {\n        x: target.x + targetOffsetX,\n        y: nodeTop(target) - stemMinTarget,\n      },\n      {\n        x: target.x + targetOffsetX,\n        y: nodeTop(target),\n      },\n    ];\n\n    // Combine all points\n    const points = [...sourceStem, ...edge.points, ...targetStem];\n\n    // Fix any invalid points caused by invalid layouts\n    let pointYMax = points[0].y;\n\n    for (const point of points) {\n      // Ensure increasing Y values for each point\n      if (point.y < pointYMax) {\n        point.y = pointYMax;\n      } else {\n        pointYMax = point.y;\n      }\n    }\n\n    // Assign finished points to edge\n    edge.points = points;\n  }\n};\n","/*\n * The Kedro Viz Graph Layout Engine\n *\n * Refer to LAYOUT_ENGINE.md for description of the approach.\n */\n\nimport { offsetNode, offsetEdge } from './common';\nimport { layout } from './layout';\nimport { routing } from './routing';\n\nconst defaultOptions = {\n  layout: {\n    spaceX: 14,\n    spaceY: 110,\n    layerSpaceY: 55,\n    spreadX: 2.2,\n    padding: 100,\n    iterations: 25,\n  },\n  routing: {\n    spaceX: 26,\n    spaceY: 28,\n    minPassageGap: 40,\n    stemUnit: 8,\n    stemMinSource: 5,\n    stemMinTarget: 5,\n    stemMax: 20,\n    stemSpaceSource: 6,\n    stemSpaceTarget: 10,\n  },\n};\n\n/**\n * Generates a diagram of the given DAG.\n * Input nodes and edges are updated in-place.\n * Results are stored as `x, y` properties on nodes\n * and `points` properties on edges.\n * @param {array} nodes The input nodes\n * @param {array} edges The input edges\n * @param {object=} layers The node layers if specified\n * @param {object=} options The graph options\n * @returns {object} The generated graph\n */\nexport const graph = (nodes, edges, layers, options = defaultOptions) => {\n  addEdgeLinks(nodes, edges);\n  addNearestLayers(nodes, layers);\n\n  layout({ nodes, edges, layers, ...options.layout });\n  routing({ nodes, edges, layers, ...options.routing });\n\n  const size = bounds(nodes, options.layout.padding);\n  nodes.forEach((node) => offsetNode(node, size.min));\n  edges.forEach((edge) => offsetEdge(edge, size.min));\n\n  return {\n    nodes,\n    edges,\n    layers,\n    size,\n  };\n};\n\n/**\n * Adds lists of source edges and target edges to each node in-place\n * @param {array} nodes The input nodes\n * @param {array} edges The input edges\n */\nexport const addEdgeLinks = (nodes, edges) => {\n  const nodeById = {};\n\n  for (const node of nodes) {\n    nodeById[node.id] = node;\n    node.targets = [];\n    node.sources = [];\n  }\n\n  for (const edge of edges) {\n    edge.sourceNode = nodeById[edge.source];\n    edge.targetNode = nodeById[edge.target];\n    edge.sourceNode.targets.push(edge);\n    edge.targetNode.sources.push(edge);\n  }\n};\n\n/**\n * Adds the nearest valid layer to each node whilst maintaining the correct layer order\n * @param {array} nodes The input nodes\n * @param {?array} layers The input layers\n */\nconst addNearestLayers = (nodes, layers) => {\n  if (layers && layers.length > 0) {\n    // Create the set of valid layers for lookup\n    const validLayers = {};\n    for (const layer of layers) {\n      validLayers[layer] = true;\n    }\n\n    const hasValidLayer = (node) => Boolean(node && node.layer in validLayers);\n    const lastLayer = layers[layers.length - 1];\n\n    // For each node\n    for (const node of nodes) {\n      // Find first descendant node that has a valid layer following rank order (including itself)\n      const layerNode = findNodeBy(\n        // Starting node\n        node,\n        // Next connected nodes to search\n        targetNodes,\n        // Lowest rank first\n        orderRankAscending,\n        // Acceptance criteria\n        hasValidLayer\n      );\n\n      // Assign the nearest layer if found otherwise must be the last layer\n      node.nearestLayer = layerNode ? layerNode.layer : lastLayer;\n    }\n  }\n};\n\n/**\n * Returns the list of target nodes directly connected to the given node\n * @param {object} node The input node\n * @returns {array} The target nodes\n */\nconst targetNodes = (node) => node.targets.map((edge) => edge.targetNode);\n\n/**\n * Comparator function for sorting nodes rank ascending\n * @param {object} nodeA The first input node\n * @param {object} nodeB The second input node\n * @returns {number} The signed difference\n */\nconst orderRankAscending = (nodeA, nodeB) => nodeA.rank - nodeB.rank;\n\n/**\n * Starting at the given node and expanding successors, returns the first node accepted in order\n * @param {object} node The starting node\n * @param {function} successors A function returning the next nodes to expand\n * @param {function} order A comparator function used for prioritising successors\n * @param {function} accept A function that returns true if the current node fits the criteria\n * @param {object=} visited An object keeping track of nodes already searched\n * @returns {?object} The first node accepted in order, or undefined if none\n */\nconst findNodeBy = (node, successors, order, accept, visited) => {\n  // If the current node is accepted then return it without further search\n  if (accept(node)) {\n    return node;\n  }\n\n  // Keep track of visited nodes\n  visited = visited || {};\n  visited[node.id] = true;\n\n  const results = successors(node)\n    // Remove successors already visited\n    .filter((successor) => !visited[successor.id])\n    // Order unvisited successors\n    .sort(order)\n    // Search the unvisited successors recursively\n    .map((successor) =>\n      findNodeBy(successor, successors, order, accept, visited)\n    )\n    // Keep only the accepted resulting nodes if any\n    .filter(accept)\n    // Order resulting nodes\n    .sort(order);\n\n  // Return the first node accepted in order, or undefined if none\n  return results[0];\n};\n\n/**\n * Finds the region bounding the given nodes\n * @param {array} nodes The input nodes\n * @param {number} padding Additional padding around the bounds\n * @returns {object} The bounds\n */\nconst bounds = (nodes, padding) => {\n  const size = {\n    min: { x: Infinity, y: Infinity },\n    max: { x: -Infinity, y: -Infinity },\n  };\n\n  for (const node of nodes) {\n    const x = node.x;\n    const y = node.y;\n\n    if (x < size.min.x) {\n      size.min.x = x;\n    }\n    if (x > size.max.x) {\n      size.max.x = x;\n    }\n    if (y < size.min.y) {\n      size.min.y = y;\n    }\n    if (y > size.max.y) {\n      size.max.y = y;\n    }\n  }\n\n  size.width = size.max.x - size.min.x + 2 * padding;\n  size.height = size.max.y - size.min.y + 2 * padding;\n  size.min.x -= padding;\n  size.min.y -= padding;\n\n  return size;\n};\n","import { graph } from './graph';\n\n/**\n * Calculate chart layout with experimental new graphing algorithm\n * This is an extremely expensive operation so we want it to run as infrequently\n * as possible, and keep it separate from other properties (like node.active)\n * which don't affect layout.\n */\nexport const graphNew = ({ nodes, edges, layers }) => {\n  const result = graph(nodes, edges, layers);\n  return {\n    ...result,\n    size: { ...result.size, marginx: 100, marginy: 100 },\n  };\n};\n"],"sourceRoot":""}